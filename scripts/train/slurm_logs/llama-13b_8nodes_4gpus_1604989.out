+ module purge
+ local _mlredir=1
+ '[' -n '' ']'
+ case " $@ " in
+ '[' 1 -eq 0 ']'
+ _module_raw purge
++ /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/tcl-8.6.12-rdtv2pt4tnckxsgwtowik3sbexmxolve/bin/tclsh /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/libexec/modulecmd.tcl bash purge
Unloading profile/base
  ERROR: Module evaluation aborted
+ eval 'unset CPATH;
unset CMAKE_PREFIX_PATH;
unset CINECA_AI_LIB;
unset __MODULES_LMTAG;
unset OPENMPI_INC;
unset C_INCLUDE_PATH;
unset F77;
unset OPENMPI_LIB;
unset GCC_INCLUDE;
unset CUDA_INCLUDE;
MANPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man; export MANPATH;
unset MPC_INC;
unset ZLIB_HOME;
unset MPIF77;
unset PKG_CONFIG_PATH;
unset OMPI_MCA_coll_hcoll_enable;
unset __MODULES_LMPREREQ;
unset CUDA_INC;
unset GCC_INC;
unset MPC_LIB;
unset CINECA_AI_INCLUDE;
unset F90;
unset MPFR_INCLUDE;
__MODULES_LMALTNAME=profile/base\&profile/default\&profile; export __MODULES_LMALTNAME;
MODULEPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/modulefiles:/leonardo/prod/opt/modulefiles/profiles:/leonardo/prod/opt/modulefiles/base/archive:/leonardo/prod/opt/modulefiles/base/dependencies:/leonardo/prod/opt/modulefiles/base/data:/leonardo/prod/opt/modulefiles/base/environment:/leonardo/prod/opt/modulefiles/base/libraries:/leonardo/prod/opt/modulefiles/base/tools:/leonardo/prod/opt/modulefiles/base/compilers:/leonardo/prod/opt/modulefiles/base/applications; export MODULEPATH;
unset CUDA_LIB;
unset GCC_LIB;
unset GMP_HOME;
unset GMP_INC;
PATH=/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin; export PATH;
unset MPIF90;
unset CUDA_HOME;
unset GCC_HOME;
unset MPFR_INC;
unset CC;
unset LD_LIBRARY_PATH;
unset GMP_LIB;
LOADEDMODULES=profile/base; export LOADEDMODULES;
unset MPFR_LIB;
unset OPENMPI_INCLUDE;
unset CXX;
unset ZLIB_INCLUDE;
unset MPFR_HOME;
unset OPENMPI_HOME;
unset MPICXX;
unset ZLIB_INC;
unset MPC_INCLUDE;
unset ZLIB_LIB;
unset MPC_HOME;
unset LIBRARY_PATH;
_LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base; export _LMFILES_;
unset MPICC;
unset CPLUS_INCLUDE_PATH;
unset GMP_INCLUDE;
unset FC;
unset __MODULES_LMCONFLICT;
unset CINECA_AI_HOME;
unset CINECA_AI_INC;
test 0 = 1;'
++ unset CPATH
++ unset CMAKE_PREFIX_PATH
++ unset CINECA_AI_LIB
++ unset __MODULES_LMTAG
++ unset OPENMPI_INC
++ unset C_INCLUDE_PATH
++ unset F77
++ unset OPENMPI_LIB
++ unset GCC_INCLUDE
++ unset CUDA_INCLUDE
++ MANPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man
++ export MANPATH
++ unset MPC_INC
++ unset ZLIB_HOME
++ unset MPIF77
++ unset PKG_CONFIG_PATH
++ unset OMPI_MCA_coll_hcoll_enable
++ unset __MODULES_LMPREREQ
++ unset CUDA_INC
++ unset GCC_INC
++ unset MPC_LIB
++ unset CINECA_AI_INCLUDE
++ unset F90
++ unset MPFR_INCLUDE
++ __MODULES_LMALTNAME='profile/base&profile/default&profile'
++ export __MODULES_LMALTNAME
++ MODULEPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/modulefiles:/leonardo/prod/opt/modulefiles/profiles:/leonardo/prod/opt/modulefiles/base/archive:/leonardo/prod/opt/modulefiles/base/dependencies:/leonardo/prod/opt/modulefiles/base/data:/leonardo/prod/opt/modulefiles/base/environment:/leonardo/prod/opt/modulefiles/base/libraries:/leonardo/prod/opt/modulefiles/base/tools:/leonardo/prod/opt/modulefiles/base/compilers:/leonardo/prod/opt/modulefiles/base/applications
++ export MODULEPATH
++ unset CUDA_LIB
++ unset GCC_LIB
++ unset GMP_HOME
++ unset GMP_INC
++ PATH=/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
++ export PATH
++ unset MPIF90
++ unset CUDA_HOME
++ unset GCC_HOME
++ unset MPFR_INC
++ unset CC
++ unset LD_LIBRARY_PATH
++ unset GMP_LIB
++ LOADEDMODULES=profile/base
++ export LOADEDMODULES
++ unset MPFR_LIB
++ unset OPENMPI_INCLUDE
++ unset CXX
++ unset ZLIB_INCLUDE
++ unset MPFR_HOME
++ unset OPENMPI_HOME
++ unset MPICXX
++ unset ZLIB_INC
++ unset MPC_INCLUDE
++ unset ZLIB_LIB
++ unset MPC_HOME
++ unset LIBRARY_PATH
++ _LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base
++ export _LMFILES_
++ unset MPICC
++ unset CPLUS_INCLUDE_PATH
++ unset GMP_INCLUDE
++ unset FC
++ unset __MODULES_LMCONFLICT
++ unset CINECA_AI_HOME
++ unset CINECA_AI_INC
++ test 0 = 1
+ _mlstatus=1
+ return 1
+ module load gcc
+ local _mlredir=1
+ '[' -n '' ']'
+ case " $@ " in
+ '[' 1 -eq 0 ']'
+ _module_raw load gcc
++ /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/tcl-8.6.12-rdtv2pt4tnckxsgwtowik3sbexmxolve/bin/tclsh /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/libexec/modulecmd.tcl bash load gcc
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
+ eval 'GCC_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include; export GCC_INCLUDE;
MPC_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb; export MPC_HOME;
LD_LIBRARY_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export LD_LIBRARY_PATH;
CPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export CPATH;
MANPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man; export MANPATH;
MPC_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include; export MPC_INC;
LIBRARY_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export LIBRARY_PATH;
_LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0; export _LMFILES_;
GMP_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export GMP_LIB;
CMAKE_PREFIX_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/.; export CMAKE_PREFIX_PATH;
LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0; export LOADEDMODULES;
CXX=g++; export CXX;
MPFR_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib; export MPFR_LIB;
__MODULES_LMTAG=gmp/6.2.1\&auto-loaded:mpfr/4.1.0\&auto-loaded:mpc/1.2.1\&auto-loaded; export __MODULES_LMTAG;
PKG_CONFIG_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib/pkgconfig; export PKG_CONFIG_PATH;
MPFR_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc; export MPFR_HOME;
GCC_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include; export GCC_INC;
MPC_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib; export MPC_LIB;
__MODULES_LMPREREQ=mpfr/4.1.0\&gmp/6.2.1:mpc/1.2.1\&gmp/6.2.1\&mpfr/4.1.0:gcc/11.3.0\&gmp/6.2.1\&mpc/1.2.1\&mpfr/4.1.0; export __MODULES_LMPREREQ;
CPLUS_INCLUDE_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export CPLUS_INCLUDE_PATH;
F90=gfortran; export F90;
GMP_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export GMP_INCLUDE;
MPFR_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include; export MPFR_INCLUDE;
FC=gfortran; export FC;
__MODULES_LMALTNAME=profile/base\&profile/default\&profile:gmp/6.2.1\&as\|gmp/default\&as\|gmp/latest:mpfr/4.1.0\&as\|mpfr/default\&as\|mpfr/latest:mpc/1.2.1\&as\|mpc/default\&as\|mpc/latest:gcc/11.3.0\&as\|gcc/default\&as\|gcc/latest; export __MODULES_LMALTNAME;
__MODULES_LMCONFLICT=gmp/6.2.1\&gmp:mpfr/4.1.0\&mpfr:mpc/1.2.1\&mpc:gcc/11.3.0\&gcc; export __MODULES_LMCONFLICT;
C_INCLUDE_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export C_INCLUDE_PATH;
GCC_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib; export GCC_LIB;
MPC_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include; export MPC_INCLUDE;
F77=gfortran; export F77;
GMP_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22; export GMP_HOME;
GCC_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza; export GCC_HOME;
PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/bin:/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin; export PATH;
GMP_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export GMP_INC;
CC=gcc; export CC;
MPFR_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include; export MPFR_INC;
test 0;'
++ GCC_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include
++ export GCC_INCLUDE
++ MPC_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb
++ export MPC_HOME
++ LD_LIBRARY_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export LD_LIBRARY_PATH
++ CPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export CPATH
++ MANPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man
++ export MANPATH
++ MPC_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include
++ export MPC_INC
++ LIBRARY_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export LIBRARY_PATH
++ _LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0
++ export _LMFILES_
++ GMP_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export GMP_LIB
++ CMAKE_PREFIX_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/.
++ export CMAKE_PREFIX_PATH
++ LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0
++ export LOADEDMODULES
++ CXX=g++
++ export CXX
++ MPFR_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib
++ export MPFR_LIB
++ __MODULES_LMTAG='gmp/6.2.1&auto-loaded:mpfr/4.1.0&auto-loaded:mpc/1.2.1&auto-loaded'
++ export __MODULES_LMTAG
++ PKG_CONFIG_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib/pkgconfig
++ export PKG_CONFIG_PATH
++ MPFR_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc
++ export MPFR_HOME
++ GCC_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include
++ export GCC_INC
++ MPC_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib
++ export MPC_LIB
++ __MODULES_LMPREREQ='mpfr/4.1.0&gmp/6.2.1:mpc/1.2.1&gmp/6.2.1&mpfr/4.1.0:gcc/11.3.0&gmp/6.2.1&mpc/1.2.1&mpfr/4.1.0'
++ export __MODULES_LMPREREQ
++ CPLUS_INCLUDE_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export CPLUS_INCLUDE_PATH
++ F90=gfortran
++ export F90
++ GMP_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export GMP_INCLUDE
++ MPFR_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include
++ export MPFR_INCLUDE
++ FC=gfortran
++ export FC
++ __MODULES_LMALTNAME='profile/base&profile/default&profile:gmp/6.2.1&as|gmp/default&as|gmp/latest:mpfr/4.1.0&as|mpfr/default&as|mpfr/latest:mpc/1.2.1&as|mpc/default&as|mpc/latest:gcc/11.3.0&as|gcc/default&as|gcc/latest'
++ export __MODULES_LMALTNAME
++ __MODULES_LMCONFLICT='gmp/6.2.1&gmp:mpfr/4.1.0&mpfr:mpc/1.2.1&mpc:gcc/11.3.0&gcc'
++ export __MODULES_LMCONFLICT
++ C_INCLUDE_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export C_INCLUDE_PATH
++ GCC_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib
++ export GCC_LIB
++ MPC_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include
++ export MPC_INCLUDE
++ F77=gfortran
++ export F77
++ GMP_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22
++ export GMP_HOME
++ GCC_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza
++ export GCC_HOME
++ PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/bin:/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
++ export PATH
++ GMP_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export GMP_INC
++ CC=gcc
++ export CC
++ MPFR_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include
++ export MPFR_INC
++ test 0
+ _mlstatus=0
+ return 0
+ module load cuda
+ local _mlredir=1
+ '[' -n '' ']'
+ case " $@ " in
+ '[' 1 -eq 0 ']'
+ _module_raw load cuda
++ /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/tcl-8.6.12-rdtv2pt4tnckxsgwtowik3sbexmxolve/bin/tclsh /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/libexec/modulecmd.tcl bash load cuda
+ eval 'LD_LIBRARY_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/compat:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export LD_LIBRARY_PATH;
CUDA_INCLUDE=/leonardo/prod/opt/compilers/cuda/11.8/none/include; export CUDA_INCLUDE;
CPATH=/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export CPATH;
LIBRARY_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export LIBRARY_PATH;
MANPATH=/leonardo/prod/opt/compilers/cuda/11.8/none/share/man:/leonardo/prod/opt/compilers/cuda/11.8/none/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man; export MANPATH;
_LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0:/leonardo/prod/opt/modulefiles/base/compilers/cuda/11.8; export _LMFILES_;
LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0:cuda/11.8; export LOADEDMODULES;
CMAKE_PREFIX_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/.; export CMAKE_PREFIX_PATH;
PKG_CONFIG_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/lib64/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib/pkgconfig; export PKG_CONFIG_PATH;
CUDA_INC=/leonardo/prod/opt/compilers/cuda/11.8/none/include; export CUDA_INC;
CPLUS_INCLUDE_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export CPLUS_INCLUDE_PATH;
__MODULES_LMALTNAME=profile/base\&profile/default\&profile:gmp/6.2.1\&as\|gmp/default\&as\|gmp/latest:mpfr/4.1.0\&as\|mpfr/default\&as\|mpfr/latest:mpc/1.2.1\&as\|mpc/default\&as\|mpc/latest:gcc/11.3.0\&as\|gcc/default\&as\|gcc/latest:cuda/11.8\&as\|cuda/default\&as\|cuda/latest; export __MODULES_LMALTNAME;
__MODULES_LMCONFLICT=gmp/6.2.1\&gmp:mpfr/4.1.0\&mpfr:mpc/1.2.1\&mpc:gcc/11.3.0\&gcc:cuda/11.8\&cuda; export __MODULES_LMCONFLICT;
C_INCLUDE_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export C_INCLUDE_PATH;
CUDA_LIB=/leonardo/prod/opt/compilers/cuda/11.8/none/lib64; export CUDA_LIB;
CUDA_HOME=/leonardo/prod/opt/compilers/cuda/11.8/none; export CUDA_HOME;
PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/samples/bin/x86_64/linux/release/:/leonardo/prod/opt/compilers/cuda/11.8/none/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/bin:/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin; export PATH;
test 0;'
++ LD_LIBRARY_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/compat:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export LD_LIBRARY_PATH
++ CUDA_INCLUDE=/leonardo/prod/opt/compilers/cuda/11.8/none/include
++ export CUDA_INCLUDE
++ CPATH=/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export CPATH
++ LIBRARY_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export LIBRARY_PATH
++ MANPATH=/leonardo/prod/opt/compilers/cuda/11.8/none/share/man:/leonardo/prod/opt/compilers/cuda/11.8/none/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man
++ export MANPATH
++ _LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0:/leonardo/prod/opt/modulefiles/base/compilers/cuda/11.8
++ export _LMFILES_
++ LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0:cuda/11.8
++ export LOADEDMODULES
++ CMAKE_PREFIX_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/.
++ export CMAKE_PREFIX_PATH
++ PKG_CONFIG_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/lib64/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib/pkgconfig
++ export PKG_CONFIG_PATH
++ CUDA_INC=/leonardo/prod/opt/compilers/cuda/11.8/none/include
++ export CUDA_INC
++ CPLUS_INCLUDE_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export CPLUS_INCLUDE_PATH
++ __MODULES_LMALTNAME='profile/base&profile/default&profile:gmp/6.2.1&as|gmp/default&as|gmp/latest:mpfr/4.1.0&as|mpfr/default&as|mpfr/latest:mpc/1.2.1&as|mpc/default&as|mpc/latest:gcc/11.3.0&as|gcc/default&as|gcc/latest:cuda/11.8&as|cuda/default&as|cuda/latest'
++ export __MODULES_LMALTNAME
++ __MODULES_LMCONFLICT='gmp/6.2.1&gmp:mpfr/4.1.0&mpfr:mpc/1.2.1&mpc:gcc/11.3.0&gcc:cuda/11.8&cuda'
++ export __MODULES_LMCONFLICT
++ C_INCLUDE_PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export C_INCLUDE_PATH
++ CUDA_LIB=/leonardo/prod/opt/compilers/cuda/11.8/none/lib64
++ export CUDA_LIB
++ CUDA_HOME=/leonardo/prod/opt/compilers/cuda/11.8/none
++ export CUDA_HOME
++ PATH=/leonardo/prod/opt/compilers/cuda/11.8/none/samples/bin/x86_64/linux/release/:/leonardo/prod/opt/compilers/cuda/11.8/none/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/bin:/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
++ export PATH
++ test 0
+ _mlstatus=0
+ return 0
+ module load profile/deeplrn
+ local _mlredir=1
+ '[' -n '' ']'
+ case " $@ " in
+ '[' 1 -eq 0 ']'
+ _module_raw load profile/deeplrn
++ /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/tcl-8.6.12-rdtv2pt4tnckxsgwtowik3sbexmxolve/bin/tclsh /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/libexec/modulecmd.tcl bash load profile/deeplrn
+ eval '_LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0:/leonardo/prod/opt/modulefiles/base/compilers/cuda/11.8:/leonardo/prod/opt/modulefiles/profiles/profile/deeplrn; export _LMFILES_;
LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0:cuda/11.8:profile/deeplrn; export LOADEDMODULES;
MODULEPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/modulefiles:/leonardo/prod/opt/modulefiles/profiles:/leonardo/prod/opt/modulefiles/base/archive:/leonardo/prod/opt/modulefiles/base/dependencies:/leonardo/prod/opt/modulefiles/base/data:/leonardo/prod/opt/modulefiles/base/environment:/leonardo/prod/opt/modulefiles/base/libraries:/leonardo/prod/opt/modulefiles/base/tools:/leonardo/prod/opt/modulefiles/base/compilers:/leonardo/prod/opt/modulefiles/base/applications:/leonardo/prod/opt/modulefiles/deeplrn/archive:/leonardo/prod/opt/modulefiles/deeplrn/dependencies:/leonardo/prod/opt/modulefiles/deeplrn/data:/leonardo/prod/opt/modulefiles/deeplrn/environment:/leonardo/prod/opt/modulefiles/deeplrn/libraries:/leonardo/prod/opt/modulefiles/deeplrn/tools:/leonardo/prod/opt/modulefiles/deeplrn/compilers:/leonardo/prod/opt/modulefiles/deeplrn/applications; export MODULEPATH;
test 0;'
++ _LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0:/leonardo/prod/opt/modulefiles/base/compilers/cuda/11.8:/leonardo/prod/opt/modulefiles/profiles/profile/deeplrn
++ export _LMFILES_
++ LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0:cuda/11.8:profile/deeplrn
++ export LOADEDMODULES
++ MODULEPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/modulefiles:/leonardo/prod/opt/modulefiles/profiles:/leonardo/prod/opt/modulefiles/base/archive:/leonardo/prod/opt/modulefiles/base/dependencies:/leonardo/prod/opt/modulefiles/base/data:/leonardo/prod/opt/modulefiles/base/environment:/leonardo/prod/opt/modulefiles/base/libraries:/leonardo/prod/opt/modulefiles/base/tools:/leonardo/prod/opt/modulefiles/base/compilers:/leonardo/prod/opt/modulefiles/base/applications:/leonardo/prod/opt/modulefiles/deeplrn/archive:/leonardo/prod/opt/modulefiles/deeplrn/dependencies:/leonardo/prod/opt/modulefiles/deeplrn/data:/leonardo/prod/opt/modulefiles/deeplrn/environment:/leonardo/prod/opt/modulefiles/deeplrn/libraries:/leonardo/prod/opt/modulefiles/deeplrn/tools:/leonardo/prod/opt/modulefiles/deeplrn/compilers:/leonardo/prod/opt/modulefiles/deeplrn/applications
++ export MODULEPATH
++ test 0
+ _mlstatus=0
+ return 0
+ module load cineca-ai
+ local _mlredir=1
+ '[' -n '' ']'
+ case " $@ " in
+ '[' 1 -eq 0 ']'
+ _module_raw load cineca-ai
++ /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/tcl-8.6.12-rdtv2pt4tnckxsgwtowik3sbexmxolve/bin/tclsh /leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/libexec/modulecmd.tcl bash load cineca-ai
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
+ eval 'LD_LIBRARY_PATH=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/lib:/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/lib64:/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib:/leonardo/prod/opt/compilers/cuda/11.8/none/compat:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export LD_LIBRARY_PATH;
CPATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/python-3.10.8-eauysn2mronkqqffs7r6bvftsdpsfm4b/include/python3.10:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include:/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export CPATH;
LIBRARY_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib; export LIBRARY_PATH;
MANPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/share/man:/leonardo/prod/opt/compilers/cuda/11.8/none/share/man:/leonardo/prod/opt/compilers/cuda/11.8/none/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man; export MANPATH;
ZLIB_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk; export ZLIB_HOME;
CINECA_AI_LIB=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/lib; export CINECA_AI_LIB;
MPIF77=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpif77; export MPIF77;
_LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0:/leonardo/prod/opt/modulefiles/base/compilers/cuda/11.8:/leonardo/prod/opt/modulefiles/profiles/profile/deeplrn:/leonardo/prod/opt/modulefiles/base/libraries/zlib/1.2.13--gcc--11.3.0:/leonardo/prod/opt/modulefiles/base/libraries/openmpi/4.1.4--gcc--11.3.0-cuda-11.8:/leonardo/prod/opt/modulefiles/deeplrn/libraries/cineca-ai/3.0.0; export _LMFILES_;
LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0:cuda/11.8:profile/deeplrn:zlib/1.2.13--gcc--11.3.0:openmpi/4.1.4--gcc--11.3.0-cuda-11.8:cineca-ai/3.0.0; export LOADEDMODULES;
CMAKE_PREFIX_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/.:/leonardo/prod/opt/compilers/cuda/11.8/none/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/.; export CMAKE_PREFIX_PATH;
OPENMPI_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include; export OPENMPI_INCLUDE;
__MODULES_LMTAG=gmp/6.2.1\&auto-loaded:mpfr/4.1.0\&auto-loaded:mpc/1.2.1\&auto-loaded:zlib/1.2.13--gcc--11.3.0\&auto-loaded:openmpi/4.1.4--gcc--11.3.0-cuda-11.8\&auto-loaded; export __MODULES_LMTAG;
PKG_CONFIG_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib/pkgconfig:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib/pkgconfig; export PKG_CONFIG_PATH;
MPICC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpicc; export MPICC;
ZLIB_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include; export ZLIB_INCLUDE;
OMPI_MCA_coll_hcoll_enable=0; export OMPI_MCA_coll_hcoll_enable;
__MODULES_LMPREREQ=mpfr/4.1.0\&gmp/6.2.1:mpc/1.2.1\&gmp/6.2.1\&mpfr/4.1.0:gcc/11.3.0\&gmp/6.2.1\&mpc/1.2.1\&mpfr/4.1.0:openmpi/4.1.4--gcc--11.3.0-cuda-11.8\&zlib/1.2.13--gcc--11.3.0:cineca-ai/3.0.0\&cuda/11.8\&openmpi/4.1.4--gcc--11.3.0-cuda-11.8; export __MODULES_LMPREREQ;
CPLUS_INCLUDE_PATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include:/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export CPLUS_INCLUDE_PATH;
CINECA_AI_INCLUDE=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/include; export CINECA_AI_INCLUDE;
OPENMPI_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn; export OPENMPI_HOME;
MPICXX=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpic++; export MPICXX;
OPENMPI_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include; export OPENMPI_INC;
__MODULES_LMALTNAME=profile/base\&profile/default\&profile:gmp/6.2.1\&as\|gmp/default\&as\|gmp/latest:mpfr/4.1.0\&as\|mpfr/default\&as\|mpfr/latest:mpc/1.2.1\&as\|mpc/default\&as\|mpc/latest:gcc/11.3.0\&as\|gcc/default\&as\|gcc/latest:cuda/11.8\&as\|cuda/default\&as\|cuda/latest:zlib/1.2.13--gcc--11.3.0\&as\|zlib/default\&as\|zlib/latest:cineca-ai/3.0.0\&as\|cineca-ai/default\&as\|cineca-ai/latest; export __MODULES_LMALTNAME;
__MODULES_LMCONFLICT=gmp/6.2.1\&gmp:mpfr/4.1.0\&mpfr:mpc/1.2.1\&mpc:gcc/11.3.0\&gcc:cuda/11.8\&cuda:zlib/1.2.13--gcc--11.3.0\&zlib:openmpi/4.1.4--gcc--11.3.0-cuda-11.8\&openmpi:cineca-ai/3.0.0\&cineca-ai; export __MODULES_LMCONFLICT;
ZLIB_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include; export ZLIB_INC;
C_INCLUDE_PATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include:/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include; export C_INCLUDE_PATH;
CINECA_AI_HOME=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none; export CINECA_AI_HOME;
CINECA_AI_INC=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/include; export CINECA_AI_INC;
MPIF90=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpif90; export MPIF90;
PATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/bin:/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin:/leonardo/prod/opt/compilers/cuda/11.8/none/samples/bin/x86_64/linux/release/:/leonardo/prod/opt/compilers/cuda/11.8/none/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/bin:/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin; export PATH;
OPENMPI_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib; export OPENMPI_LIB;
ZLIB_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib; export ZLIB_LIB;
test 0;'
++ LD_LIBRARY_PATH=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/lib:/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/lib64:/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib:/leonardo/prod/opt/compilers/cuda/11.8/none/compat:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export LD_LIBRARY_PATH
++ CPATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/python-3.10.8-eauysn2mronkqqffs7r6bvftsdpsfm4b/include/python3.10:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include:/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export CPATH
++ LIBRARY_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib64:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib
++ export LIBRARY_PATH
++ MANPATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/share/man:/leonardo/prod/opt/compilers/cuda/11.8/none/share/man:/leonardo/prod/opt/compilers/cuda/11.8/none/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/share/man:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/share/man
++ export MANPATH
++ ZLIB_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk
++ export ZLIB_HOME
++ CINECA_AI_LIB=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/lib
++ export CINECA_AI_LIB
++ MPIF77=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpif77
++ export MPIF77
++ _LMFILES_=/leonardo/prod/opt/modulefiles/profiles/profile/base:/leonardo/prod/opt/modulefiles/base/dependencies/gmp/6.2.1:/leonardo/prod/opt/modulefiles/base/dependencies/mpfr/4.1.0:/leonardo/prod/opt/modulefiles/base/dependencies/mpc/1.2.1:/leonardo/prod/opt/modulefiles/base/compilers/gcc/11.3.0:/leonardo/prod/opt/modulefiles/base/compilers/cuda/11.8:/leonardo/prod/opt/modulefiles/profiles/profile/deeplrn:/leonardo/prod/opt/modulefiles/base/libraries/zlib/1.2.13--gcc--11.3.0:/leonardo/prod/opt/modulefiles/base/libraries/openmpi/4.1.4--gcc--11.3.0-cuda-11.8:/leonardo/prod/opt/modulefiles/deeplrn/libraries/cineca-ai/3.0.0
++ export _LMFILES_
++ LOADEDMODULES=profile/base:gmp/6.2.1:mpfr/4.1.0:mpc/1.2.1:gcc/11.3.0:cuda/11.8:profile/deeplrn:zlib/1.2.13--gcc--11.3.0:openmpi/4.1.4--gcc--11.3.0-cuda-11.8:cineca-ai/3.0.0
++ export LOADEDMODULES
++ CMAKE_PREFIX_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/.:/leonardo/prod/opt/compilers/cuda/11.8/none/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/.:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/.
++ export CMAKE_PREFIX_PATH
++ OPENMPI_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include
++ export OPENMPI_INCLUDE
++ __MODULES_LMTAG='gmp/6.2.1&auto-loaded:mpfr/4.1.0&auto-loaded:mpc/1.2.1&auto-loaded:zlib/1.2.13--gcc--11.3.0&auto-loaded:openmpi/4.1.4--gcc--11.3.0-cuda-11.8&auto-loaded'
++ export __MODULES_LMTAG
++ PKG_CONFIG_PATH=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib/pkgconfig:/leonardo/prod/opt/compilers/cuda/11.8/none/lib64/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/lib/pkgconfig:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/lib/pkgconfig
++ export PKG_CONFIG_PATH
++ MPICC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpicc
++ export MPICC
++ ZLIB_INCLUDE=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include
++ export ZLIB_INCLUDE
++ OMPI_MCA_coll_hcoll_enable=0
++ export OMPI_MCA_coll_hcoll_enable
++ __MODULES_LMPREREQ='mpfr/4.1.0&gmp/6.2.1:mpc/1.2.1&gmp/6.2.1&mpfr/4.1.0:gcc/11.3.0&gmp/6.2.1&mpc/1.2.1&mpfr/4.1.0:openmpi/4.1.4--gcc--11.3.0-cuda-11.8&zlib/1.2.13--gcc--11.3.0:cineca-ai/3.0.0&cuda/11.8&openmpi/4.1.4--gcc--11.3.0-cuda-11.8'
++ export __MODULES_LMPREREQ
++ CPLUS_INCLUDE_PATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include:/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export CPLUS_INCLUDE_PATH
++ CINECA_AI_INCLUDE=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/include
++ export CINECA_AI_INCLUDE
++ OPENMPI_HOME=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn
++ export OPENMPI_HOME
++ MPICXX=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpic++
++ export MPICXX
++ OPENMPI_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include
++ export OPENMPI_INC
++ __MODULES_LMALTNAME='profile/base&profile/default&profile:gmp/6.2.1&as|gmp/default&as|gmp/latest:mpfr/4.1.0&as|mpfr/default&as|mpfr/latest:mpc/1.2.1&as|mpc/default&as|mpc/latest:gcc/11.3.0&as|gcc/default&as|gcc/latest:cuda/11.8&as|cuda/default&as|cuda/latest:zlib/1.2.13--gcc--11.3.0&as|zlib/default&as|zlib/latest:cineca-ai/3.0.0&as|cineca-ai/default&as|cineca-ai/latest'
++ export __MODULES_LMALTNAME
++ __MODULES_LMCONFLICT='gmp/6.2.1&gmp:mpfr/4.1.0&mpfr:mpc/1.2.1&mpc:gcc/11.3.0&gcc:cuda/11.8&cuda:zlib/1.2.13--gcc--11.3.0&zlib:openmpi/4.1.4--gcc--11.3.0-cuda-11.8&openmpi:cineca-ai/3.0.0&cineca-ai'
++ export __MODULES_LMCONFLICT
++ ZLIB_INC=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include
++ export ZLIB_INC
++ C_INCLUDE_PATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/include:/leonardo/prod/opt/compilers/cuda/11.8/none/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpc-1.2.1-ndktnvrbytlmmfwre4fs5qbyzzso7fxb/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/mpfr-4.1.0-w4ofd2ll4ftu53yawc4d3sssrmeo2huc/include:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gmp-6.2.1-i7u7hnaqpscmi2x4ffsz6so6fftszm22/include
++ export C_INCLUDE_PATH
++ CINECA_AI_HOME=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none
++ export CINECA_AI_HOME
++ CINECA_AI_INC=/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/include
++ export CINECA_AI_INC
++ MPIF90=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin/mpif90
++ export MPIF90
++ PATH=/leonardo/prod/spack/03/ccsdeploy/spack_deploy/envs/cineca-ai-3/view/bin:/leonardo/prod/opt/libraries/cineca-ai/3.0.0/none/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/bin:/leonardo/prod/opt/compilers/cuda/11.8/none/samples/bin/x86_64/linux/release/:/leonardo/prod/opt/compilers/cuda/11.8/none/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/gcc-11.3.0-tm6phj7wkcw7cuy6gjixemkvh5x2mhza/bin:/leonardo_work/IscrC_GELATINO/gpuccett/models/model_venv/bin:/cineca/bin:/leonardo/home/userexternal/gpuccett/.vscode-server/bin/abd2f3db4bdb28f9e95536dfa84d8479f1eb312d/bin/remote-cli:/cineca/bin:/leonardo/home/userexternal/gpuccett/.local/bin:/leonardo/home/userexternal/gpuccett/bin:/cineca/bin:/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-8.5.0/environment-modules-5.2.0-rz47odw4phlhzhhbz7b65nv5s5othgmi/bin:/usr/local/bin:/usr/bin:/usr/local/sbin:/usr/sbin
++ export PATH
++ OPENMPI_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/openmpi-4.1.4-si334jjzldoxyl3jbbb3cf6legzshlqn/lib
++ export OPENMPI_LIB
++ ZLIB_LIB=/leonardo/prod/spack/03/install/0.19/linux-rhel8-icelake/gcc-11.3.0/zlib-1.2.13-noknejuy3uxqyxfetsmtnvb6zna3zaxk/lib
++ export ZLIB_LIB
++ test 0
+ _mlstatus=0
+ return 0
+ source /leonardo_work/IscrC_GELATINO/gpuccett/llm-foundry_gpucce/venv/bin/activate
/var/spool/slurmd/job1604989/slurm_script: line 19: /leonardo_work/IscrC_GELATINO/gpuccett/llm-foundry_gpucce/venv/bin/activate: No such file or directory
+ srun /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/train/fine_tuning_commands/test_salloc_llama-70b-finetune_multinode_8nodes_4gpus.sbatch
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Unloading profile/base
  ERROR: Module evaluation aborted
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading gcc/11.3.0
  Loading requirement: gmp/6.2.1 mpfr/4.1.0 mpc/1.2.1
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
0: LOCAL_WORLD_SIZE=
0: LOCAL_WORLD_SIZE=4
0: NPROC=4
0: WORLD SIZE=32
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
Loading cineca-ai/3.0.0
  Loading requirement: zlib/1.2.13--gcc--11.3.0
    openmpi/4.1.4--gcc--11.3.0-cuda-11.8
4: LOCAL_WORLD_SIZE=
4: LOCAL_WORLD_SIZE=4
7: LOCAL_WORLD_SIZE=
4: NPROC=4
4: WORLD SIZE=32
7: LOCAL_WORLD_SIZE=4
7: NPROC=4
7: WORLD SIZE=32
3: LOCAL_WORLD_SIZE=
1: LOCAL_WORLD_SIZE=
3: LOCAL_WORLD_SIZE=4
3: NPROC=4
3: WORLD SIZE=32
1: LOCAL_WORLD_SIZE=4
1: NPROC=4
1: WORLD SIZE=32
2: LOCAL_WORLD_SIZE=
2: LOCAL_WORLD_SIZE=4
2: NPROC=4
2: WORLD SIZE=32
5: LOCAL_WORLD_SIZE=
5: LOCAL_WORLD_SIZE=4
5: NPROC=4
5: WORLD SIZE=32
6: LOCAL_WORLD_SIZE=
6: LOCAL_WORLD_SIZE=4
6: NPROC=4
6: WORLD SIZE=32
0: MASTER_ADDR=lrdn0170
0: MASTER PORT=54321
0: PYTHONUNBUFFERED=1
0: BASE_RANK=0, NODEID=0
0: LOCAL_RANK=0
1: MASTER_ADDR=lrdn0170
7: MASTER_ADDR=lrdn0170
7: MASTER PORT=54321
7: PYTHONUNBUFFERED=1
7: BASE_RANK=28, NODEID=7
7: LOCAL_RANK=0
1: MASTER PORT=54321
1: PYTHONUNBUFFERED=1
1: BASE_RANK=4, NODEID=1
1: LOCAL_RANK=0
3: MASTER_ADDR=lrdn0170
3: MASTER PORT=54321
3: PYTHONUNBUFFERED=1
3: BASE_RANK=12, NODEID=3
3: LOCAL_RANK=0
4: MASTER_ADDR=lrdn0170
4: MASTER PORT=54321
4: PYTHONUNBUFFERED=1
4: BASE_RANK=16, NODEID=4
4: LOCAL_RANK=0
2: MASTER_ADDR=lrdn0170
2: MASTER PORT=54321
2: PYTHONUNBUFFERED=1
2: BASE_RANK=8, NODEID=2
2: LOCAL_RANK=0
5: MASTER_ADDR=lrdn0170
5: MASTER PORT=54321
5: PYTHONUNBUFFERED=1
5: BASE_RANK=20, NODEID=5
5: LOCAL_RANK=0
6: MASTER_ADDR=lrdn0170
6: MASTER PORT=54321
6: PYTHONUNBUFFERED=1
6: BASE_RANK=24, NODEID=6
6: LOCAL_RANK=0
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building train loader...
Using pad_token, but it is not set yet.
Using pad_token, but it is not set yet.
Building train loader...
Building train loader...
Building train loader...
Building train loader...
Building train loader...
Using pad_token, but it is not set yet.
Using pad_token, but it is not set yet.
Using pad_token, but it is not set yet.
Building train loader...
Using pad_token, but it is not set yet.
Using pad_token, but it is not set yet.
Using pad_token, but it is not set yet.
Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 167/50245 [00:00<00:30, 1632.54 examples/s]Map:   1%|          | 419/50245 [00:00<00:23, 2143.79 examples/s]Map:   1%|         | 680/50245 [00:00<00:21, 2352.19 examples/s]Map:   2%|         | 931/50245 [00:00<00:20, 2409.70 examples/s]Map:   2%|         | 1238/50245 [00:00<00:24, 1976.92 examples/s]Map:   3%|         | 1471/50245 [00:00<00:23, 2069.61 examples/s]Map:   3%|         | 1709/50245 [00:00<00:22, 2155.93 examples/s]Map:   4%|         | 1950/50245 [00:00<00:21, 2228.38 examples/s]Map:   5%|         | 2274/50245 [00:01<00:21, 2197.88 examples/s]Map:   5%|         | 2513/50245 [00:01<00:21, 2246.42 examples/s]Map:   5%|         | 2751/50245 [00:01<00:20, 2280.68 examples/s]Map:   6%|         | 2986/50245 [00:01<00:20, 2296.67 examples/s]Map:   7%|         | 3290/50245 [00:01<00:21, 2189.57 examples/s]Map:   7%|         | 3544/50245 [00:01<00:20, 2280.00 examples/s]Map:   8%|         | 3884/50245 [00:01<00:20, 2271.75 examples/s]Map:   8%|         | 4117/50245 [00:01<00:21, 2183.75 examples/s]Map:   9%|         | 4353/50245 [00:01<00:20, 2227.26 examples/s]Map:   9%|         | 4603/50245 [00:02<00:19, 2296.79 examples/s]Map:  10%|         | 4946/50245 [00:02<00:19, 2290.21 examples/s]Map:  10%|         | 5267/50245 [00:02<00:20, 2236.81 examples/s]Map:  11%|         | 5523/50245 [00:02<00:19, 2312.94 examples/s]Map:  11%|        | 5768/50245 [00:02<00:18, 2345.87 examples/s]Map:  12%|        | 6127/50245 [00:02<00:19, 2287.65 examples/s]Map:  13%|        | 6375/50245 [00:02<00:18, 2331.89 examples/s]Map:  13%|        | 6628/50245 [00:02<00:18, 2381.93 examples/s]Map:  14%|        | 6888/50245 [00:03<00:17, 2439.10 examples/s]Map:  14%|        | 7250/50245 [00:03<00:18, 2339.47 examples/s]Map:  15%|        | 7495/50245 [00:03<00:18, 2363.19 examples/s]Map:  16%|        | 7866/50245 [00:03<00:17, 2397.12 examples/s]Map:  16%|        | 8200/50245 [00:03<00:17, 2336.54 examples/s]Map:  17%|        | 8441/50245 [00:03<00:17, 2352.43 examples/s]Map:  17%|        | 8692/50245 [00:03<00:17, 2389.85 examples/s]Map:  18%|        | 8947/50245 [00:03<00:17, 2429.24 examples/s]Map:  18%|        | 9279/50245 [00:04<00:17, 2347.91 examples/s]Map:  19%|        | 9541/50245 [00:04<00:16, 2412.13 examples/s]Map:  20%|        | 9906/50245 [00:04<00:16, 2415.51 examples/s]Map:  20%|        | 10245/50245 [00:04<00:17, 2295.38 examples/s]Map:  21%|        | 10482/50245 [00:04<00:17, 2311.92 examples/s]Map:  21%|       | 10739/50245 [00:04<00:16, 2373.03 examples/s]Map:  22%|       | 10990/50245 [00:04<00:16, 2406.23 examples/s]Map:  23%|       | 11309/50245 [00:04<00:16, 2300.14 examples/s]Map:  23%|       | 11557/50245 [00:05<00:16, 2344.88 examples/s]Map:  24%|       | 11814/50245 [00:05<00:15, 2403.75 examples/s]Map:  24%|       | 12142/50245 [00:05<00:16, 2323.25 examples/s]Map:  25%|       | 12384/50245 [00:05<00:16, 2345.33 examples/s]Map:  25%|       | 12636/50245 [00:05<00:15, 2390.16 examples/s]Map:  26%|       | 12908/50245 [00:05<00:15, 2479.08 examples/s]Map:  26%|       | 13257/50245 [00:05<00:15, 2366.90 examples/s]Map:  27%|       | 13501/50245 [00:05<00:15, 2383.96 examples/s]Map:  27%|       | 13746/50245 [00:05<00:15, 2397.25 examples/s]Map:  28%|       | 13997/50245 [00:06<00:14, 2422.76 examples/s]Map:  28%|       | 14312/50245 [00:06<00:15, 2298.52 examples/s]Map:  29%|       | 14550/50245 [00:06<00:15, 2319.10 examples/s]Map:  29%|       | 14802/50245 [00:06<00:14, 2372.88 examples/s]Map:  30%|       | 15138/50245 [00:06<00:15, 2319.85 examples/s]Map:  31%|       | 15381/50245 [00:06<00:14, 2346.38 examples/s]Map:  31%|      | 15738/50245 [00:06<00:14, 2355.19 examples/s]Map:  32%|      | 15984/50245 [00:06<00:14, 2379.40 examples/s]Map:  32%|      | 16299/50245 [00:07<00:14, 2277.09 examples/s]Map:  33%|      | 16564/50245 [00:07<00:14, 2368.01 examples/s]Map:  33%|      | 16822/50245 [00:07<00:13, 2419.32 examples/s]Map:  34%|      | 17150/50245 [00:07<00:14, 2332.40 examples/s]Map:  35%|      | 17519/50245 [00:07<00:13, 2373.40 examples/s]Map:  35%|      | 17779/50245 [00:07<00:13, 2423.79 examples/s]Map:  36%|      | 18129/50245 [00:07<00:13, 2331.71 examples/s]Map:  37%|      | 18374/50245 [00:07<00:13, 2356.74 examples/s]Map:  37%|      | 18629/50245 [00:08<00:13, 2403.51 examples/s]Map:  38%|      | 18879/50245 [00:08<00:12, 2427.43 examples/s]Map:  38%|      | 19133/50245 [00:08<00:13, 2321.39 examples/s]Map:  39%|      | 19382/50245 [00:08<00:13, 2363.48 examples/s]Map:  39%|Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 167/50245 [00:00<00:30, 1634.78 examples/s]Map:   1%|          | 419/50245 [00:00<00:23, 2145.68 examples/s]Map:   1%|         | 679/50245 [00:00<00:21, 2348.09 examples/s]Map:   2%|         | 928/50245 [00:00<00:20, 2399.76 examples/s]Map:   2%|         | 1238/50245 [00:00<00:24, 2041.29 examples/s]Map:   3%|         | 1472/50245 [00:00<00:22, 2123.03 examples/s]Map:   3%|         | 1711/50245 [00:00<00:22, 2195.19 examples/s]Map:   4%|         | 1956/50245 [00:00<00:21, 2265.76 examples/s]Map:   5%|         | 2279/50245 [00:01<00:21, 2218.84 examples/s]Map:   5%|         | 2518/50245 [00:01<00:21, 2261.66 examples/s]Map:   5%|         | 2757/50245 [00:01<00:20, 2291.08 examples/s]Map:   6%|         | 2994/50245 [00:01<00:20, 2309.65 examples/s]Map:   7%|         | 3296/50245 [00:01<00:21, 2197.04 examples/s]Map:   7%|         | 3548/50245 [00:01<00:20, 2281.26 examples/s]Map:   8%|      | 19632/50245 [00:08<00:12, 2399.41 examples/s]Map:  40%|      | 19885/50245 [00:08<00:12, 2434.65 examples/s]Map:  40%|      | 20246/50245 [00:08<00:12, 2335.12 examples/s]Map:  41%|      | 20504/50245 [00:08<00:12, 2395.29 examples/s]Map:  41%|     | 20754/50245 [00:08<00:12, 2420.05 examples/s]Map:  42%|     | 21070/50245 [00:09<00:12, 2299.65 examples/s]Map:  42%|     | 21319/50245 [00:09<00:12, 2344.88 examples/s]Map:  43%|     | 21571/50245 [00:09<00:12, 2387.67 examples/s]Map:  43%|     | 21823/50245 [00:09<00:11, 2420.39 examples/s]Map:  44%|     | 22136/50245 [00:09<00:12, 2291.99 examples/s]Map:  45%|     | 22379/50245 [00:09<00:11, 2325.49 examples/s]Map:  45%|     | 22629/50245 [00:09<00:11, 2369.03 examples/s]Map:  46%|     | 22883/50245 [00:09<00:11, 2416.60 examples/s]Map:  46%|     | 23248         | 3892/50245 [00:01<00:20, 2281.86 examples/s]Map:   8%|         | 4237/50245 [00:01<00:20, 2207.32 examples/s]Map:   9%|         | 4486/50245 [00:02<00:20, 2273.76 examples/s]Map:   9%|         | 4720/50245 [00:02<00:19, 2287.66 examples/s]Map:  10%|         | 5013/50245 [00:02<00:20, 2164.33 examples/s]Map:  10%|         | 5269/50245 [00:02<00:19, 2262.97 examples/s]Map:  11%|         | 5524/50245 [00:02<00:19, 2335.09 examples/s]Map:  11%|        | 5769/50245 [00:02<00:18, 2364.32 examples/s]Map:  12%|        | 6127/50245 [00:02<00:19, 2296.02 examples/s]Map:  13%|        | 6375/50245 [00:02<00:18, 2338.75 examples/s]Map:  13%|        | 6628/50245 [00:02<00:18, 2388.26 examples/s]Map:  14%|        | 6886/50245 [00:03<00:17, 2439.30 examples/s]Map:  14%|        | 7250/50245 [00:03<00:18, 2337.36 examples/s]Map:  15%|        | 7494/50245 [00:03<00:18, 2360.92 examples/s]Map:  16%|        | 7863/50245 [00:03<00:17, 2392/50245 [00:09<00:11, 2297.78 examples/s]Map:  47%|     | 23512/50245 [00:10<00:11, 2381.10 examples/s]Map:  48%|     | 23873/50245 [00:10<00:11, 2387.22 examples/s]Map:  48%|     | 24121/50245 [00:10<00:11, 2286.78 examples/s]Map:  48%|     | 24361/50245 [00:10<00:11, 2313.29 examples/s]Map:  49%|     | 24729/50245 [00:10<00:10, 2357.92 examples/s]Map:  50%|     | 24988/50245 [00:10<00:10, 2413.80 examples/s]Map:  50%|     | 25317/50245 [00:10<00:10, 2333.93 examples/s]Map:  51%|     | 25587/50245 [00:10<00:10, 2423.70 examples/s]Map:  52%|    | 25933/50245 [00:11<00:10, 2380.23 examples/s]Map:  52%|    | 26240/50245 [00:11<00:10, 2264.02 examples/s]Map:  53%|    | 26486/50245 [00:11<00:10, 2305.73 examples/s]Map:  53%|    | 26743/50245 [00:11<00:09, 2371.75 examples/s]Map:  54%|    | 26992Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 240/50245 [00:00<00:21, 2377.52 examples/s]Map:   1%|          | 498/50245 [00:00<00:19, 2488.91 examples/s]Map:   2%|         | 756/50245 [00:00<00:19, 2520.44 examples/s]Map:   2%|         | 1119/50245 [00:00<00:21, 2285.35 examples/s]Map:   3%|         | 1469/50245 [00:00<00:21, 2300.32 examples/s]Map:   3%|         | 1706/50245 [00:00<00:20, 2316.31 examples/s]Map:   4%|         | 1952/50245 [00:00<00:20, 2354.44 examples/s]Map:   5%|         | 2274/50245 [00:00<00:21, 2272.10 examples/s]Map:   5%|         | 2511/50245 [00:01<00:20, 2296.22 examples/s]Map:   5%|         | 2753/50245 [00:01<00:20, 2327.11 examples/s]Map:   6%|         | 3058/50245 [00:01<00:21, 2212.98 examples/s]Map:   7%|         | 3290/50245 [00:01<00:20, 2236.97 examples/s]Map:   7%|         | 3543/50245 [00:01<00:20, 2314.07 examples/s]Map:   8%|         | 3882/50245 [00:01<00:20, 2290.40 examples/s]Map:   8%|.85 examples/s]Map:  16%|        | 8195/50245 [00:03<00:18, 2331.12 examples/s]Map:  17%|        | 8435/50245 [00:03<00:17, 2345.71 examples/s]Map:  17%|        | 8688/50245 [00:03<00:17, 2389.79 examples/s]Map:  18%|        | 8941/50245 [00:03<00:17, 2426.44 examples/s]Map:  18%|        | 9267/50245 [00:04<00:17, 2331.44 examples/s]Map:  19%|        | 9530/50245 [00:04<00:16, 2407.54 examples/s]Map:  20%|        | 9892/50245 [00:04<00:16, 2405.21 examples/s]Map:  20%|        | 10244/50245 [00:04<00:17, 2293.51 examples/s]Map:  21%|        | 10481/50245 [00:04<00:17, 2307.52 examples/s]Map:  21%|       | 10737/50245 [00:04<00:16, 2367.68 examples/s]Map:  22%|       | 10990/50245 [00:04<00:16, 2402.34 examples/s]Map:  22%|       | 11305/50245 [00:04<00:16, 2290.73 examples/s]Map:  23%|       | 11554/50245 [00:05<00:16, 2337.75 examples/s]Map:  24%|       | 11809/50245 [00:05<00:16, 2392.45 examples//50245 [00:11<00:09, 2400.05 examples/s]Map:  54%|    | 27317/50245 [00:11<00:09, 2312.46 examples/s]Map:  55%|    | 27572/50245 [00:11<00:09, 2372.61 examples/s]Map:  56%|    | 27946/50245 [00:11<00:09, 2411.20 examples/s]Map:  56%|    | 28241/50245 [00:12<00:09, 2257.23 examples/s]Map:  57%|    | 28503/50245 [00:12<00:09, 2340.02 examples/s]Map:  57%|    | 28747/50245 [00:12<00:09, 2363.98 examples/s]Map:  58%|    | 28993/50245 [00:12<00:08, 2383.66 examples/s]Map:  58%|    | 29322/50245 [00:12<00:09, 2309.46 examples/s]Map:  59%|    | 29557/50245 [00:12<00:08, 2318.48 examples/s]Map:  59%|    | 29802/50245 [00:12<00:08, 2351.64 examples/s]Map:  60%|    | 30121/50245 [00:12<00:08, 2243.61 examples/s]Map:  60%|    | 30374/50245 [00:13<00:08, 2312.16 examples/s]Map:  61%|         | 4120/50245 [00:01<00:20, 2209.13 examples/s]Map:   9%|         | 4356/50245 [00:01<00:20, 2243.51 examples/s]Map:   9%|         | 4604/50245 [00:02<00:19, 2307.18 examples/s]Map:  10%|         | 4946/50245 [00:02<00:19, 2292.26 examples/s]Map:  10%|         | 5268/50245 [00:02<00:20, 2237.42 examples/s]Map:  11%|         | 5521/50245 [00:02<00:19, 2308.18 examples/s]Map:  11%|        | 5763/50245 [00:02<00:19, 2334.30 examples/s]Map:  12%|        | 6000/50245 [00:02<00:19, 2245.36 examples/s]Map:  12%|        | 6247/50245 [00:02<00:19, 2301.96 examples/s]Map:  13%|        | 6497/50245 [00:02<00:18, 2355.22 examples/s]Map:  13%|        | 6750/50245 [00:02<00:18, 2402.97 examples/s]Map:  14%|        | 7000/50245 [00:03<00:18, 2304.74 examples/s]Map:  14%|        | 7247/50245 [00:03<00:18, 2349.49 examples/s]Map:  15%|        | 7487/50245 [00:03<00:18, 2359.48 examples/s]Map:  16%|        | 7851/50245 [00:03<00:17, 2Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 244/50245 [00:00<00:20, 2402.87 examples/s]Map:   1%|          | 497/50245 [00:00<00:20, 2475.43 examples/s]Map:   2%|         | 755/50245 [00:00<00:19, 2519.35 examples/s]Map:   2%|         | 1119/50245 [00:00<00:21, 2281.29 examples/s]Map:   3%|         | 1469/50245 [00:00<00:21, 2298.27 examples/s]Map:   3%|         | 1706/50245 [00:00<00:20, 2313.92 examples/s]Map:   4%|         | 1948/50245 [00:00<00:20, 2342.48 examples/s]Map:   5%|         | 2268/50245 [00:00<00:21, 2259.03 examples/s]Map:   5%|         | 2505/50245 [00:01<00:20, 2286.36 examples/s]Map:   5%|         | 2747/50245 [00:01<00:20, 2317.04 examples/s]Map:   6%|         | 3046/50245 [00:01<00:21, 2191.58 examples/s]Map:   7%|         | 3278/50245 [00:01<00:21, 2222.00 examples/s]Map:   7%|         | 3530/50245 [00:01<00:20, 2297.47 examples/s]Map:   8%|         | 3873/50245 [00:01<00:20, 2286.76 examples/s]Map:   8%|s]Map:  24%|       | 12138/50245 [00:05<00:16, 2315.24 examples/s]Map:  25%|       | 12379/50245 [00:05<00:16, 2337.35 examples/s]Map:  25%|       | 12629/50245 [00:05<00:15, 2377.70 examples/s]Map:  26%|       | 12900/50245 [00:05<00:15, 2468.02 examples/s]Map:  26%|       | 13255/50245 [00:05<00:15, 2359.66 examples/s]Map:  27%|       | 13500/50245 [00:05<00:15, 2377.82 examples/s]Map:  27%|       | 13745/50245 [00:05<00:15, 2394.28 examples/s]Map:  28%|       | 13993/50245 [00:06<00:14, 2416.83 examples/s]Map:  28%|       | 14307/50245 [00:06<00:15, 2293.85 examples/s]Map:  29%|       | 14548/50245 [00:06<00:15, 2320.85 examples/s]Map:  29%|       | 14800/50245 [00:06<00:14, 2372.37 examples/s]Map:  30%|       | 15138/50245 [00:06<00:15, 2320.75 examples/s]Map:  31%|       | 15382/50245 [00:06<00:14, 2347.05 examples/s]Map:  31%|      | 15741/50245 [00:06<00:14, 235    | 30628/50245 [00:13<00:08, 2372.29 examples/s]Map:  61%|   | 30872/50245 [00:13<00:08, 2388.24 examples/s]Map:  62%|   | 31125/50245 [00:13<00:08, 2278.09 examples/s]Map:  62%|   | 31375/50245 [00:13<00:08, 2334.76 examples/s]Map:  63%|   | 31627/50245 [00:13<00:07, 2385.03 examples/s]Map:  63%|   | 31875/50245 [00:13<00:07, 2406.11 examples/s]Map:  64%|   | 32188/50245 [00:13<00:07, 2279.89 examples/s]Map:  65%|   | 32429/50245 [00:13<00:07, 2312.18 examples/s]Map:  65%|   | 32687/50245 [00:13<00:07, 2383.91 examples/s]Map:  66%|   | 32946/50245 [00:14<00:07, 2436.96 examples/s]Map:  66%|   | 33273/50245 [00:14<00:07, 2335.10 examples/s]Map:  67%|   | 33528/50245 [00:14<00:06, 2390.17 examples/s]Map:  67%|   | 33771/50245 [00:14<00:06, 239381.60 examples/s]Map:  16%|        | 8177/50245 [00:03<00:18, 2304.73 examples/s]Map:  17%|        | 8415/50245 [00:03<00:18, 2321.05 examples/s]Map:  17%|        | 8664/50245 [00:03<00:17, 2362.77 examples/s]Map:  18%|        | 8913/50245 [00:03<00:17, 2392.78 examples/s]Map:  18%|        | 9247/50245 [00:04<00:17, 2299.40 examples/s]Map:  19%|        | 9510/50245 [00:04<00:17, 2382.39 examples/s]Map:  20%|        | 9865/50245 [00:04<00:17, 2373.28 examples/s]Map:  20%|        | 10179/50245 [00:04<00:17, 2276.03 examples/s]Map:  21%|        | 10413/50245 [00:04<00:17, 2288.46 examples/s]Map:  21%|        | 10655/50245 [00:04<00:17, 2320.21 examples/s]Map:  22%|       | 10911/50245 [00:04<00:16, 2381.70 examples/s]Map:  22%|       | 11246/50245 [00:04<00:17, 2279.00 examples/s]Map:  23%|       | 11488/50245 [00:04<00:16, 2310.07 examples/s]Map:  23%|       | 11743/50245 [00:05<00:16, 2371.64 examples         | 4177/50245 [00:01<00:20, 2194.73 examples/s]Map:   9%|         | 4415/50245 [00:01<00:20, 2239.54 examples/s]Map:   9%|         | 4660/50245 [00:02<00:19, 2290.54 examples/s]Map:  10%|         | 4995/50245 [00:02<00:19, 2266.10 examples/s]Map:  11%|         | 5310/50245 [00:02<00:20, 2207.90 examples/s]Map:  11%|         | 5566/50245 [00:02<00:19, 2290.98 examples/s]Map:  12%|        | 5804/50245 [00:02<00:19, 2311.77 examples/s]Map:  12%|        | 6126/50245 [00:02<00:19, 2249.66 examples/s]Map:  13%|        | 6371/50245 [00:02<00:19, 2297.29 examples/s]Map:  13%|        | 6624/50245 [00:02<00:18, 2355.52 examples/s]Map:  14%|        | 6877/50245 [00:02<00:18, 2402.38 examples/s]Map:  14%|        | 7252/50245 [00:03<00:18, 2313.11 examples/s]Map:  15%|        | 7493/50245 [00:03<00:18, 2334.96 examples/s]Map:  15%|        | 7730/50245 [00:03<00:18, 2341.72 examples/s]Map:  16%|        | 7984/50245 [00:03<00:17, 29.82 examples/s]Map:  32%|      | 15983/50245 [00:06<00:14, 2371.35 examples/s]Map:  32%|      | 16299/50245 [00:07<00:14, 2270.00 examples/s]Map:  33%|      | 16564/50245 [00:07<00:14, 2360.96 examples/s]Map:  33%|      | 16822/50245 [00:07<00:13, 2413.51 examples/s]Map:  34%|      | 17151/50245 [00:07<00:14, 2330.19 examples/s]Map:  35%|      | 17521/50245 [00:07<00:13, 2371.12 examples/s]Map:  35%|      | 17779/50245 [00:07<00:13, 2420.22 examples/s]Map:  36%|      | 18129/50245 [00:07<00:13, 2326.15 examples/s]Map:  37%|      | 18370/50245 [00:07<00:13, 2345.22 examples/s]Map:  37%|      | 18625/50245 [00:08<00:13, 2394.51 examples/s]Map:  38%|      | 18874/50245 [00:08<00:12, 2416.54 examples/s]Map:  38%|      | 19199/50245 [00:08<00:13, 2321.85 examples/s]Map:  39%|      | 19447/50245 [00:08<00:13, 2359.68 examples/s]Map:  39%|Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 246/50245 [00:00<00:20, 2435.91 examples/s]Map:   1%|          | 504/50245 [00:00<00:19, 2513.82 examples/s]Map:   2%|         | 764/50245 [00:00<00:19, 2548.84 examples/s]Map:   2%|         | 1121/50245 [00:00<00:21, 2314.86 examples/s]Map:   3%|         | 1476/50245 [00:00<00:20, 2330.86 examples/s]Map:   3%|         | 1716/50245 [00:00<00:20, 2347.06 examples/s]Map:   4%|         | 1968/50245 [00:00<00:20, 2394.00 examples/s]Map:   5%|         | 2290/50245 [00:00<00:20, 2297.62 examples/s]Map:   5%|         | 2529/50245 [00:01<00:20, 2321.54 examples/s]Map:   6%|         | 2769/50245 [00:01<00:20, 2336.94 examples/s]Map:   6%|         | 3117/50245 [00:01<00:21, 2233.49 examples/s]Map:   7%|         | 3355/50245 [00:01<00:20, 2269.38 examples/s]Map:   7%|         | 3605/50245 [00:01<00:20, 2329.21 examples/s]Map:   8%|         | 3957/50245 [00:01<00:19, 2329.87 examples/s]Map:   8%|Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 234/50245 [00:00<00:21, 2322.28 examples/s]Map:   1%|          | 488/50245 [00:00<00:20, 2437.07 examples/s]Map:   1%|         | 741/50245 [00:00<00:19, 2476.99 examples/s]Map:   2%|         | 1041/50245 [00:00<00:21, 2237.74 examples/s]Map:   3%|         | 1381/50245 [00:00<00:21, 2247.51 examples/s]Map:   3%|         | 1728/50245 [00:00<00:21, 2268.90 examples/s]Map:   4%|         | 1971/50245 [00:00<00:20, 2305.06 examples/s]Map:   5%|         | 2277/50245 [00:01<00:21, 2207.31 examples/s]Map:   5%|         | 2509/50245 [00:01<00:21, 2231.90 examples/s]Map:   5%|         | 2746/50245 [00:01<00:20, 2266.17 examples/s]Map:   6%|         | 3038/50245 [00:01<00:21, 2146.05 examples/s]Map:   6%|         | 3264/50245 [00:01<00:21, 2171.73 examples/s]Map:   7%|         | 3512/50245 [00:01<00:20, 2251.51 examples/s]Map:   8%|         | 3850/50245 [00:01<00:20, 2246.79 examples/s]Map:   8%|8.29 examples/s]Map:  68%|   | 34130/50245 [00:14<00:06, 2305.09 examples/s]Map:  68%|   | 34391/50245 [00:14<00:06, 2380.74 examples/s]Map:  69%|   | 34645/50245 [00:14<00:06, 2419.82 examples/s]Map:  69%|   | 34914/50245 [00:14<00:06, 2490.62 examples/s]Map:  70%|   | 35248/50245 [00:15<00:06, 2360.30 examples/s]Map:  71%|   | 35495/50245 [00:15<00:06, 2384.92 examples/s]Map:  71%|  | 35858/50245 [00:15<00:06, 2394.14 examples/s]Map:  72%|  | 36198/50245 [00:15<00:05, 2347.96 examples/s]Map:  73%|  | 36447/50245 [00:15<00:05, 2379.82 examples/s]Map:  73%|  | 36694/50245 [00:15<00:05, 2400.17 examples/s]Map:  74%|  | 36942/50245 [00:15<00:05, 2418.06 examples/s]Map:  74%|  | 37232/50245 [00:15<00:05, 2238.27 examples/s]Map:  75%|/s]Map:  24%|       | 11986/50245 [00:05<00:16, 2385.99 examples/s]Map:  24%|       | 12308/50245 [00:05<00:16, 2292.50 examples/s]Map:  25%|       | 12675/50245 [00:05<00:16, 2340.36 examples/s]Map:  26%|       | 12938/50245 [00:05<00:15, 2411.08 examples/s]Map:  26%|       | 13266/50245 [00:05<00:15, 2331.01 examples/s]Map:  27%|       | 13505/50245 [00:05<00:15, 2342.74 examples/s]Map:  27%|       | 13746/50245 [00:05<00:15, 2358.81 examples/s]Map:  28%|       | 13991/50245 [00:06<00:15, 2380.04 examples/s]Map:  28%|       | 14304/50245 [00:06<00:15, 2266.19 examples/s]Map:  29%|       | 14541/50245 [00:06<00:15, 2290.75 examples/s]Map:  29%|       | 14790/50245 [00:06<00:15, 2340.57 examples/s]Map:  30%|       | 15124/50245 [00:06<00:15, 2289.00 examples/s]Map:  31%|       | 15366/50245 [00:06<00:15, 2319.99 examples/s]Map:  31%|      | 15718/50245 [00:06<00:14, 23391.31 examples/s]Map:  17%|        | 8304/50245 [00:03<00:18, 2295.32 examples/s]Map:  17%|        | 8547/50245 [00:03<00:17, 2327.54 examples/s]Map:  18%|        | 8802/50245 [00:03<00:17, 2383.33 examples/s]Map:  18%|        | 9125/50245 [00:03<00:17, 2291.95 examples/s]Map:  19%|        | 9387/50245 [00:04<00:17, 2373.17 examples/s]Map:  19%|        | 9631/50245 [00:04<00:16, 2389.08 examples/s]Map:  20%|        | 9877/50245 [00:04<00:16, 2402.99 examples/s]Map:  20%|        | 10186/50245 [00:04<00:17, 2271.90 examples/s]Map:  21%|        | 10424/50245 [00:04<00:17, 2299.41 examples/s]Map:  21%|        | 10670/50245 [00:04<00:16, 2338.76 examples/s]Map:  22%|       | 10925/50245 [00:04<00:16, 2395.45 examples/s]Map:  22%|       | 11246/50245 [00:04<00:17, 2286.31 examples/s]Map:  23%|       | 11490/50245 [00:04<00:16, 2324.65 examples/s]Map:  23%|       | 11749/50245 [00:05<00:16, 2389.93 examples      | 19698/50245 [00:08<00:12, 2396.41 examples/s]Map:  40%|      | 19956/50245 [00:08<00:12, 2444.61 examples/s]Map:  40%|      | 20275/50245 [00:08<00:12, 2324.70 examples/s]Map:  41%|      | 20531/50245 [00:08<00:12, 2384.87 examples/s]Map:  41%|     | 20781/50245 [00:08<00:12, 2411.49 examples/s]Map:  42%|     | 21129/50245 [00:09<00:12, 2301.41 examples/s]Map:  43%|     | 21369/50245 [00:09<00:12, 2325.00 examples/s]Map:  43%|     | 21626/50245 [00:09<00:11, 2386.67 examples/s]Map:  44%|     | 21869/50245 [00:09<00:11, 2396.20 examples/s]Map:  44%|     | 22185/50245 [00:09<00:12, 2284.97 examples/s]Map:  45%|     | 22430/50245 [00:09<00:11, 2326.56 examples/s]Map:  45%|     | 22682/50245 [00:09<00:11, 2375.13 examples/s]Map:  46%|     | 22928/50245 [00:09<00:11, 2396.60 examples/s]Map:  46%|     | 23248         | 4146/50245 [00:01<00:21, 2149.74 examples/s]Map:   9%|         | 4374/50245 [00:01<00:21, 2180.15 examples/s]Map:   9%|         | 4614/50245 [00:02<00:20, 2232.99 examples/s]Map:  10%|         | 4946/50245 [00:02<00:20, 2224.61 examples/s]Map:  10%|         | 5251/50245 [00:02<00:20, 2157.85 examples/s]Map:  11%|         | 5497/50245 [00:02<00:20, 2230.93 examples/s]Map:  11%|        | 5736/50245 [00:02<00:19, 2269.57 examples/s]Map:  12%|        | 5978/50245 [00:02<00:19, 2309.31 examples/s]Map:  13%|        | 6288/50245 [00:02<00:19, 2217.50 examples/s]Map:  13%|        | 6531/50245 [00:02<00:19, 2267.78 examples/s]Map:  13%|        | 6773/50245 [00:03<00:18, 2306.28 examples/s]Map:  14%|        | 7116/50245 [00:03<00:19, 2241.38 examples/s]Map:  15%|        | 7357/50245 [00:03<00:18, 2281.93 examples/s]Map:  15%|        | 7593/50245 [00:03<00:18, 2300.85 examples/s]Map:  16%|        | 7843/50245 [00:03<00:18, 2         | 4263/50245 [00:01<00:20, 2227.63 examples/s]Map:   9%|         | 4515/50245 [00:01<00:19, 2297.85 examples/s]Map:  10%|         | 4859/50245 [00:02<00:19, 2292.02 examples/s]Map:  10%|         | 5173/50245 [00:02<00:20, 2223.38 examples/s]Map:  11%|         | 5429/50245 [00:02<00:19, 2301.04 examples/s]Map:  11%|        | 5677/50245 [00:02<00:19, 2341.82 examples/s]Map:  12%|        | 5931/50245 [00:02<00:18, 2390.01 examples/s]Map:  12%|        | 6253/50245 [00:02<00:19, 2299.00 examples/s]Map:  13%|        | 6505/50245 [00:02<00:18, 2351.74 examples/s]Map:  13%|        | 6760/50245 [00:02<00:18, 2401.57 examples/s]Map:  14%|        | 7117/50245 [00:03<00:18, 2315.11 examples/s]Map:  15%|        | 7365/50245 [00:03<00:18, 2353.10 examples/s]Map:  15%|        | 7611/50245 [00:03<00:17, 2377.15 examples/s]Map:  16%|        | 7863/50245 [00:03<00:17, 2413.07 examples/s]Map:  16%|        | 8197/50245 [00:03<00:17,  | 37490/50245 [00:16<00:05, 2324.41 examples/s]Map:  75%|  | 37732/50245 [00:16<00:05, 2347.77 examples/s]Map:  76%|  | 37984/50245 [00:16<00:05, 2384.55 examples/s]Map:  76%|  | 38291/50245 [00:16<00:05, 2255.27 examples/s]Map:  77%|  | 38548/50245 [00:16<00:05, 2334.39 examples/s]Map:  77%|  | 38806/50245 [00:16<00:04, 2398.89 examples/s]Map:  78%|  | 39145/50245 [00:16<00:04, 2345.47 examples/s]Map:  78%|  | 39402/50245 [00:16<00:04, 2402.17 examples/s]Map:  79%|  | 39769/50245 [00:16<00:04, 2415.72 examples/s]Map:  80%|  | 40123/50245 [00:17<00:04, 2304.17 examples/s]Map:  80%|  | 40391/50245 [00:17<00:04, 2389.90 examples/s]Map:  81%|  | 40654/50245 [00:17<00:03, 2449.50 examples/s]Map:  82%|23.85 examples/s]Map:  32%|      | 15964/50245 [00:06<00:14, 2353.59 examples/s]Map:  32%|      | 16275/50245 [00:07<00:15, 2251.67 examples/s]Map:  33%|      | 16533/50245 [00:07<00:14, 2329.54 examples/s]Map:  33%|      | 16790/50245 [00:07<00:13, 2390.98 examples/s]Map:  34%|      | 17126/50245 [00:07<00:14, 2300.73 examples/s]Map:  35%|      | 17366/50245 [00:07<00:14, 2322.56 examples/s]Map:  35%|      | 17616/50245 [00:07<00:13, 2368.28 examples/s]Map:  36%|      | 17868/50245 [00:07<00:13, 2403.59 examples/s]Map:  36%|      | 18189/50245 [00:07<00:13, 2301.04 examples/s]Map:  37%|      | 18433/50245 [00:07<00:13, 2335.96 examples/s]Map:  37%|      | 18677/50245 [00:08<00:13, 2362.40 examples/s]Map:  38%|      | 18925/50245 [00:08<00:13, 2393.88 examples/s]Map:  38%|      | 19258/50245 [00:08<00:13, 2290.73 examples/s]Map:  39%|/50245 [00:09<00:11, 2283.80 examples/s]Map:  47%|     | 23512/50245 [00:10<00:11, 2373.27 examples/s]Map:  48%|     | 23873/50245 [00:10<00:11, 2379.87 examples/s]Map:  48%|     | 24121/50245 [00:10<00:11, 2278.05 examples/s]Map:  48%|     | 24361/50245 [00:10<00:11, 2307.21 examples/s]Map:  49%|     | 24729/50245 [00:10<00:10, 2354.44 examples/s]Map:  50%|     | 24988/50245 [00:10<00:10, 2410.53 examples/s]Map:  50%|     | 25315/50245 [00:10<00:10, 2324.96 examples/s]Map:  51%|     | 25585/50245 [00:10<00:10, 2416.51 examples/s]Map:  52%|    | 25937/50245 [00:11<00:10, 2389.26 examples/s]Map:  52%|    | 26248/50245 [00:11<00:10, 2282.84 examples/s]Map:  53%|    | 26493/50245 [00:11<00:10, 2320.39 examples/s]Map:  53%|    | 26750/50245 [00:11<00:09, 2377.60 examples/s]Map:  54%|    | 27000/s]Map:  24%|       | 11994/50245 [00:05<00:15, 2404.77 examples/s]Map:  25%|       | 12315/50245 [00:05<00:16, 2301.89 examples/s]Map:  25%|       | 12687/50245 [00:05<00:15, 2357.82 examples/s]Map:  26%|       | 12952/50245 [00:05<00:15, 2428.81 examples/s]Map:  26%|       | 13277/50245 [00:05<00:15, 2335.51 examples/s]Map:  27%|       | 13642/50245 [00:05<00:15, 2366.12 examples/s]Map:  28%|       | 14000/50245 [00:06<00:15, 2279.06 examples/s]Map:  28%|       | 14240/50245 [00:06<00:15, 2302.54 examples/s]Map:  29%|       | 14480/50245 [00:06<00:15, 2325.39 examples/s]Map:  29%|       | 14730/50245 [00:06<00:14, 2368.59 examples/s]Map:  30%|       | 14991/50245 [00:06<00:14, 2431.98 examples/s]Map:  30%|       | 15300/50245 [00:06<00:15, 2290.98 examples/s]Map:  31%|       | 15657/50245 [00:06<00:14, 2318.34 examples/s]Map:  32%|      | 15903/50245 [00:06<00:14, 23Map:   0%|          | 0/50245 [00:00<?, ? examples/s]Map:   0%|          | 235/50245 [00:00<00:21, 2326.71 examples/s]Map:   1%|          | 488/50245 [00:00<00:20, 2436.29 examples/s]Map:   1%|         | 740/50245 [00:00<00:20, 2471.20 examples/s]Map:   2%|         | 1039/50245 [00:00<00:22, 2234.06 examples/s]Map:   3%|         | 1377/50245 [00:00<00:21, 2241.02 examples/s]Map:   3%|         | 1723/50245 [00:00<00:21, 2259.59 examples/s]Map:   4%|         | 1964/50245 [00:00<00:21, 2296.28 examples/s]Map:   5%|         | 2272/50245 [00:01<00:21, 2206.51 examples/s]Map:   5%|         | 2505/50245 [00:01<00:21, 2234.06 examples/s]Map:   5%|         | 2739/50245 [00:01<00:21, 2261.18 examples/s]Map:   6%|         | 3029/50245 [00:01<00:22, 2139.05 examples/s]Map:   6%|         | 3256/50245 [00:01<00:21, 2171.25 examples/s]Map:   7%|         | 3502/50245 [00:01<00:20, 2246.87 examples/s]Map:   8%|         | 3838/50245 [00:01<00:20, 2242.58 examples/s]Map:   8%| | 41000/50245 [00:17<00:03, 2316.56 examples/s]Map:  82%| | 41243/50245 [00:17<00:03, 2338.29 examples/s]Map:  83%| | 41495/50245 [00:17<00:03, 2381.49 examples/s]Map:  83%| | 41744/50245 [00:17<00:03, 2409.62 examples/s]Map:  84%| | 42044/50245 [00:17<00:03, 2256.73 examples/s]Map:  84%| | 42301/50245 [00:18<00:03, 2334.85 examples/s]Map:  85%| | 42558/50245 [00:18<00:03, 2395.47 examples/s]Map:  85%| | 42806/50245 [00:18<00:03, 2415.65 examples/s]Map:  86%| | 43122/50245 [00:18<00:03, 2282.29 examples/s]Map:  86%| | 43391/50245 [00:18<00:02, 2385.43 examples/s]Map:  87%| | 43651/50245 [00:18<00:02, 2441.53 examples/s]Map:  88%| | 44000/50245 [00:18<00:02, 2337.86 examples/s]Map:  88%| 2339.65 examples/s]Map:  17%|        | 8439/50245 [00:03<00:17, 2357.96 examples/s]Map:  17%|        | 8691/50245 [00:03<00:17, 2395.91 examples/s]Map:  18%|        | 8945/50245 [00:03<00:16, 2434.17 examples/s]Map:  18%|        | 9275/50245 [00:03<00:17, 2343.45 examples/s]Map:  19%|        | 9536/50245 [00:04<00:16, 2413.07 examples/s]Map:  20%|        | 9900/50245 [00:04<00:16, 2413.40 examples/s]Map:  20%|        | 10249/50245 [00:04<00:17, 2304.94 examples/s]Map:  21%|        | 10486/50245 [00:04<00:17, 2317.64 examples/s]Map:  21%|       | 10743/50245 [00:04<00:16, 2378.86 examples/s]Map:  22%|       | 10996/50245 [00:04<00:16, 2413.98 examples/s]Map:  23%|       | 11315/50245 [00:04<00:16, 2306.56 examples/s]Map:  23%|       | 11562/50245 [00:04<00:16, 2345.61 examples/s]Map:  24%|       | 11821/50245 [00:05<00:15, 2409.77 examples/s]Map:  24%|       | 12150/50245 [00:05<00:16, 2326.45 e351.56 examples/s]Map:  16%|        | 8163/50245 [00:03<00:18, 2268.80 examples/s]Map:  17%|        | 8396/50245 [00:03<00:18, 2277.93 examples/s]Map:  17%|        | 8639/50245 [00:03<00:17, 2316.10 examples/s]Map:  18%|        | 8886/50245 [00:03<00:17, 2357.34 examples/s]Map:  18%|        | 9242/50245 [00:04<00:18, 2265.73 examples/s]Map:  19%|        | 9500/50245 [00:04<00:17, 2344.63 examples/s]Map:  20%|        | 9849/50245 [00:04<00:17, 2332.70 examples/s]Map:  20%|        | 10155/50245 [00:04<00:17, 2231.87 examples/s]Map:  21%|        | 10498/50245 [00:04<00:17, 2245.82 examples/s]Map:  21%|       | 10747/50245 [00:04<00:17, 2300.24 examples/s]Map:  22%|       | 10990/50245 [00:04<00:16, 2329.78 examples/s]Map:  22%|       | 11293/50245 [00:04<00:17, 2218.05 examples/s]Map:  23%|       | 11534/50245 [00:05<00:17, 2261.92 examples/s]Map:  23%|       | 11784/50245 [00:05<00:16, 2322.42 exampl      | 19505/50245 [00:08<00:13, 2334.57 examples/s]Map:  39%|      | 19746/50245 [00:08<00:12, 2351.01 examples/s]Map:  40%|      | 20000/50245 [00:08<00:13, 2277.80 examples/s]Map:  40%|      | 20244/50245 [00:08<00:12, 2319.41 examples/s]Map:  41%|      | 20496/50245 [00:08<00:12, 2373.71 examples/s]Map:  41%|     | 20742/50245 [00:08<00:12, 2394.99 examples/s]Map:  42%|     | 21050/50245 [00:09<00:12, 2261.54 examples/s]Map:  42%|     | 21297/50245 [00:09<00:12, 2315.93 examples/s]Map:  43%|     | 21542/50245 [00:09<00:12, 2350.11 examples/s]Map:  43%|     | 21792/50245 [00:09<00:11, 2390.57 examples/s]Map:  44%|     | 22127/50245 [00:09<00:12, 2264.83 examples/s]Map:  45%|     | 22366/50245 [00:09<00:12, 2293.37 examples/s]Map:  45%|     | 22611/50245 [00:09<00:11, 2334.16 examples/s]Map:  45%|     | 22861//50245 [00:11<00:10, 2276.22 examples/s]Map:  54%|    | 27253/50245 [00:11<00:09, 2341.29 examples/s]Map:  55%|    | 27513/50245 [00:11<00:09, 2409.54 examples/s]Map:  55%|    | 27885/50245 [00:11<00:09, 2430.58 examples/s]Map:  56%|    | 28235/50245 [00:12<00:09, 2291.96 examples/s]Map:  57%|    | 28494/50245 [00:12<00:09, 2360.50 examples/s]Map:  57%|    | 28736/50245 [00:12<00:09, 2373.41 examples/s]Map:  58%|    | 28986/50245 [00:12<00:08, 2403.51 examples/s]Map:  58%|    | 29309/50245 [00:12<00:09, 2310.03 examples/s]Map:  59%|    | 29544/50245 [00:12<00:08, 2319.93 examples/s]Map:  59%|    | 29789/50245 [00:12<00:08, 2351.64 examples/s]Map:  60%|    | 30122/50245 [00:12<00:08, 2248.44 examples/s]Map:  60%|    | 30374/50245 [00:13<00:08, 2315.10 examples/s]Map:  61%| | 44239/50245 [00:18<00:02, 2348.35 examples/s]Map:  89%| | 44480/50245 [00:18<00:02, 2361.79 examples/s]Map:  89%| | 44738/50245 [00:19<00:02, 2418.59 examples/s]Map:  90%| | 44996/50245 [00:19<00:02, 2461.97 examples/s]Map:  90%| | 45305/50245 [00:19<00:02, 2307.02 examples/s]Map:  91%| | 45551/50245 [00:19<00:02, 2341.30 examples/s]Map:  91%| | 45803/50245 [00:19<00:01, 2385.92 examples/s]Map:  92%|| 46124/50245 [00:19<00:01, 2291.90 examples/s]Map:  92%|| 46368/50245 [00:19<00:01, 2328.58 examples/s]Map:  93%|| 46633/50245 [00:19<00:01, 2411.27 examples/s]Map:  93%|| 46885/50245 [00:19<00:01, 2440.82 examples/s]Map:  94%|| 47248/50245 [00:20<00:01, 2322.89 examples/s]M51.03 examples/s]Map:  32%|      | 16244/50245 [00:07<00:15, 2247.44 examples/s]Map:  33%|      | 16506/50245 [00:07<00:14, 2334.30 examples/s]Map:  33%|      | 16767/50245 [00:07<00:13, 2402.12 examples/s]Map:  34%|      | 17125/50245 [00:07<00:14, 2308.95 examples/s]Map:  35%|      | 17367/50245 [00:07<00:14, 2332.57 examples/s]Map:  35%|      | 17620/50245 [00:07<00:13, 2381.46 examples/s]Map:  36%|      | 17873/50245 [00:07<00:13, 2417.81 examples/s]Map:  36%|      | 18191/50245 [00:07<00:13, 2305.94 examples/s]Map:  37%|      | 18432/50245 [00:07<00:13, 2331.77 examples/s]Map:  37%|      | 18679/50245 [00:08<00:13, 2366.39 examples/s]Map:  38%|      | 18927/50245 [00:08<00:13, 2396.73 examples/s]Map:  38%|      | 19257/50245 [00:08<00:13, 2290.76 examples/s]Map:  39%|      | 19505/50245 [00:08<00:13, 2337.78 examples/s]Map:  39%|         | 4130/50245 [00:01<00:21, 2137.64 examples/s]Map:   9%|         | 4356/50245 [00:01<00:21, 2165.78 examples/s]Map:   9%|         | 4595/50245 [00:02<00:20, 2222.46 examples/s]Map:  10%|         | 4927/50245 [00:02<00:20, 2216.44 examples/s]Map:  10%|         | 5246/50245 [00:02<00:20, 2155.55 examples/s]Map:  11%|         | 5492/50245 [00:02<00:20, 2225.90 examples/s]Map:  11%|        | 5730/50245 [00:02<00:19, 2262.40 examples/s]Map:  12%|        | 5971/50245 [00:02<00:19, 2299.72 examples/s]Map:  12%|        | 6275/50245 [00:02<00:20, 2198.00 examples/s]Map:  13%|        | 6517/50245 [00:02<00:19, 2252.10 examples/s]Map:  13%|        | 6760/50245 [00:03<00:18, 2295.40 examples/s]Map:  14%|        | 7000/50245 [00:03<00:19, 2208.67 examples/s]Map:  14%|        | 7245/50245 [00:03<00:18, 2271.06 examples/s]Map:  15%|        | 7482/50245 [00:03<00:18, 2292.48 examples/s]Map:  15%|        | 7715/50245 [00:03<00:18, 2xamples/s]Map:  25%|       | 12392/50245 [00:05<00:16, 2348.54 examples/s]Map:  25%|       | 12645/50245 [00:05<00:15, 2392.56 examples/s]Map:  26%|       | 12917/50245 [00:05<00:15, 2481.06 examples/s]Map:  26%|       | 13262/50245 [00:05<00:15, 2382.03 examples/s]Map:  27%|       | 13505/50245 [00:05<00:15, 2390.31 examples/s]Map:  27%|       | 13750/50245 [00:05<00:15, 2403.80 examples/s]Map:  28%|       | 14000/50245 [00:05<00:15, 2294.83 examples/s]Map:  28%|       | 14243/50245 [00:06<00:15, 2326.20 examples/s]Map:  29%|       | 14485/50245 [00:06<00:15, 2348.68 examples/s]Map:  29%|       | 14739/50245 [00:06<00:14, 2400.63 examples/s]Map:  30%|       | 15000/50245 [00:06<00:15, 2323.24 examples/s]Map:  30%|       | 15246/50245 [00:06<00:14, 2356.73 examples/s]Map:  31%|       | 15599/50245 [00:06<00:14, 2350.61 examples/s]Map:  32%|      | 15852/50245 [00:06<00es/s]Map:  24%|       | 12129/50245 [00:05<00:16, 2244.28 examples/s]Map:  25%|       | 12362/50245 [00:05<00:16, 2262.66 examples/s]Map:  25%|       | 12599/50245 [00:05<00:16, 2289.55 examples/s]Map:  26%|       | 12865/50245 [00:05<00:15, 2387.49 examples/s]Map:  26%|       | 13180/50245 [00:05<00:16, 2278.41 examples/s]Map:  27%|       | 13432/50245 [00:05<00:15, 2335.95 examples/s]Map:  27%|       | 13777/50245 [00:06<00:15, 2319.93 examples/s]Map:  28%|       | 14119/50245 [00:06<00:16, 2235.85 examples/s]Map:  29%|       | 14350/50245 [00:06<00:15, 2250.72 examples/s]Map:  29%|       | 14584/50245 [00:06<00:15, 2269.55 examples/s]Map:  30%|       | 14829/50245 [00:06<00:15, 2315.69 examples/s]Map:  30%|       | 15151/50245 [00:06<00:15, 2251.37 examples/s]Map:  31%|       | 15384/50245 [00:06<00:15, 2269.82 examples/s]Map:  31%|      | 15735/50245 [00:06<00:15, 50245 [00:09<00:11, 2378.12 examples/s]Map:  46%|     | 23168/50245 [00:09<00:12, 2248.91 examples/s]Map:  47%|     | 23424/50245 [00:10<00:11, 2328.48 examples/s]Map:  47%|     | 23664/50245 [00:10<00:11, 2346.46 examples/s]Map:  48%|     | 23906/50245 [00:10<00:11, 2360.44 examples/s]Map:  48%|     | 24214/50245 [00:10<00:11, 2186.81 examples/s]Map:  49%|     | 24460/50245 [00:10<00:11, 2255.72 examples/s]Map:  49%|     | 24704/50245 [00:10<00:11, 2300.80 examples/s]Map:  50%|     | 24963/50245 [00:10<00:10, 2378.69 examples/s]Map:  50%|     | 25285/50245 [00:10<00:10, 2288.66 examples/s]Map:  51%|     | 25551/50245 [00:10<00:10, 2381.86 examples/s]Map:  52%|    | 25907/50245 [00:11<00:10, 2372.00 examples/s]Map:  52%|    | 26238/50245 [00:11<00:10, 2253.32 examples/s]Map:  53%|    | 26479/5024    | 30630/50245 [00:13<00:08, 2377.60 examples/s]Map:  61%|   | 30875/50245 [00:13<00:08, 2393.54 examples/s]Map:  62%|   | 31126/50245 [00:13<00:08, 2286.93 examples/s]Map:  62%|   | 31376/50245 [00:13<00:08, 2340.94 examples/s]Map:  63%|   | 31630/50245 [00:13<00:07, 2393.93 examples/s]Map:  63%|   | 31876/50245 [00:13<00:07, 2409.56 examples/s]Map:  64%|   | 32119/50245 [00:13<00:07, 2271.70 examples/s]Map:  64%|   | 32351/50245 [00:13<00:07, 2281.39 examples/s]Map:  65%|   | 32613/50245 [00:13<00:07, 2249.59 examples/s]Map:  65%|   | 32855/50245 [00:14<00:07, 2296.44 examples/s]Map:  66%|   | 33180/50245 [00:14<00:07, 2243.45 examples/s]Map:  67%|   | 33431/50245 [00:14<00:07, 2311.93 examples/s]Map:  67%|   | 33673/50245 [00:14<00:07, 233ap:  95%|| 47600/50245 [00:20<00:01, 2328.26 examples/s]Map:  95%|| 47930/50245 [00:20<00:01, 1840.58 examples/s]Map:  96%|| 48258/50245 [00:20<00:01, 1928.33 examples/s]Map:  97%|| 48520/50245 [00:20<00:00, 2068.92 examples/s]Map:  97%|| 48767/50245 [00:20<00:00, 2157.51 examples/s]Map:  98%|| 49000/50245 [00:21<00:00, 2113.86 examples/s]Map:  98%|| 49240/50245 [00:21<00:00, 2180.53 examples/s]Map:  98%|| 49478/50245 [00:21<00:00, 2230.19 examples/s]Map:  99%|| 49727/50245 [00:21<00:00, 2300.45 examples/s]Map:  99%|| 49967/50245 [00:21<00:00, 2325.02 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2171.61 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2327.58 examples/s]
      | 19747/50245 [00:08<00:12, 2357.87 examples/s]Map:  40%|      | 20000/50245 [00:08<00:13, 2278.91 examples/s]Map:  40%|      | 20244/50245 [00:08<00:12, 2321.28 examples/s]Map:  41%|      | 20499/50245 [00:08<00:12, 2382.32 examples/s]Map:  41%|     | 20747/50245 [00:08<00:12, 2406.37 examples/s]Map:  42%|     | 21049/50245 [00:09<00:12, 2254.06 examples/s]Map:  42%|     | 21297/50245 [00:09<00:12, 2310.87 examples/s]Map:  43%|     | 21545/50245 [00:09<00:12, 2354.38 examples/s]Map:  43%|     | 21795/50245 [00:09<00:11, 2391.97 examples/s]Map:  44%|     | 22126/50245 [00:09<00:12, 2259.74 examples/s]Map:  45%|     | 22367/50245 [00:09<00:12, 2294.20 examples/s]Map:  45%|     | 22614/50245 [00:09<00:11, 2337.98 examples/s]Map:  46%|     | 22866/50245 [00:09<00:11, 2387.29 examples/s]Map:  46%|     | 2317300.02 examples/s]Map:  16%|        | 7958/50245 [00:03<00:18, 2335.94 examples/s]Map:  16%|        | 8270/50245 [00:03<00:18, 2236.20 examples/s]Map:  17%|        | 8507/50245 [00:03<00:18, 2268.48 examples/s]Map:  17%|        | 8748/50245 [00:03<00:17, 2306.58 examples/s]Map:  18%|        | 8995/50245 [00:03<00:17, 2350.99 examples/s]Map:  19%|        | 9308/50245 [00:04<00:18, 2248.28 examples/s]Map:  19%|        | 9556/50245 [00:04<00:17, 2305.41 examples/s]Map:  19%|        | 9792/50245 [00:04<00:17, 2316.52 examples/s]Map:  20%|        | 10124/50245 [00:04<00:18, 2199.29 examples/s]Map:  21%|        | 10355/50245 [00:04<00:17, 2225.26 examples/s]Map:  21%|        | 10589/50245 [00:04<00:17, 2252.32 examples/s]Map:  22%|       | 10842/50245 [00:04<00:16, 2326.43 examples/s]Map:  22%|       | 11145/50245 [00:04<00:17, 2211.53 examples/s]Map:  23%|       | 11380/50245 [00:05<00:17, 2245.43 examples/s]:14, 2396.03 examples/s]Map:  32%|      | 16171/50245 [00:06<00:14, 2296.10 examples/s]Map:  33%|      | 16414/50245 [00:06<00:14, 2326.94 examples/s]Map:  33%|      | 16679/50245 [00:07<00:13, 2411.00 examples/s]Map:  34%|      | 16929/50245 [00:07<00:13, 2433.05 examples/s]Map:  34%|      | 17251/50245 [00:07<00:14, 2315.99 examples/s]Map:  35%|      | 17489/50245 [00:07<00:14, 2329.48 examples/s]Map:  35%|      | 17747/50245 [00:07<00:13, 2393.90 examples/s]Map:  36%|      | 17992/50245 [00:07<00:13, 2405.76 examples/s]Map:  36%|      | 18311/50245 [00:07<00:13, 2296.57 examples/s]Map:  37%|      | 18563/50245 [00:07<00:13, 2351.73 examples/s]Map:  37%|      | 18810/50245 [00:07<00:13, 2381.78 examples/s]Map:  38%|      | 19138/50245 [00:08<00:13, 2300.55 examples/s]Map:  39%|      | 19387/50245 [00:08<00:13, 2345.25 examples/s]Map:  39%|2290.08 examples/s]Map:  32%|      | 15979/50245 [00:07<00:14, 2325.93 examples/s]Map:  32%|      | 16279/50245 [00:07<00:15, 2210.61 examples/s]Map:  33%|      | 16530/50245 [00:07<00:14, 2283.27 examples/s]Map:  33%|      | 16779/50245 [00:07<00:14, 2335.07 examples/s]Map:  34%|      | 17122/50245 [00:07<00:14, 2242.65 examples/s]Map:  35%|      | 17358/50245 [00:07<00:14, 2268.37 examples/s]Map:  35%|      | 17602/50245 [00:07<00:14, 2311.37 examples/s]Map:  36%|      | 17850/50245 [00:07<00:13, 2355.79 examples/s]Map:  36%|      | 18157/50245 [00:08<00:14, 2238.51 examples/s]Map:  37%|      | 18392/50245 [00:08<00:14, 2262.95 examples/s]Map:  37%|      | 18636/50245 [00:08<00:13, 2309.15 examples/s]Map:  38%|      | 18875/50245 [00:08<00:13, 2329.86 examples/s]Map:  38%|      | 19191/50245 [00:08<00:13, 2242.58 examples/s]Map:  39%|5 [00:11<00:10, 2288.90 examples/s]Map:  53%|    | 26730/50245 [00:11<00:10, 2344.02 examples/s]Map:  54%|    | 26977/50245 [00:11<00:09, 2375.37 examples/s]Map:  54%|    | 27293/50245 [00:11<00:10, 2273.65 examples/s]Map:  55%|    | 27551/50245 [00:11<00:09, 2350.61 examples/s]Map:  55%|    | 27791/50245 [00:11<00:09, 2361.84 examples/s]Map:  56%|    | 28108/50245 [00:12<00:09, 2231.69 examples/s]Map:  56%|    | 28359/50245 [00:12<00:09, 2301.30 examples/s]Map:  57%|    | 28604/50245 [00:12<00:09, 2337.97 examples/s]Map:  57%|    | 28842/50245 [00:12<00:09, 2345.94 examples/s]Map:  58%|    | 29166/50245 [00:12<00:09, 2273.11 examples/s]Map:  59%|    | 29413/50245 [00:12<00:08, 2321.90 examples/s]Map:  59%|    | 29768/50245 [00:12<00:08, 2330.19 examples/s]Map:  60%|8.33 examples/s]Map:  68%|   | 33924/50245 [00:14<00:06, 2382.82 examples/s]Map:  68%|   | 34260/50245 [00:14<00:06, 2287.13 examples/s]Map:  69%|   | 34517/50245 [00:14<00:06, 2359.98 examples/s]Map:  69%|   | 34766/50245 [00:14<00:06, 2392.73 examples/s]Map:  70%|   | 35123/50245 [00:15<00:06, 2333.99 examples/s]Map:  70%|   | 35369/50245 [00:15<00:06, 2361.23 examples/s]Map:  71%|   | 35618/50245 [00:15<00:06, 2393.28 examples/s]Map:  72%|  | 35984/50245 [00:15<00:05, 2404.45 examples/s]Map:  72%|  | 36306/50245 [00:15<00:06, 2313.69 examples/s]Map:  73%|  | 36561/50245 [00:15<00:05, 2369.32 examples/s]Map:  73%|  | 36806/50245 [00:15<00:05, 2385.81 examples/s]Map:  74%|  | 37117/50245 [00:15<00:05, 2246.39 examples/s]Map:  75%|Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]Filter:   2%|         | 1000/50245 [00:00<00:05, 9129.78 examples/s]Filter:   6%|         | 3000/50245 [00:00<00:04, 10100.20 examples/s]Filter:  10%|         | 5000/50245 [00:00<00:04, 10333.24 examples/s]Filter:  14%|        | 7000/50245 [00:00<00:04, 10532.94 examples/s]Filter:  18%|        | 9000/50245 [00:00<00:03, 10597.08 examples/s]Filter:  22%|       | 11000/50245 [00:01<00:03, 10623.79 examples/s]Filter:  26%|       | 13000/50245 [00:01<00:03, 10705.08 examples/s]Filter:  30%|       | 15000/50245 [00:01<00:03, 10734.66 examples/s]Filter:  34%|      | 17000/50245 [00:01<00:03, 10737.96 examples/s]Filter:  38%|      | 19000/50245 [00:01<00:02, 10738.53 examples/s]Filter:  42%|     | 21000/50245 [00:01<00:02, 10753.27 examples/s]Filter:  46%|     | 23000/50245 [00:02<00:02, 10714.14 examples/s]Filter:  50%|     | 250002/50245 [00:09<00:12, 2255.82 examples/s]Map:  47%|     | 23435/50245 [00:10<00:11, 2350.14 examples/s]Map:  47%|     | 23681/50245 [00:10<00:11, 2375.28 examples/s]Map:  48%|     | 23923/50245 [00:10<00:11, 2387.53 examples/s]Map:  48%|     | 24229/50245 [00:10<00:11, 2227.56 examples/s]Map:  49%|     | 24475/50245 [00:10<00:11, 2285.75 examples/s]Map:  49%|     | 24723/50245 [00:10<00:10, 2336.68 examples/s]Map:  50%|     | 24986/50245 [00:10<00:10, 2417.27 examples/s]Map:  50%|     | 25307/50245 [00:10<00:10, 2309.54 examples/s]Map:  51%|     | 25577/50245 [00:10<00:10, 2409.94 examples/s]Map:  52%|    | 25929/50245 [00:11<00:10, 2382.90 examples/s]Map:  52%|    | 26242/50245 [00:11<00:10, 2269.97 examples/s]Map:  53%|    | 26486/50245 [00:11<00:10, 2308.37 examples/s]Map:  53%|    | 26742/      | 19635/50245 [00:08<00:12, 2379.29 examples/s]Map:  40%|      | 19885/50245 [00:08<00:12, 2411.19 examples/s]Map:  40%|      | 20245/50245 [00:08<00:12, 2308.07 examples/s]Map:  41%|      | 20502/50245 [00:08<00:12, 2370.32 examples/s]Map:  41%|     | 20753/50245 [00:08<00:12, 2401.37 examples/s]Map:  42%|     | 21064/50245 [00:08<00:12, 2277.41 examples/s]Map:  42%|     | 21313/50245 [00:09<00:12, 2329.64 examples/s]Map:  43%|     | 21562/50245 [00:09<00:12, 2370.04 examples/s]Map:  43%|     | 21813/50245 [00:09<00:11, 2402.35 examples/s]Map:  44%|     | 22125/50245 [00:09<00:12, 2271.82 examples/s]Map:  45%|     | 22366/50245 [00:09<00:12, 2306.76 examples/s]Map:  45%|     | 22614/50245 [00:09<00:11, 2351.64 examples/s]Map:  46%|     | 22870/50245 [00:09<00:11, 2404.98 examples/s]Map:  46%|    Map:  23%|       | 11614/50245 [00:05<00:17, 2268.58 examples/s]Map:  24%|       | 11864/50245 [00:05<00:16, 2330.05 examples/s]Map:  24%|       | 12175/50245 [00:05<00:17, 2230.25 examples/s]Map:  25%|       | 12409/50245 [00:05<00:16, 2256.79 examples/s]Map:  25%|       | 12653/50245 [00:05<00:16, 2303.45 examples/s]Map:  26%|       | 12913/50245 [00:05<00:15, 2383.48 examples/s]Map:  26%|       | 13251/50245 [00:05<00:16, 2275.55 examples/s]Map:  27%|       | 13491/50245 [00:05<00:15, 2302.00 examples/s]Map:  28%|       | 13839/50245 [00:06<00:15, 2306.64 examples/s]Map:  28%|       | 14140/50245 [00:06<00:16, 2202.85 examples/s]Map:  29%|       | 14374/50245 [00:06<00:16, 2232.07 examples/s]Map:  29%|       | 14609/50245 [00:06<00:15, 2261.21 examples/s]Map:  30%|       | 14852/50245 [00:06<00:15, 2299.95 examples/s]Map:  30%|       | 15170/50245 [00:06<00:15, 2230.66      | 19428/50245 [00:08<00:13, 2274.32 examples/s]Map:  39%|      | 19670/50245 [00:08<00:13, 2309.86 examples/s]Map:  40%|      | 19915/50245 [00:08<00:12, 2344.48 examples/s]Map:  40%|      | 20237/50245 [00:08<00:13, 2231.94 examples/s]Map:  41%|      | 20482/50245 [00:09<00:13, 2284.78 examples/s]Map:  41%|      | 20726/50245 [00:09<00:12, 2325.12 examples/s]Map:  42%|     | 21025/50245 [00:09<00:13, 2199.12 examples/s]Map:  42%|     | 21264/50245 [00:09<00:12, 2239.41 examples/s]Map:  43%|     | 21510/50245 [00:09<00:12, 2295.16 examples/s]Map:  43%|     | 21757/50245 [00:09<00:12, 2339.14 examples/s]Map:  44%|     | 22058/50245 [00:09<00:12, 2210.18 examples/s]Map:  44%|     | 22289/50245 [00:09<00:12, 2235.51 examples/s]Map:  45%|     | 22528/50245 [00:09<00:12, 2275.71 examples/s]Map:  45%|     | 22767/Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]Filter:   4%|         | 2000/50245 [00:00<00:04, 10279.16 examples/s]Filter:   8%|         | 4000/50245 [00:00<00:04, 10319.62 examples/s]Filter:  12%|        | 6000/50245 [00:00<00:04, 10399.97 examples/s]Filter:  16%|        | 8000/50245 [00:00<00:04, 10480.05 examples/s]Filter:  20%|        | 10000/50245 [00:00<00:03, 10502.15 examples/s]Filter:  24%|       | 12000/50245 [00:01<00:03, 10517.22 examples/s]Filter:  28%|       | 14000/50245 [00:01<00:03, 10602.89 examples/s]Filter:  32%|      | 16000/50245 [00:01<00:03, 10539.25 examples/s]Filter:  36%|      | 18000/50245 [00:01<00:03, 10554.29 examples/s]Filter:  40%|      | 20000/50245 [00:01<00:02, 10627.55 examples/s]Filter:  44%|     | 22000/50245 [00:02<00:02, 10584.70 examples/s]Filter:  48%|     | 24000/50245 [00:02<00:02, 10542.32 examples/s]Filter:  52%|       | 30120/50245 [00:12<00:09, 2229.85 examples/s]Map:  60%|    | 30368/50245 [00:13<00:08, 2286.10 examples/s]Map:  61%|    | 30619/50245 [00:13<00:08, 2338.92 examples/s]Map:  61%|   | 30862/50245 [00:13<00:08, 2356.48 examples/s]Map:  62%|   | 31183/50245 [00:13<00:08, 2270.40 examples/s]Map:  63%|   | 31428/50245 [00:13<00:08, 2312.82 examples/s]Map:  63%|   | 31680/50245 [00:13<00:07, 2363.06 examples/s]Map:  64%|   | 32000/50245 [00:13<00:08, 2256.92 examples/s]Map:  64%|   | 32237/50245 [00:13<00:07, 2284.87 examples/s]Map:  65%|   | 32485/50245 [00:14<00:07, 2333.89 examples/s]Map:  65%|   | 32740/50245 [00:14<00:07, 2391.99 examples/s]Map:  66%|   | 32991/50245 [00:14<00:07, 2423.46 examples/s]Map:  66%|   | 33321/50245 [00:14<00:07, 2334.18 exam  | 37474/50245 [00:16<00:05, 2288.24 examples/s]Map:  75%|  | 37715/50245 [00:16<00:05, 2316.16 examples/s]Map:  76%|  | 37963/50245 [00:16<00:05, 2352.10 examples/s]Map:  76%|  | 38270/50245 [00:16<00:05, 2239.11 examples/s]Map:  77%|  | 38521/50245 [00:16<00:05, 2305.12 examples/s]Map:  77%|  | 38780/50245 [00:16<00:04, 2379.45 examples/s]Map:  78%|  | 39126/50245 [00:16<00:04, 2325.05 examples/s]Map:  78%|  | 39373/50245 [00:16<00:04, 2358.97 examples/s]Map:  79%|  | 39738/50245 [00:17<00:04, 2381.03 examples/s]Map:  80%|  | 39981/50245 [00:17<00:04, 2391.81 examples/s]Map:  80%|  | 40301/50245 [00:17<00:04, 2299.96 examples/s]Map:  81%|  | 40560/50245 [00:17<00:04, 2370.90 examples/s]Map:  81%|50245 [00:11<00:09, 2371.01 examples/s]Map:  54%|    | 26989/50245 [00:11<00:09, 2393.11 examples/s]Map:  54%|    | 27309/50245 [00:11<00:09, 2294.99 examples/s]Map:  55%|    | 27572/50245 [00:11<00:09, 2377.91 examples/s]Map:  56%|    | 27945/50245 [00:11<00:09, 2414.03 examples/s]Map:  56%|    | 28239/50245 [00:12<00:09, 2257.31 examples/s]Map:  57%|    | 28498/50245 [00:12<00:09, 2337.13 examples/s]Map:  57%|    | 28740/50245 [00:12<00:09, 2355.02 examples/s]Map:  58%|    | 28988/50245 [00:12<00:08, 2386.02 examples/s]Map:  58%|    | 29306/50245 [00:12<00:09, 2285.95 examples/s]Map:  59%|    | 29541/50245 [00:12<00:09, 2298.58 examples/s]Map:  59%|    | 29785/50245 [00:12<00:08, 2332.38 examples/s]Map:  60%|    | 30120/50245 [00:12<00:09, 2224.14 examples/s]Map:  60%| | 23180/50245 [00:09<00:11, 2272.00 examples/s]Map:  47%|     | 23445/50245 [00:09<00:11, 2367.02 examples/s]Map:  47%|     | 23689/50245 [00:10<00:11, 2385.56 examples/s]Map:  48%|     | 23935/50245 [00:10<00:10, 2401.26 examples/s]Map:  48%|     | 24235/50245 [00:10<00:11, 2242.61 examples/s]Map:  49%|     | 24479/50245 [00:10<00:11, 2292.43 examples/s]Map:  49%|     | 24732/50245 [00:10<00:10, 2352.20 examples/s]Map:  50%|     | 24997/50245 [00:10<00:10, 2430.89 examples/s]Map:  50%|     | 25322/50245 [00:10<00:10, 2327.69 examples/s]Map:  51%|     | 25592/50245 [00:10<00:10, 2424.17 examples/s]Map:  52%|    | 25946/50245 [00:11<00:10, 2397.92 examples/s]Map:  52%|    | 26260/50245 [00:11<00:10, 2291.55 examples/s]Map:  53%|    | 26506/50245 [00:11<00:10, 2331.21 examples/s]Map:  53%|    |50245 [00:10<00:11, 2305.49 examples/s]Map:  46%|     | 23000/50245 [00:10<00:12, 2195.51 examples/s]Map:  46%|     | 23229/50245 [00:10<00:12, 2220.03 examples/s]Map:  47%|     | 23487/50245 [00:10<00:11, 2318.90 examples/s]Map:  47%|     | 23724/50245 [00:10<00:11, 2330.97 examples/s]Map:  48%|     | 23964/50245 [00:10<00:11, 2349.62 examples/s]Map:  48%|     | 24251/50245 [00:10<00:11, 2178.22 examples/s]Map:  49%|     | 24484/50245 [00:10<00:11, 2214.58 examples/s]Map:  49%|     | 24730/50245 [00:10<00:11, 2279.48 examples/s]Map:  50%|     | 24986/50245 [00:10<00:10, 2355.87 examples/s]Map:  50%|     | 25297/50245 [00:11<00:11, 2245.88 examples/s]Map:  51%|     | 25557/50245 [00:11<00:10, 2337.25 examples/s]Map:  52%|    | 25904/50245 [00:11<00:10, 2327.64 examples/s]Map:  52%|    | 26233/50245  examples/s]Map:  31%|       | 15405/50245 [00:06<00:15, 2258.53 examples/s]Map:  31%|      | 15751/50245 [00:06<00:15, 2274.73 examples/s]Map:  32%|      | 15993/50245 [00:07<00:14, 2308.93 examples/s]Map:  32%|      | 16290/50245 [00:07<00:15, 2190.89 examples/s]Map:  33%|      | 16542/50245 [00:07<00:14, 2270.42 examples/s]Map:  33%|      | 16793/50245 [00:07<00:14, 2331.65 examples/s]Map:  34%|      | 17122/50245 [00:07<00:14, 2236.63 examples/s]Map:  35%|      | 17358/50245 [00:07<00:14, 2266.79 examples/s]Map:  35%|      | 17600/50245 [00:07<00:14, 2305.40 examples/s]Map:  36%|      | 17847/50245 [00:07<00:13, 2348.84 examples/s]Map:  36%|      | 18152/50245 [00:08<00:14, 2228.64 examples/s]Map:  37%|      | 18386/50245 [00:08<00:14, 2255.03 examples/s]Map:  37%|      | 18630/50245 [00:08<00:13, 2299.80 examples/s]Map:  38%|   /50245 [00:02<00:02, 10687.17 examples/s]Filter:  54%|    | 27000/50245 [00:02<00:02, 10707.70 examples/s]Filter:  58%|    | 29000/50245 [00:02<00:01, 10707.95 examples/s]Filter:  62%|   | 31000/50245 [00:02<00:01, 10709.49 examples/s]Filter:  66%|   | 33000/50245 [00:03<00:01, 10730.37 examples/s]Filter:  70%|   | 35000/50245 [00:03<00:01, 10797.23 examples/s]Filter:  74%|  | 37000/50245 [00:03<00:01, 10786.05 examples/s]Filter:  78%|  | 39000/50245 [00:03<00:01, 10756.05 examples/s]Filter:  82%| | 41000/50245 [00:03<00:00, 10766.19 examples/s]Filter:  86%| | 43000/50245 [00:04<00:00, 10720.70 examples/s]Filter:  90%| | 45000/50245 [00:04<00:00, 10765.27 examples/s]Filter:  94%|| 47000/50245 [00:04<00:00, 10745.54 examples/s]Filter:  98%|| 49000/50245 [00:04<00:00, 10754.91 examples/s]Filter: 100%|| 50245/50245 [00:04<00:00, 10695.84 examples/s]Filter: 100%|| 50245/50245 [00:04<00:00, 10677.54 examples/s]
ples/s]Map:  67%|   | 33563/50245 [00:14<00:07, 2352.27 examples/s]Map:  67%|   | 33803/50245 [00:14<00:06, 2363.63 examples/s]Map:  68%|   | 34130/50245 [00:14<00:07, 2284.77 examples/s]Map:  68%|   | 34386/50245 [00:14<00:06, 2353.11 examples/s]Map:  69%|   | 34636/50245 [00:14<00:06, 2390.09 examples/s]Map:  69%|   | 34896/50245 [00:15<00:06, 2446.62 examples/s]Map:  70%|   | 35244/50245 [00:15<00:06, 2333.17 examples/s]Map:  71%|   | 35484/50245 [00:15<00:06, 2349.36 examples/s]Map:  71%|   | 35724/50245 [00:15<00:06, 2359.09 examples/s]Map:  72%|  | 35975/50245 [00:15<00:05, 2395.56 examples/s]Map:  72%|  | 36294/50245 [00:15<00:06, 2292.10 examples/s]Map:  73%|  | 36546/50245 [00:15<00:05, 2351.40 examples/s]Map:  73%|  | 40816/50245 [00:17<00:03, 2417.44 examples/s]Map:  82%| | 41130/50245 [00:17<00:03, 2297.70 examples/s]Map:  83%| | 41487/50245 [00:17<00:03, 2322.82 examples/s]Map:  83%| | 41732/50245 [00:17<00:03, 2351.04 examples/s]Map:  84%| | 42026/50245 [00:18<00:03, 2212.77 examples/s]Map:  84%| | 42281/50245 [00:18<00:03, 2295.47 examples/s]Map:  85%| | 42532/50245 [00:18<00:03, 2349.29 examples/s]Map:  85%| | 42779/50245 [00:18<00:03, 2379.04 examples/s]Map:  86%| | 43122/50245 [00:18<00:03, 2262.27 examples/s]Map:  86%| | 43389/50245 [00:18<00:02, 2361.62 examples/s]Map:  87%| | 43646/50245 [00:18<00:02, 2416.28 examples/s]Map:  88%| | 44000/50245 [00:18<00:02, 2316.48 examples/s]Map:  88%|    | 30371/50245 [00:13<00:08, 2294.79 examples/s]Map:  61%|    | 30623/50245 [00:13<00:08, 2353.08 examples/s]Map:  61%|   | 30864/50245 [00:13<00:08, 2367.60 examples/s]Map:  62%|   | 31181/50245 [00:13<00:08, 2267.82 examples/s]Map:  63%|   | 31429/50245 [00:13<00:08, 2319.91 examples/s]Map:  63%|   | 31682/50245 [00:13<00:07, 2374.54 examples/s]Map:  64%|   | 32000/50245 [00:13<00:08, 2258.67 examples/s]Map:  64%|   | 32238/50245 [00:13<00:07, 2288.55 examples/s]Map:  65%|   | 32490/50245 [00:13<00:07, 2347.51 examples/s]Map:  65%|   | 32747/50245 [00:14<00:07, 2406.99 examples/s]Map:  66%|   | 32997/50245 [00:14<00:07, 2432.17 examples/s]Map:  66%|   | 33327/50245 [00:14<00:07, 2340.08 examples/s]Map:  67%|   | 33572/50245 [00:14<00:07, 2366.1 | 26000/50245 [00:02<00:02, 10550.46 examples/s]Filter:  56%|    | 28000/50245 [00:02<00:02, 10545.10 examples/s]Filter:  60%|    | 30000/50245 [00:02<00:01, 10496.60 examples/s]Filter:  64%|   | 32000/50245 [00:03<00:01, 10546.63 examples/s]Filter:  68%|   | 34000/50245 [00:03<00:01, 10574.32 examples/s]Filter:  72%|  | 36000/50245 [00:03<00:01, 10575.89 examples/s]Filter:  76%|  | 38000/50245 [00:03<00:01, 10501.53 examples/s]Filter:  80%|  | 40000/50245 [00:03<00:00, 10514.32 examples/s]Filter:  84%| | 42000/50245 [00:03<00:00, 10503.91 examples/s]Filter:  88%| | 44000/50245 [00:04<00:00, 10589.43 examples/s]Filter:  92%|| 46000/50245 [00:04<00:00, 10541.47 examples/s]Filter:  96%|| 48000/50245 [00:04<00:00, 10515.70 examples/s]Filter: 100%|| 50000/50245 [00:04<00:00, 10554.57 examples/s]Filter: 100%|| 50245/50245 [00:04<00:00, 10520.84 examples/s]
 26761/50245 [00:11<00:09, 2385.66 examples/s]Map:  54%|    | 27112/50245 [00:11<00:10, 2262.42 examples/s]Map:  55%|    | 27393/50245 [00:11<00:09, 2389.96 examples/s]Map:  55%|    | 27649/50245 [00:11<00:09, 2430.92 examples/s]Map:  56%|    | 27902/50245 [00:11<00:09, 2454.01 examples/s]Map:  56%|    | 28235/50245 [00:12<00:09, 2281.61 examples/s]Map:  57%|    | 28494/50245 [00:12<00:09, 2357.11 examples/s]Map:  57%|    | 28737/50245 [00:12<00:09, 2373.19 examples/s]Map:  58%|    | 28989/50245 [00:12<00:08, 2406.48 examples/s]Map:  58%|    | 29309/50245 [00:12<00:09, 2301.20 examples/s]Map:  59%|    | 29545/50245 [00:12<00:08, 2314.71 examples/s]Map:  59%|    | 29791/50245 [00:12<00:08, 2350.28 examples/s]Map:  60%|    | 30121/50245 [00:12<00:08, 2239.83 examples/s]Map:  60%|   | 18868/50245 [00:08<00:13, 2319.84 examples/s]Map:  38%|      | 19182/50245 [00:08<00:13, 2232.51 examples/s]Map:  39%|      | 19418/50245 [00:08<00:13, 2263.93 examples/s]Map:  39%|      | 19657/50245 [00:08<00:13, 2294.98 examples/s]Map:  40%|      | 19905/50245 [00:08<00:12, 2343.97 examples/s]Map:  40%|      | 20239/50245 [00:08<00:13, 2233.86 examples/s]Map:  41%|      | 20484/50245 [00:09<00:13, 2287.26 examples/s]Map:  41%|     | 20727/50245 [00:09<00:12, 2321.70 examples/s]Map:  42%|     | 21022/50245 [00:09<00:13, 2190.99 examples/s]Map:  42%|     | 21262/50245 [00:09<00:12, 2240.01 examples/s]Map:  43%|     | 21502/50245 [00:09<00:12, 2278.79 examples/s]Map:  43%|     | 21749/50245 [00:09<00:12, 2326.39 examples/s]Map:  44%|     | 22046/50245 [00:09<00:12, 2190.67 examples/s]Map:  44%|     | 22276/50245 [00:0[00:11<00:10, 2204.39 examples/s]Map:  53%|    | 26470/50245 [00:11<00:10, 2243.23 examples/s]Map:  53%|    | 26717/50245 [00:11<00:10, 2298.42 examples/s]Map:  54%|    | 26963/50245 [00:11<00:09, 2337.07 examples/s]Map:  54%|    | 27270/50245 [00:12<00:10, 2228.90 examples/s]Map:  55%|    | 27530/50245 [00:12<00:09, 2318.24 examples/s]Map:  56%|    | 27890/50245 [00:12<00:09, 2343.69 examples/s]Map:  56%|    | 28226/50245 [00:12<00:09, 2209.42 examples/s]Map:  57%|    | 28477/50245 [00:12<00:09, 2278.94 examples/s]Map:  57%|    | 28713/50245 [00:12<00:09, 2296.74 examples/s]Map:  58%|    | 28954/50245 [00:12<00:09, 2325.78 examples/s]Map:  58%|    | 29258/50245 [00:12<00:09, 2214.18 examples/s]Map:  59%|    | 29493/50245 [00:12<00:09, 2243.05 examples/s]Map:  59%|  Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]Filter:   2%|         | 1000/50245 [00:00<00:05, 9560.87 examples/s]Filter:   4%|         | 2000/50245 [00:00<00:05, 9639.31 examples/s]Filter:   6%|         | 3000/50245 [00:00<00:04, 9659.58 examples/s]Filter:   8%|         | 4000/50245 [00:00<00:04, 9666.83 examples/s]Filter:  10%|         | 5000/50245 [00:00<00:04, 9641.90 examples/s]Filter:  12%|        | 6000/50245 [00:00<00:04, 9690.84 examples/s]Filter:  14%|        | 7000/50245 [00:00<00:04, 9750.70 examples/s]Filter:  16%|        | 8000/50245 [00:00<00:04, 9729.81 examples/s]Filter:  18%|        | 9000/50245 [00:00<00:04, 9762.76 examples/s]Filter:  20%|        | 10000/50245 [00:01<00:04, 9737.08 examples/s]Filter:  22%|       | 11000/50245 [00:01<00:04, 9729.27 examples/s]Filter:  24%|       | 12000/50245 [00:01<00:03, 9728.18 examples/s]Filter:  26%|       | 13000/50245 [00:01<00:03, 9783.50 examples/s]Filt  | 36796/50245 [00:15<00:05, 2389.93 examples/s]Map:  74%|  | 37116/50245 [00:15<00:05, 2247.30 examples/s]Map:  75%|  | 37469/50245 [00:16<00:05, 2278.96 examples/s]Map:  75%|  | 37707/50245 [00:16<00:05, 2303.17 examples/s]Map:  76%|  | 37954/50245 [00:16<00:05, 2344.59 examples/s]Map:  76%|  | 38248/50245 [00:16<00:05, 2204.95 examples/s]Map:  77%|  | 38492/50245 [00:16<00:05, 2261.79 examples/s]Map:  77%|  | 38753/50245 [00:16<00:04, 2350.95 examples/s]Map:  78%|  | 39000/50245 [00:16<00:04, 2278.52 examples/s]Map:  78%|  | 39248/50245 [00:16<00:04, 2329.37 examples/s]Map:  79%|  | 39499/50245 [00:17<00:04, 2377.08 examples/s]Map:  79%|  | 39741/50245 [00:17<00:04, 2386.18 examples/s]Map:  80%|  | 3998 | 44359/50245 [00:19<00:02, 2339.65 examples/s]Map:  89%| | 44601/50245 [00:19<00:02, 2357.10 examples/s]Map:  89%| | 44851/50245 [00:19<00:02, 2392.09 examples/s]Map:  90%| | 45166/50245 [00:19<00:02, 2286.37 examples/s]Map:  90%| | 45403/50245 [00:19<00:02, 2294.19 examples/s]Map:  91%| | 45657/50245 [00:19<00:01, 2356.66 examples/s]Map:  91%|| 45906/50245 [00:19<00:01, 2392.33 examples/s]Map:  92%|| 46249/50245 [00:19<00:01, 2290.49 examples/s]Map:  93%|| 46506/50245 [00:19<00:01, 2358.88 examples/s]Map:  93%|| 46752/50245 [00:20<00:01, 2381.97 examples/s]Map:  94%|| 47000/50245 [00:20<00:01, 2293.03 examples/s]Map:  94%|| 47247/50245 [00:20<00:01, 2340.83 examples/s]Map7 examples/s]Map:  67%|   | 33812/50245 [00:14<00:06, 2372.80 examples/s]Map:  68%|   | 34132/50245 [00:14<00:07, 2278.88 examples/s]Map:  68%|   | 34392/50245 [00:14<00:06, 2357.83 examples/s]Map:  69%|   | 34645/50245 [00:14<00:06, 2402.53 examples/s]Map:  69%|   | 34911/50245 [00:14<00:06, 2471.20 examples/s]Map:  70%|   | 35247/50245 [00:15<00:06, 2341.12 examples/s]Map:  71%|   | 35494/50245 [00:15<00:06, 2369.61 examples/s]Map:  71%|   | 35735/50245 [00:15<00:06, 2375.81 examples/s]Map:  72%|  | 35987/50245 [00:15<00:05, 2413.04 examples/s]Map:  72%|  | 36308/50245 [00:15<00:06, 2307.20 examples/s]Map:  73%|  | 36564/50245 [00:15<00:05, 2369.82 examples/s]Map:  73%|  | 36817/50245 [00:15<00:05, 2409.32 examples/s]Map:  74%|Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]Filter:   2%|         | 1000/50245 [00:00<00:05, 9489.35 examples/s]Filter:   4%|         | 2000/50245 [00:00<00:05, 9527.18 examples/s]Filter:   6%|         | 3000/50245 [00:00<00:04, 9532.77 examples/s]Filter:   8%|         | 4000/50245 [00:00<00:04, 9526.05 examples/s]Filter:  10%|         | 5000/50245 [00:00<00:04, 9525.30 examples/s]Filter:  12%|        | 6000/50245 [00:00<00:04, 9604.92 examples/s]Filter:  14%|        | 7000/50245 [00:00<00:04, 9676.11 examples/s]Filter:  16%|        | 8000/50245 [00:00<00:04, 9644.21 examples/s]Filter:  18%|        | 9000/50245 [00:00<00:04, 9679.24 examples/s]Filter:  20%|        | 10000/50245 [00:01<00:04, 9694.92 examples/s]Filter:  22%|       | 11000/50245 [00:01<00:04, 9700.05 examples/s]Filter:  24%|       | 12000/50245 [00:01<00:03, 9696.89 examples/s]Filter:  26%|       | 13000/50245 [00:01<00:03, 9776.78 examples/s]Filt    | 30374/50245 [00:12<00:08, 2310.46 examples/s]Map:  61%|    | 30629/50245 [00:13<00:08, 2372.84 examples/s]Map:  61%|   | 30872/50245 [00:13<00:08, 2385.68 examples/s]Map:  62%|   | 31126/50245 [00:13<00:08, 2278.91 examples/s]Map:  62%|   | 31375/50245 [00:13<00:08, 2333.13 examples/s]Map:  63%|   | 31626/50245 [00:13<00:07, 2380.54 examples/s]Map:  63%|   | 31871/50245 [00:13<00:07, 2398.11 examples/s]Map:  64%|   | 32181/50245 [00:13<00:07, 2269.11 examples/s]Map:  65%|   | 32421/50245 [00:13<00:07, 2301.48 examples/s]Map:  65%|   | 32686/50245 [00:13<00:07, 2392.98 examples/s]Map:  66%|   | 32943/50245 [00:14<00:07, 2439.86 examples/s]Map:  66%|   | 33268/50245 [00:14<00:07, 2334.11 examples/s]Map:  67%|   | 33523/50245 [00:14<00:07,  | 29725/50245 [00:13<00:09, 2260.09 examples/s]Map:  60%|    | 29957/50245 [00:13<00:08, 2275.00 examples/s]Map:  60%|    | 30273/50245 [00:13<00:09, 2207.28 examples/s]Map:  61%|    | 30512/50245 [00:13<00:08, 2251.72 examples/s]Map:  61%|    | 30747/50245 [00:13<00:08, 2275.49 examples/s]Map:  62%|   | 30990/50245 [00:13<00:08, 2316.05 examples/s]Map:  62%|   | 31295/50245 [00:13<00:08, 2206.27 examples/s]Map:  63%|   | 31534/50245 [00:13<00:08, 2251.56 examples/s]Map:  63%|   | 31780/50245 [00:13<00:08, 2305.03 examples/s]Map:  64%|   | 32115/50245 [00:14<00:08, 2193.06 examples/s]Map:  64%|   | 32347/50245 [00:14<00:08, 2222.04 examples/s]Map:  65%|   | 32603/50245 [00:14<00:07, 2308.13 examples/s]Map:  65%|   | 32849/50245 [00:14<00:07, 2346.68 examples/ser:  28%|       | 14000/50245 [00:01<00:03, 9759.61 examples/s]Filter:  30%|       | 15000/50245 [00:01<00:03, 9771.19 examples/s]Filter:  32%|      | 16000/50245 [00:01<00:03, 9695.13 examples/s]Filter:  34%|      | 17000/50245 [00:01<00:03, 9758.62 examples/s]Filter:  36%|      | 18000/50245 [00:01<00:03, 9711.38 examples/s]Filter:  38%|      | 19000/50245 [00:01<00:03, 9765.89 examples/s]Filter:  40%|      | 20000/50245 [00:02<00:03, 9830.31 examples/s]Filter:  42%|     | 21000/50245 [00:02<00:02, 9804.11 examples/s]Filter:  44%|     | 22000/50245 [00:02<00:02, 9767.86 examples/s]Filter:  46%|     | 23000/50245 [00:02<00:02, 9711.77 examples/s]Filter:  48%|     | 24000/50245 [00:02<00:02, 9693.40 examples/s]Filter:  50%|     | 25000/50245 [00:02<00:02, 9640.07 examples/s]Filter:  52%|    | 26000/50245 [00:02<00:02, 9716.86 exa9<00:12, 2218.26 examples/s]Map:  45%|     | 22518/50245 [00:09<00:12, 2272.56 examples/s]Map:  45%|     | 22755/50245 [00:10<00:11, 2297.15 examples/s]Map:  46%|     | 22997/50245 [00:10<00:11, 2330.63 examples/s]Map:  46%|     | 23307/50245 [00:10<00:12, 2226.85 examples/s]Map:  47%|     | 23552/50245 [00:10<00:11, 2281.69 examples/s]Map:  48%|     | 23907/50245 [00:10<00:11, 2308.54 examples/s]Map:  48%|     | 24215/50245 [00:10<00:11, 2169.23 examples/s]Map:  49%|     | 24458/50245 [00:10<00:11, 2228.57 examples/s]Map:  49%|     | 24695/50245 [00:10<00:11, 2262.53 examples/s]Map:  50%|     | 24946/50245 [00:11<00:10, 2325.58 examples/s]Map:  50%|     | 25262/50245 [00:11<00:11, 2242.41 examples/s]Map:  51%|     | 25514/50245 [00:11<00:10, 2310.56 examples/s]Map:  51%|     | 25750/50245 [00:11<00:10, 25/50245 [00:17<00:04, 2398.96 examples/s]Map:  80%|  | 40310/50245 [00:17<00:04, 2307.40 examples/s]Map:  81%|  | 40566/50245 [00:17<00:04, 2372.44 examples/s]Map:  81%|  | 40819/50245 [00:17<00:03, 2412.80 examples/s]Map:  82%| | 41131/50245 [00:17<00:03, 2281.14 examples/s]Map:  83%| | 41488/50245 [00:17<00:03, 2311.73 examples/s]Map:  83%| | 41731/50245 [00:17<00:03, 2339.16 examples/s]Map:  84%| | 42026/50245 [00:18<00:03, 2206.36 examples/s]Map:  84%| | 42279/50245 [00:18<00:03, 2284.10 examples/s]Map:  85%| | 42526/50245 [00:18<00:03, 2330.48 examples/s]Map:  85%| | 42776/50245 [00:18<00:03, 2372.35 examples/s]Map:  86%| | 43121/50245 [00:18<00:03, 2254.62 examples/s]Map:  86%| | 43:  95%|| 47600/50245 [00:20<00:01, 2342.76 examples/s]Map:  95%|| 47930/50245 [00:20<00:01, 1796.09 examples/s]Map:  96%|| 48260/50245 [00:20<00:01, 1902.73 examples/s]Map:  97%|| 48522/50245 [00:20<00:00, 2050.32 examples/s]Map:  97%|| 48774/50245 [00:21<00:00, 2156.12 examples/s]Map:  98%|| 49124/50245 [00:21<00:00, 2147.50 examples/s]Map:  98%|| 49359/50245 [00:21<00:00, 2191.30 examples/s]Map:  99%|| 49600/50245 [00:21<00:00, 2244.46 examples/s]Map:  99%|| 49856/50245 [00:21<00:00, 2326.10 examples/s]Map: 100%|| 50165/50245 [00:21<00:00, 2225.62 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2317.80 examples/s]
er:  28%|       | 14000/50245 [00:01<00:03, 9777.49 examples/s]Filter:  30%|       | 15000/50245 [00:01<00:03, 9742.20 examples/s]Filter:  32%|      | 16000/50245 [00:01<00:03, 9658.09 examples/s]Filter:  34%|      | 17000/50245 [00:01<00:03, 9726.81 examples/s]Filter:  36%|      | 18000/50245 [00:01<00:03, 9702.49 examples/s]Filter:  38%|      | 19000/50245 [00:01<00:03, 9738.98 examples/s]Filter:  40%|      | 20000/50245 [00:02<00:03, 9749.83 examples/s]Filter:  42%|     | 21000/50245 [00:02<00:03, 9725.34 examples/s]Filter:  44%|     | 22000/50245 [00:02<00:02, 9691.46 examples/s]Filter:  46%|     | 23000/50245 [00:02<00:02, 9669.26 examples/s]Filter:  48%|     | 24000/50245 [00:02<00:02, 9645.18 examples/s]Filter:  50%|     | 25000/50245 [00:02<00:02, 9622.02 examples/s]Filter:  52%|    | 26000/50245 [00:02<00:02, 9692.97 exa  | 37117/50245 [00:15<00:05, 2248.06 examples/s]Map:  75%|  | 37475/50245 [00:16<00:05, 2293.14 examples/s]Map:  75%|  | 37716/50245 [00:16<00:05, 2320.02 examples/s]Map:  76%|  | 37961/50245 [00:16<00:05, 2350.29 examples/s]Map:  76%|  | 38267/50245 [00:16<00:05, 2235.27 examples/s]Map:  77%|  | 38518/50245 [00:16<00:05, 2303.49 examples/s]Map:  77%|  | 38774/50245 [00:16<00:04, 2369.30 examples/s]Map:  78%|  | 39126/50245 [00:16<00:04, 2314.83 examples/s]Map:  78%|  | 39379/50245 [00:16<00:04, 2366.84 examples/s]Map:  79%|  | 39620/50245 [00:16<00:04, 2377.66 examples/s]Map:  79%|  | 39871/50245 [00:17<00:04, 2413.13 examples/s]Map:  80%|  | 40182/50245 [00:17<00:04, 2284.95 examples/s]Map:  81%|mples/s]Filter:  54%|    | 27000/50245 [00:02<00:02, 9691.90 examples/s]Filter:  56%|    | 28000/50245 [00:02<00:02, 9755.80 examples/s]Filter:  58%|    | 29000/50245 [00:02<00:02, 9696.79 examples/s]Filter:  60%|    | 30000/50245 [00:03<00:02, 9663.41 examples/s]Filter:  62%|   | 31000/50245 [00:03<00:01, 9719.95 examples/s]Filter:  64%|   | 32000/50245 [00:03<00:01, 9739.51 examples/s]Filter:  66%|   | 33000/50245 [00:03<00:01, 9776.25 examples/s]Filter:  68%|   | 34000/50245 [00:03<00:01, 9772.42 examples/s]Filter:  72%|  | 36000/50245 [00:03<00:01, 9813.21 examples/s]Filter:  74%|  | 37000/50245 [00:03<00:01, 9812.05 examples/s]Filter:  76%|  | 38000/50245 [00:03<00:01, 9723.77 examples/s]Filter:  78%|  | 39000/50245 [00:04<00:01, 9779.44 example 2387.55 examples/s]Map:  67%|   | 33894/50245 [00:14<00:06, 2413.91 examples/s]Map:  68%|   | 34264/50245 [00:14<00:06, 2335.50 examples/s]Map:  69%|   | 34523/50245 [00:14<00:06, 2393.43 examples/s]Map:  69%|   | 34768/50245 [00:14<00:06, 2404.83 examples/s]Map:  70%|   | 35124/50245 [00:14<00:06, 2337.70 examples/s]Map:  70%|   | 35370/50245 [00:15<00:06, 2366.41 examples/s]Map:  71%|   | 35622/50245 [00:15<00:06, 2404.43 examples/s]Map:  72%|  | 35987/50245 [00:15<00:05, 2412.84 examples/s]Map:  72%|  | 36310/50245 [00:15<00:06, 2321.59 examples/s]Map:  73%|  | 36568/50245 [00:15<00:05, 2379.15 examples/s]Map:  73%|  | 36822/50245 [00:15<00:05, 2418.98 examples/s]Map:  74%|  | 37125/50245 [00:15<00:05, 2272.69 examples/s]Map:  75%]Map:  66%|   | 33169/50245 [00:14<00:07, 2263.61 examples/s]Map:  66%|   | 33410/50245 [00:14<00:07, 2297.78 examples/s]Map:  67%|   | 33649/50245 [00:14<00:07, 2320.56 examples/s]Map:  67%|   | 33894/50245 [00:14<00:06, 2353.64 examples/s]Map:  68%|   | 34252/50245 [00:15<00:07, 2251.20 examples/s]Map:  69%|   | 34502/50245 [00:15<00:06, 2313.25 examples/s]Map:  69%|   | 34742/50245 [00:15<00:06, 2333.38 examples/s]Map:  70%|   | 35000/50245 [00:15<00:06, 2270.48 examples/s]Map:  70%|   | 35236/50245 [00:15<00:06, 2294.05 examples/s]Map:  71%|   | 35473/50245 [00:15<00:06, 2311.90 examples/s]Map:  71%|   | 35712/50245 [00:15<00:06, 2330.15 examples/s]Map:  72%|  | 35952/50245 [00:15<00:06, 2345.54 examples/s]Map:  72%|  319.83 examples/s]Map:  52%|    | 26043/50245 [00:11<00:11, 2185.56 examples/s]Map:  52%|    | 26279/50245 [00:11<00:10, 2227.87 examples/s]Map:  53%|    | 26512/50245 [00:11<00:10, 2251.02 examples/s]Map:  53%|    | 26759/50245 [00:11<00:10, 2309.09 examples/s]Map:  54%|    | 27000/50245 [00:11<00:10, 2187.01 examples/s]Map:  54%|    | 27245/50245 [00:12<00:10, 2257.28 examples/s]Map:  55%|    | 27497/50245 [00:12<00:09, 2328.56 examples/s]Map:  55%|    | 27733/50245 [00:12<00:09, 2333.67 examples/s]Map:  56%|    | 27980/50245 [00:12<00:09, 2372.32 examples/s]Map:  56%|    | 28262/50245 [00:12<00:10, 2180.28 examples/s]Map:  57%|    | 28513/50245 [00:12<00:09, 2265.49 examples/s]Map:  57%|    | 28749/50245 [00:12<00:09, 2287.13 examples/s]Map:  58%|    | 28989/50245386/50245 [00:18<00:02, 2350.42 examples/s]Map:  87%| | 43641/50245 [00:18<00:02, 2401.09 examples/s]Map:  88%| | 44000/50245 [00:18<00:02, 2298.65 examples/s]Map:  88%| | 44356/50245 [00:19<00:02, 2321.26 examples/s]Map:  89%| | 44596/50245 [00:19<00:02, 2338.60 examples/s]Map:  89%| | 44846/50245 [00:19<00:02, 2377.23 examples/s]Map:  90%| | 45162/50245 [00:19<00:02, 2275.57 examples/s]Map:  90%| | 45395/50245 [00:19<00:02, 2288.22 examples/s]Map:  91%| | 45647/50245 [00:19<00:01, 2345.47 examples/s]Map:  91%|| 45895/50245 [00:19<00:01, 2378.12 examples/s]Map:  92%|| 46248/50245 [00:19<00:01, 2280.80 examples/s]Map:  93%|| 46501/50245 [00:20<00:01, 2342.94 examples/s]Map:  93%|Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]Filter:   2%|         | 1000/50245 [00:00<00:05, 9060.56 examples/s]Filter:   4%|         | 2000/50245 [00:00<00:05, 9185.90 examples/s]Filter:   6%|         | 3000/50245 [00:00<00:05, 9249.86 examples/s]Filter:   8%|         | 4000/50245 [00:00<00:04, 9312.04 examples/s]Filter:  10%|         | 5000/50245 [00:00<00:04, 9328.58 examples/s]Filter:  12%|        | 6000/50245 [00:00<00:04, 9444.02 examples/s]Filter:  14%|        | 7000/50245 [00:00<00:04, 9504.72 examples/s]Filter:  16%|        | 8000/50245 [00:00<00:04, 9500.35 examples/s]Filter:  18%|        | 9000/50245 [00:00<00:04, 9526.69 examples/s]Filter:  20%|        | 10000/50245 [00:01<00:04, 9536.66 examples/s]Filter:  22%|       | 11000/50245 [00:01<00:04, 9524.43 examples/s]Filter:  24%|       | 12000/50245 [00:01<00:04, 9522.74 examples/s]Filter:  26%|       | 13000/50245 [00:01<00:03, 9585.65 examples/s]Filtmples/s]Filter:  54%|    | 27000/50245 [00:02<00:02, 9618.72 examples/s]Filter:  56%|    | 28000/50245 [00:02<00:02, 9685.20 examples/s]Filter:  58%|    | 29000/50245 [00:02<00:02, 9651.37 examples/s]Filter:  60%|    | 30000/50245 [00:03<00:02, 9639.37 examples/s]Filter:  62%|   | 31000/50245 [00:03<00:01, 9691.67 examples/s]Filter:  64%|   | 32000/50245 [00:03<00:01, 9684.86 examples/s]Filter:  66%|   | 33000/50245 [00:03<00:01, 9747.65 examples/s]Filter:  68%|   | 34000/50245 [00:03<00:01, 9735.30 examples/s]Filter:  72%|  | 36000/50245 [00:03<00:01, 9771.82 examples/s]Filter:  74%|  | 37000/50245 [00:03<00:01, 9769.75 examples/s]Filter:  76%|  | 38000/50245 [00:03<00:01, 9699.45 examples/s]Filter:  78%|  | 39000/50245 [00:04<00:01, 9710.47 example  | 40455/50245 [00:17<00:04, 2400.04 examples/s]Map:  81%|  | 40701/50245 [00:17<00:03, 2412.81 examples/s]Map:  82%| | 41009/50245 [00:17<00:04, 2278.56 examples/s]Map:  82%| | 41249/50245 [00:17<00:03, 2307.33 examples/s]Map:  83%| | 41499/50245 [00:17<00:03, 2354.53 examples/s]Map:  83%| | 41745/50245 [00:17<00:03, 2379.50 examples/s]Map:  84%| | 42038/50245 [00:18<00:03, 2220.24 examples/s]Map:  84%| | 42294/50245 [00:18<00:03, 2307.31 examples/s]Map:  85%| | 42546/50245 [00:18<00:03, 2363.93 examples/s]Map:  85%| | 42792/50245 [00:18<00:03, 2388.90 examples/s]Map:  86%| | 43122/50245 [00:18<00:03, 2257.79 examples/s]Map:  86%| | 43389/50245 [00:18<00:02, 2363.06 examples/s]Map:  87%|s/s]Filter:  80%|  | 40000/50245 [00:04<00:01, 9764.72 examples/s]Filter:  82%| | 41000/50245 [00:04<00:00, 9803.37 examples/s]Filter:  84%| | 42000/50245 [00:04<00:00, 9719.24 examples/s]Filter:  86%| | 43000/50245 [00:04<00:00, 9744.58 examples/s]Filter:  90%| | 45000/50245 [00:04<00:00, 9782.25 examples/s]Filter:  92%|| 46000/50245 [00:04<00:00, 9727.02 examples/s]Filter:  94%|| 47000/50245 [00:04<00:00, 9753.60 examples/s]Filter:  96%|| 48000/50245 [00:04<00:00, 9691.38 examples/s]Filter:  98%|| 49000/50245 [00:05<00:00, 9752.59 examples/s]Filter: 100%|| 50000/50245 [00:05<00:00, 9699.52 examples/s]Filter: 100%|| 50245/50245 [00:05<00:00, 9722.99 examples/s]
Building eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
|  | 37485/50245 [00:15<00:05, 2311.91 examples/s]Map:  75%|  | 37726/50245 [00:16<00:05, 2328.77 examples/s]Map:  76%|  | 37971/50245 [00:16<00:05, 2357.27 examples/s]Map:  76%|  | 38276/50245 [00:16<00:05, 2240.02 examples/s]Map:  77%|  | 38530/50245 [00:16<00:05, 2314.41 examples/s]Map:  77%|  | 38787/50245 [00:16<00:04, 2379.14 examples/s]Map:  78%|  | 39127/50245 [00:16<00:04, 2331.11 examples/s]Map:  78%|  | 39382/50245 [00:16<00:04, 2385.06 examples/s]Map:  79%|  | 39624/50245 [00:16<00:04, 2392.79 examples/s]Map:  79%|  | 39878/50245 [00:16<00:04, 2429.68 examples/s]Map:  80%|  | 40183/50245 [00:17<00:04, 2278.30 examples/s]Map:  81%|  | 40453/50245 [00:17<00:04, 2385.83 examples/s]Map:  81%|| 36269/50245 [00:15<00:06, 2255.19 examples/s]Map:  73%|  | 36517/50245 [00:16<00:05, 2313.06 examples/s]Map:  73%|  | 36758/50245 [00:16<00:05, 2338.73 examples/s]Map:  74%|  | 36999/50245 [00:16<00:05, 2355.49 examples/s]Map:  74%|  | 37270/50245 [00:16<00:06, 2147.70 examples/s]Map:  75%|  | 37519/50245 [00:16<00:05, 2236.01 examples/s]Map:  75%|  | 37753/50245 [00:16<00:05, 2261.52 examples/s]Map:  76%|  | 37992/50245 [00:16<00:05, 2295.09 examples/s]Map:  76%|  | 38289/50245 [00:16<00:05, 2174.46 examples/s]Map:  77%|  | 38536/50245 [00:16<00:05, 2250.00 examples/s]Map:  77%|  | 38786/50245 [00:17<00:04, 2316.91 examples/s]Map:  78%|  | 39123/50245 [00:17<00:04, 2266.58 examples/s]Map:  78%|  | 39369/50245 [0 [00:12<00:09, 2315.02 examples/s]Map:  58%|    | 29300/50245 [00:12<00:09, 2218.60 examples/s]Map:  59%|    | 29528/50245 [00:13<00:09, 2231.39 examples/s]Map:  59%|    | 29766/50245 [00:13<00:09, 2268.74 examples/s]Map:  60%|    | 29996/50245 [00:13<00:08, 2275.34 examples/s]Map:  60%|    | 30298/50245 [00:13<00:09, 2174.08 examples/s]Map:  61%|    | 30539/50245 [00:13<00:08, 2234.01 examples/s]Map:  61%|   | 30778/50245 [00:13<00:08, 2272.64 examples/s]Map:  62%|   | 31120/50245 [00:13<00:08, 2169.18 examples/s]Map:  62%|   | 31358/50245 [00:13<00:08, 2220.29 examples/s]Map:  63%|   | 31598/50245 [00:13<00:08, 2261.86 examples/s]Map:  63%|   | 31839/50245 [00:14<00:07, 2301.72 examples/s]Map:  64%|   | 32136/50245 [00:14<00:08, 2179.22 examples/s]Map:  64%|| 46744/50245 [00:20<00:01, 2363.08 examples/s]Map:  94%|| 47000/50245 [00:20<00:01, 2285.69 examples/s]Map:  94%|| 47247/50245 [00:20<00:01, 2334.01 examples/s]Map:  95%|| 47596/50245 [00:20<00:01, 2328.00 examples/s]Map:  95%|| 47926/50245 [00:20<00:01, 1787.01 examples/s]Map:  96%|| 48256/50245 [00:20<00:01, 1888.99 examples/s]Map:  97%|| 48518/50245 [00:21<00:00, 2040.48 examples/s]Map:  97%|| 48764/50245 [00:21<00:00, 2132.54 examples/s]Map:  98%|| 49000/50245 [00:21<00:00, 2090.41 examples/s]Map:  98%|| 49237/50245 [00:21<00:00, 2160.14 examples/s]Map:  98%|| 49470/50245 [00:21<00:00, 2200.45 examples/s]Map:  99%|| 49719/50245 [00:21<00:00, 2272.44 exampleser:  28%|       | 14000/50245 [00:01<00:03, 9553.47 examples/s]Filter:  30%|       | 15000/50245 [00:01<00:03, 9570.92 examples/s]Filter:  32%|      | 16000/50245 [00:01<00:03, 9513.97 examples/s]Filter:  34%|      | 17000/50245 [00:01<00:03, 9572.50 examples/s]Filter:  36%|      | 18000/50245 [00:01<00:03, 9520.43 examples/s]Filter:  38%|      | 19000/50245 [00:02<00:03, 9565.69 examples/s]Filter:  40%|      | 20000/50245 [00:02<00:03, 9554.36 examples/s]Filter:  42%|     | 21000/50245 [00:02<00:03, 9468.30 examples/s]Filter:  44%|     | 22000/50245 [00:02<00:02, 9441.43 examples/s]Filter:  46%|     | 23000/50245 [00:02<00:02, 9413.44 examples/s]Filter:  48%|     | 24000/50245 [00:02<00:02, 9422.77 examples/s]Filter:  50%|     | 25000/50245 [00:02<00:02, 9399.87 examples/s]Filter:  52%|    | 26000/50245 [00:02<00:02, 9415.84 exa/s]Map:  99%|| 49959/50245 [00:21<00:00, 2305.65 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2132.98 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2304.59 examples/s]
s/s]Filter:  80%|  | 40000/50245 [00:04<00:01, 9635.35 examples/s]Filter:  82%| | 41000/50245 [00:04<00:00, 9623.35 examples/s]Filter:  84%| | 42000/50245 [00:04<00:00, 9507.62 examples/s]Filter:  86%| | 43000/50245 [00:04<00:00, 9555.72 examples/s]Filter:  88%| | 44000/50245 [00:04<00:00, 9608.37 examples/s]Filter:  90%| | 45000/50245 [00:04<00:00, 9600.92 examples/s]Filter:  92%|| 46000/50245 [00:04<00:00, 9570.18 examples/s]Filter:  94%|| 47000/50245 [00:04<00:00, 9651.84 examples/s]Filter:  96%|| 48000/50245 [00:04<00:00, 9582.82 examples/s]Filter:  98%|| 49000/50245 [00:05<00:00, 9658.09 examples/s]Filter: 100%|| 50000/50245 [00:05<00:00, 9545.17 examples/s]Filter: 100%|| 50245/50245 [00:05<00:00, 9586.15 examples/s]
Building eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Building eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 | 43644/50245 [00:18<00:02, 2411.21 examples/s]Map:  88%| | 44000/50245 [00:18<00:02, 2298.22 examples/s]Map:  88%| | 44358/50245 [00:19<00:02, 2323.82 examples/s]Map:  89%| | 44600/50245 [00:19<00:02, 2345.79 examples/s]Map:  89%| | 44851/50245 [00:19<00:02, 2385.68 examples/s]Map:  90%| | 45163/50245 [00:19<00:02, 2274.73 examples/s]Map:  90%| | 45399/50245 [00:19<00:02, 2295.13 examples/s]Map:  91%| | 45654/50245 [00:19<00:01, 2358.62 examples/s]Map:  91%|| 45905/50245 [00:19<00:01, 2396.97 examples/s]Map:  92%|| 46250/50245 [00:19<00:01, 2283.53 examples/s]Map:  93%|| 46501/50245 [00:19<00:01, 2338.19 examples/s]Map:  93%|| 46739/50245 [00:20<00:01, 2346.56 examples/s]Map:  94%|  | 40697/50245 [00:17<00:03, 2396.16 examples/s]Map:  82%| | 41005/50245 [00:17<00:04, 2266.31 examples/s]Map:  82%| | 41246/50245 [00:17<00:03, 2302.87 examples/s]Map:  83%| | 41493/50245 [00:17<00:03, 2343.24 examples/s]Map:  83%| | 41736/50245 [00:17<00:03, 2365.30 examples/s]Map:  84%| | 42028/50245 [00:17<00:03, 2206.80 examples/s]Map:  84%| | 42279/50245 [00:18<00:03, 2283.83 examples/s]Map:  85%| | 42524/50245 [00:18<00:03, 2327.69 examples/s]Map:  85%| | 42770/50245 [00:18<00:03, 2362.67 examples/s]Map:  86%| | 43118/50245 [00:18<00:03, 2214.10 examples/s]Map:  86%| | 43383/50245 [00:18<00:02, 2319.82 examples/s]Map:  87%| | 43636/50245 [00:18<00:02, 2372.69 examples/s]Map:  88%|0:17<00:04, 2310.59 examples/s]Map:  79%|  | 39730/50245 [00:17<00:04, 2342.56 examples/s]Map:  80%|  | 39969/50245 [00:17<00:04, 2352.11 examples/s]Map:  80%|  | 40283/50245 [00:17<00:04, 2256.94 examples/s]Map:  81%|  | 40543/50245 [00:17<00:04, 2342.21 examples/s]Map:  81%|  | 40786/50245 [00:17<00:04, 2360.09 examples/s]Map:  82%| | 41129/50245 [00:18<00:04, 2251.94 examples/s]Map:  83%| | 41474/50245 [00:18<00:03, 2264.63 examples/s]Map:  83%| | 41718/50245 [00:18<00:03, 2303.20 examples/s]Map:  84%| | 42008/50245 [00:18<00:03, 2174.69 examples/s]Map:  84%| | 42255/50245 [00:18<00:03, 2245.26 examples/s]Map:  85%| | 42493/50245 [00:18<00:03, 2278.24 examples/s]Map:  85%| | 42744/50245 [00:   | 32363/50245 [00:14<00:08, 2201.85 examples/s]Map:  65%|   | 32622/50245 [00:14<00:07, 2305.30 examples/s]Map:  65%|   | 32859/50245 [00:14<00:07, 2321.50 examples/s]Map:  66%|   | 33178/50245 [00:14<00:07, 2242.27 examples/s]Map:  67%|   | 33420/50245 [00:14<00:07, 2286.90 examples/s]Map:  67%|   | 33658/50245 [00:14<00:07, 2308.68 examples/s]Map:  67%|   | 33896/50245 [00:14<00:07, 2327.06 examples/s]Map:  68%|   | 34245/50245 [00:15<00:07, 2209.37 examples/s]Map:  69%|   | 34490/50245 [00:15<00:06, 2267.87 examples/s]Map:  69%|   | 34731/50245 [00:15<00:06, 2303.25 examples/s]Map:  70%|   | 34990/50245 [00:15<00:06, 2378.69 examples/s]Map:  70%|   | 35292/50245 [00:15<00:06, 2237.81 examples/s]Map:  71%|   | 35637/50245 [00:15<00mples/s]Filter:  54%|    | 27000/50245 [00:02<00:02, 9335.60 examples/s]Filter:  56%|    | 28000/50245 [00:02<00:02, 9376.09 examples/s]Filter:  58%|    | 29000/50245 [00:03<00:02, 9323.66 examples/s]Filter:  60%|    | 30000/50245 [00:03<00:02, 9300.61 examples/s]Filter:  62%|   | 31000/50245 [00:03<00:02, 9305.62 examples/s]Filter:  64%|   | 32000/50245 [00:03<00:01, 9319.04 examples/s]Filter:  66%|   | 33000/50245 [00:03<00:01, 9368.54 examples/s]Filter:  68%|   | 34000/50245 [00:03<00:01, 9380.64 examples/s]Filter:  70%|   | 35000/50245 [00:03<00:01, 9454.76 examples/s]Filter:  72%|  | 36000/50245 [00:03<00:01, 9382.25 examples/s]Filter:  74%|  | 37000/50245 [00:03<00:01, 9421.44 examples/s]Filter:  76%|  | 38000/50245 [00:04<00:01, 9303.54 examples/| 46994/50245 [00:20<00:01, 2397.88 examples/s]Map:  94%|| 47302/50245 [00:20<00:01, 2267.34 examples/s]Map:  95%|| 47644/50245 [00:20<00:01, 2268.44 examples/s]Map:  95%|| 47923/50245 [00:20<00:01, 1744.37 examples/s]Map:  96%|| 48122/50245 [00:20<00:01, 1770.94 examples/s]Map:  96%|| 48374/50245 [00:20<00:00, 1936.84 examples/s]Map:  97%|| 48625/50245 [00:21<00:00, 2074.56 examples/s]Map:  97%|| 48865/50245 [00:21<00:00, 2155.61 examples/s]Map:  98%|| 49175/50245 [00:21<00:00, 2122.67 examples/s]Map:  98%|| 49396/50245 [00:21<00:00, 2141.37 examples/s]Map:  99%|| 49634/50245 [00:21<00:00, 2202.15 examples/s]Map:  99%|| 49875/50245 [00:21<00:00, 2257.42 examples/s]Map: 100%|| 50183/50245 [00:21<00:00, 2179.02 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2302.23 examples/s]
 | 44000/50245 [00:18<00:02, 2280.34 examples/s]Map:  88%| | 44235/50245 [00:18<00:02, 2294.30 examples/s]Map:  89%| | 44469/50245 [00:18<00:02, 2302.61 examples/s]Map:  89%| | 44722/50245 [00:19<00:02, 2362.11 examples/s]Map:  90%| | 44974/50245 [00:19<00:02, 2403.07 examples/s]Map:  90%| | 45272/50245 [00:19<00:02, 2243.56 examples/s]Map:  91%| | 45513/50245 [00:19<00:02, 2285.18 examples/s]Map:  91%| | 45752/50245 [00:19<00:01, 2313.06 examples/s]Map:  92%|| 46000/50245 [00:19<00:01, 2216.14 examples/s]Map:  92%|| 46244/50245 [00:19<00:01, 2274.86 examples/s]Map:  93%|| 46497/50245 [00:19<00:01, 2345.25 examples/s]Map:  93%|| 46741/50245 [00:19<00:01, 2366.21 examples/s]MapBuilding eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
s]Filter:  78%|  | 39000/50245 [00:04<00:01, 9370.75 examples/s]Filter:  80%|  | 40000/50245 [00:04<00:01, 9316.42 examples/s]Filter:  82%| | 41000/50245 [00:04<00:00, 9326.50 examples/s]Filter:  84%| | 42000/50245 [00:04<00:00, 9254.77 examples/s]Filter:  86%| | 43000/50245 [00:04<00:00, 9320.91 examples/s]Filter:  88%| | 44000/50245 [00:04<00:00, 9400.87 examples/s]Filter:  90%| | 45000/50245 [00:04<00:00, 9364.08 examples/s]Filter:  92%|| 46000/50245 [00:04<00:00, 9315.09 examples/s]Filter:  94%|| 47000/50245 [00:04<00:00, 9358.36 examples/s]Filter:  96%|| 48000/50245 [00:05<00:00, 9291.48 examples/s]Filter:  98%|| 49000/50245 [00:05<00:00, 9384.04 examples/s]Filter: 100%|18<00:03, 2334.00 examples/s]Map:  86%| | 43032/50245 [00:18<00:03, 2179.34 examples/s]Map:  86%| | 43283/50245 [00:19<00:03, 2260.16 examples/s]Map:  87%| | 43529/50245 [00:19<00:02, 2312.79 examples/s]Map:  87%| | 43780/50245 [00:19<00:02, 2364.34 examples/s]Map:  88%| | 44116/50245 [00:19<00:02, 2212.43 examples/s]Map:  88%| | 44449/50245 [00:19<00:02, 2206.27 examples/s]Map:  89%| | 44696/50245 [00:19<00:02, 2267.17 examples/s]Map:  90%| | 45000/50245 [00:19<00:02, 2180.31 examples/s]Map:  90%| | 45227/50245 [00:19<00:02, 2197.51 examples/s]Map:  91%| | 45570/50245 [00:20<00:02, 2225.46 examples/s]Map:  91%| | 45810/50245 [00:20<00:01, 2264.98 examples/s]Map:  92%|| 46118/| 50000/50245 [00:05<00:00, 9304.15 examples/s]Filter: 100%|| 50245/50245 [00:05<00:00, 9299.36 examples/s]
Building eval loader...
Initializing model...
:06, 2255.88 examples/s]Map:  72%|  | 35985/50245 [00:15<00:06, 2270.49 examples/s]Map:  72%|  | 36287/50245 [00:16<00:06, 2185.60 examples/s]Map:  73%|  | 36526/50245 [00:16<00:06, 2231.15 examples/s]Map:  73%|  | 36763/50245 [00:16<00:05, 2262.79 examples/s]Map:  74%|  | 36995/50245 [00:16<00:05, 2274.58 examples/s]Map:  74%|  | 37260/50245 [00:16<00:06, 2089.46 examples/s]Map:  75%|  | 37490/50245 [00:16<00:05, 2132.65 examples/s]Map:  75%|  | 37715/50245 [00:16<00:05, 2163.02 examples/s]Map:  76%|  | 37948/50245 [00:16<00:05, 2204.37 examples/s]Map:  76%|  | 38234/50245 [00:16<00:05, 2089.63 examples/s]Map:  77%|  | 38468/50245 [00:17<00:05, 2151.75 examples/s]Map:  77%|  | 38715/50245 [00:17<00:05, 2237.55 exa/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
:  94%|| 46996/50245 [00:20<00:01, 2415.90 examples/s]Map:  94%|| 47305/50245 [00:20<00:01, 2274.51 examples/s]Map:  95%|| 47661/50245 [00:20<00:01, 2304.56 examples/s]Map:  95%|| 47924/50245 [00:20<00:01, 1745.51 examples/s]Map:  96%|| 48122/50245 [00:20<00:01, 1773.90 examples/s]Map:  96%|| 48380/50245 [00:20<00:00, 1956.57 examples/s]Map:  97%|| 48630/50245 [00:20<00:00, 2087.41 examples/s]Map:  97%|| 48871/50245 [00:20<00:00, 2167.26 examples/s]Map:  98%|| 49121/50245 [00:21<00:00, 2125.25 examples/s]Map:  98%|| 49351/50245 [00:21<00:00, 2166.12 examples/s]Map:  99%|| 49585/50245 [00:21<00:00, 2212.03 examples/s]Map:  99%|| 49838/50245 [00:21<00:00, 2298.94 examples/s]Map: 100%|| 50138/50245 [00:21<00:00, 2181.98 examples/s]Map: 100%|| 50245/50245 [00:21<00:00, 2319.05 examples/s]
mples/s]Map:  78%|  | 38966/50245 [00:17<00:04, 2310.40 examples/s]Map:  78%|  | 39271/50245 [00:17<00:04, 2203.68 examples/s]Map:  79%|  | 39511/50245 [00:17<00:04, 2253.38 examples/s]Map:  79%|  | 39740/50245 [00:17<00:04, 2260.21 examples/s]Map:  80%|  | 40020/50245 [00:17<00:04, 2108.66 examples/s]Map:  80%|  | 40260/50245 [00:17<00:04, 2183.23 examples/s]Map:  81%|  | 40514/50245 [00:17<00:04, 2278.56 examples/s]Map:  81%| | 40862/50245 [00:18<00:04, 2288.75 examples/s]Map:  82%| | 41152/50245 [00:18<00:04, 2163.82 examples/s]Map:  82%| | 41372/50245 [00:18<00:04, 2167.09 examples/s]Map:  83%| | 41599/50245 [00:18<00:03, 2193.21 examples/s]Map:  83%| | 41829/50245 [00:18<00:03, 2217.46 examples/Building eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
50245 [00:20<00:01, 2159.88 examples/s]Map:  92%|| 46350/50245 [00:20<00:01, 2195.43 examples/s]Map:  93%|| 46596/50245 [00:20<00:01, 2261.30 examples/s]Map:  93%|| 46837/50245 [00:20<00:01, 2299.17 examples/s]Map:  94%|| 47147/50245 [00:20<00:01, 2209.72 examples/s]Map:  94%|| 47471/50245 [00:20<00:01, 2190.12 examples/s]Map:  95%|| 47798/50245 [00:21<00:01, 1712.26 examples/s]Map:  96%|| 48000/50245 [00:21<00:01, 1739.02 examples/s]Map:  96%|| 48225/50245 [00:21<00:01, 1848.33 examples/s]Map:  96%|| 48478/50245 [00:21<00:00, 2008.03 examples/s]Map:  97%|| 48715/50245 [00:21<00:00, 2097.69 examples/s]Map:  97%|| 48949/50245 [00:21<00:00, 2160.03 examples/s]Map:  98%|/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
| 49243/50245 [00:21<00:00, 2083.45 examples/s]Map:  98%|| 49470/50245 [00:21<00:00, 2128.72 examples/s]Map:  99%|| 49710/50245 [00:22<00:00, 2198.68 examples/s]Map:  99%|| 49936/50245 [00:22<00:00, 2212.62 examples/s]Map: 100%|| 50220/50245 [00:22<00:00, 2086.51 examples/s]Map: 100%|| 50245/50245 [00:22<00:00, 2243.95 examples/s]
Building eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
s]Map:  84%| | 42117/50245 [00:18<00:03, 2107.01 examples/s]Map:  84%| | 42357/50245 [00:18<00:03, 2181.45 examples/s]Map:  85%| | 42600/50245 [00:18<00:03, 2243.80 examples/s]Map:  85%| | 42841/50245 [00:19<00:03, 2284.91 examples/s]Map:  86%| | 43129/50245 [00:19<00:03, 2142.08 examples/s]Map:  86%| | 43386/50245 [00:19<00:03, 2251.68 examples/s]Map:  87%| | 43630/50245 [00:19<00:02, 2301.95 examples/s]Map:  88%| | 43976/50245 [00:19<00:02, 2301.24 examples/s]Map:  88%| | 44265/50245 [00:19<00:02, 2168.28 examples/s]Map:  89%| | 44497/50245 [00:19<00:02, 2204.54 examples/s]Map:  89%| | 44736/50245 [00:19<00:02, 2249.67 examples/s]Map:  90%| | 44975/50245 [00:19<00:02, 2283.50 examples/s]Map:  90%| | 45262/50245 [00:20<00:02, 2144.22 examples/s]Map:  91%| | 45493/50245 [00:20<00:02, 2182.64 examples/s]Map:  91%| | 45724/50245 [00:20<00:02, 2215.04 examples/s]Map:  91%|| 45959/50245 [00:20<00:01, 2249.97 examples/s]Map:  92%|| 46256/50245 [00:20<00:01, 2146.17 examples/s]Map:  93%|| 46499/50245 [00:20<00:01, 2220.29 examples/s]Map:  93%|| 46732/50245 [00:20<00:01, 2247.58 examples/s]Map:  93%|| 46975/50245 [00:20<00:01, 2296.23 examples/s]Map:  94%|| 47271/50245 [00:21<00:01, 2170.89 examples/s]Map:  95%|| 47603/50245 [00:21<00:01, 2181.99 examples/s]Map:  95%|| 47911/50245 [00:21<00:01, 1701.25 examples/s]Map:  96%|| 48120/50245 [00:21<00:01, 1735.46 examples/s]Map:  96%|| 48370/50245 [00:21<00:00, 1902.09 examples/s]Map:  97%|| 48615/50245 [00:21<00:00, 2031.10 examples/s]Map:  97%|| 48850/50245 [00:21<00:00, 2109.70 examples/s]Map:  98%|| 49155/50245 [00:22<00:00, 2078.79 examples/s]Map:  98%|| 49379/50245 [00:22<00:00, 2116.90 examples/s]Map:  99%|| 49614/50245 [00:22<00:00, 2174.92 examples/s]Map:  99%|| 49858/50245 [00:22<00:00, 2236.16 examples/s]Map: 100%|| 50151/50245 [00:22<00:00, 2128.54 examples/s]Map: 100%|| 50245/50245 [00:22<00:00, 2229.22 examples/s]
Building eval loader...
Initializing model...
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py:479: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:18<04:20, 18.58s/it]Loading checkpoint shards:  13%|        | 2/15 [00:42<04:44, 21.86s/it]Loading checkpoint shards:  20%|        | 3/15 [01:05<04:26, 22.24s/it]Loading checkpoint shards:  27%|       | 4/15 [01:27<04:05, 22.33s/it]Loading checkpoint shards:  33%|      | 5/15 [01:55<04:01, 24.16s/it]Loading checkpoint shards:  40%|      | 6/15 [02:17<03:30, 23.42s/it]Loading checkpoint shards:  47%|     | 7/15 [02:40<03:07, 23.43s/it]Loading checkpoint shards:  53%|    | 8/15 [03:05<02:46, 23.81s/it]Loading checkpoint shards:  60%|    | 9/15 [03:31<02:26, 24.40s/it]Loading checkpoint shards:  67%|   | 10/15 [03:52<01:56, 23.34s/it]Loading checkpoint shards:  73%|  | 11/15 [04:13<01:31, 22.82s/it]ERROR:composer.cli.launcher:Rank 17 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:  73%|  | 11/15 [04:19<01:34, 23.55s/it]
Global rank 16 (PID 183498) exited with code 143
Global rank 17 (PID 183499) exited with code 1
----------Begin global rank 17 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 17 STDOUT----------
----------Begin global rank 17 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 243/50245 [00:00<00:20, 2399.74 examples/s]
Map:   1%|          | 501/50245 [00:00<00:19, 2491.11 examples/s]
Map:   2%|         | 758/50245 [00:00<00:19, 2519.88 examples/s]
Map:   2%|         | 1119/50245 [00:00<00:21, 2283.42 examples/s]
Map:   3%|         | 1468/50245 [00:00<00:21, 2292.58 examples/s]
Map:   3%|         | 1703/50245 [00:00<00:21, 2305.16 examples/s]
Map:   4%|         | 1943/50245 [00:00<00:20, 2330.92 examples/s]
Map:   5%|         | 2265/50245 [00:00<00:21, 2257.63 examples/s]
Map:   5%|         | 2499/50245 [00:01<00:20, 2276.91 examples/s]
Map:   5%|         | 2740/50245 [00:01<00:20, 2311.43 examples/s]
Map:   6%|         | 3037/50245 [00:01<00:21, 2187.43 examples/s]
Map:   7%|         | 3269/50245 [00:01<00:21, 2220.58 examples/s]
Map:   7%|         | 3521/50245 [00:01<00:20, 2296.52 examples/s]
Map:   8%|         | 3865/50245 [00:01<00:20, 2293.42 examples/s]
Map:   8%|         | 4168/50245 [00:01<00:20, 2195.03 examples/s]
Map:   9%|         | 4404/50245 [00:01<00:20, 2232.52 examples/s]
Map:   9%|         | 4651/50245 [00:02<00:19, 2293.12 examples/s]
Map:  10%|         | 4984/50245 [00:02<00:19, 2263.94 examples/s]
Map:  11%|         | 5302/50245 [00:02<00:20, 2212.62 examples/s]
Map:  11%|         | 5556/50245 [00:02<00:19, 2290.80 examples/s]
Map:  12%|        | 5797/50245 [00:02<00:19, 2319.90 examples/s]
Map:  12%|        | 6126/50245 [00:02<00:19, 2252.75 examples/s]
Map:  13%|        | 6371/50245 [00:02<00:19, 2297.91 examples/s]
Map:  13%|        | 6624/50245 [00:02<00:18, 2354.37 examples/s]
Map:  14%|        | 6879/50245 [00:02<00:18, 2405.56 examples/s]
Map:  14%|        | 7251/50245 [00:03<00:18, 2315.40 examples/s]
Map:  15%|        | 7493/50245 [00:03<00:18, 2336.51 examples/s]
Map:  16%|        | 7857/50245 [00:03<00:17, 2366.56 examples/s]
Map:  16%|        | 8183/50245 [00:03<00:18, 2298.00 examples/s]
Map:  17%|        | 8423/50245 [00:03<00:18, 2319.38 examples/s]
Map:  17%|        | 8674/50245 [00:03<00:17, 2365.42 examples/s]
Map:  18%|        | 8923/50245 [00:03<00:17, 2395.92 examples/s]
Map:  18%|        | 9246/50245 [00:04<00:17, 2292.80 examples/s]
Map:  19%|        | 9510/50245 [00:04<00:17, 2378.03 examples/s]
Map:  20%|        | 9864/50245 [00:04<00:17, 2368.16 examples/s]
Map:  20%|        | 10176/50245 [00:04<00:17, 2267.23 examples/s]
Map:  21%|        | 10409/50245 [00:04<00:17, 2280.40 examples/s]
Map:  21%|        | 10653/50245 [00:04<00:17, 2317.08 examples/s]
Map:  22%|       | 10909/50245 [00:04<00:16, 2378.59 examples/s]
Map:  22%|       | 11245/50245 [00:04<00:17, 2273.48 examples/s]
Map:  23%|       | 11488/50245 [00:04<00:16, 2308.73 examples/s]
Map:  23%|       | 11745/50245 [00:05<00:16, 2377.08 examples/s]
Map:  24%|       | 11987/50245 [00:05<00:16, 2387.26 examples/s]
Map:  24%|       | 12305/50245 [00:05<00:16, 2285.80 examples/s]
Map:  25%|       | 12675/50245 [00:05<00:16, 2344.44 examples/s]
Map:  26%|       | 12939/50245 [00:05<00:15, 2415.89 examples/s]
Map:  26%|       | 13265/50245 [00:05<00:15, 2328.07 examples/s]
Map:  27%|       | 13505/50245 [00:05<00:15, 2342.67 examples/s]
Map:  27%|       | 13748/50245 [00:05<00:15, 2364.14 examples/s]
Map:  28%|       | 13991/50245 [00:06<00:15, 2378.96 examples/s]
Map:  28%|       | 14303/50245 [00:06<00:15, 2264.58 examples/s]
Map:  29%|       | 14538/50245 [00:06<00:15, 2284.66 examples/s]
Map:  29%|       | 14786/50245 [00:06<00:15, 2335.87 examples/s]
Map:  30%|       | 15123/50245 [00:06<00:15, 2288.30 examples/s]
Map:  31%|       | 15364/50245 [00:06<00:15, 2317.45 examples/s]
Map:  31%|      | 15715/50245 [00:06<00:14, 2321.79 examples/s]
Map:  32%|      | 15955/50245 [00:06<00:14, 2337.61 examples/s]
Map:  32%|      | 16258/50245 [00:07<00:15, 2222.79 examples/s]
Map:  33%|      | 16515/50245 [00:07<00:14, 2307.84 examples/s]
Map:  33%|      | 16773/50245 [00:07<00:14, 2376.69 examples/s]
Map:  34%|      | 17125/50245 [00:07<00:14, 2279.27 examples/s]
Map:  35%|      | 17365/50245 [00:07<00:14, 2307.50 examples/s]
Map:  35%|      | 17617/50245 [00:07<00:13, 2359.49 examples/s]
Map:  36%|      | 17868/50245 [00:07<00:13, 2398.34 examples/s]
Map:  36%|      | 18185/50245 [00:07<00:14, 2285.08 examples/s]
Map:  37%|      | 18428/50245 [00:07<00:13, 2320.42 examples/s]
Map:  37%|      | 18674/50245 [00:08<00:13, 2354.77 examples/s]
Map:  38%|      | 18922/50245 [00:08<00:13, 2386.78 examples/s]
Map:  38%|      | 19256/50245 [00:08<00:13, 2286.12 examples/s]
Map:  39%|      | 19505/50245 [00:08<00:13, 2334.33 examples/s]
Map:  39%|      | 19746/50245 [00:08<00:12, 2351.05 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2271.83 examples/s]
Map:  40%|      | 20243/50245 [00:08<00:12, 2312.65 examples/s]
Map:  41%|      | 20497/50245 [00:08<00:12, 2372.43 examples/s]
Map:  41%|     | 20744/50245 [00:08<00:12, 2397.95 examples/s]
Map:  42%|     | 21047/50245 [00:09<00:12, 2249.23 examples/s]
Map:  42%|     | 21294/50245 [00:09<00:12, 2304.54 examples/s]
Map:  43%|     | 21538/50245 [00:09<00:12, 2339.77 examples/s]
Map:  43%|     | 21791/50245 [00:09<00:11, 2385.88 examples/s]
Map:  44%|     | 22125/50245 [00:09<00:12, 2258.93 examples/s]
Map:  45%|     | 22364/50245 [00:09<00:12, 2291.32 examples/s]
Map:  45%|     | 22610/50245 [00:09<00:11, 2333.50 examples/s]
Map:  46%|     | 22862/50245 [00:09<00:11, 2382.39 examples/s]
Map:  46%|     | 23169/50245 [00:10<00:12, 2252.68 examples/s]
Map:  47%|     | 23431/50245 [00:10<00:11, 2345.73 examples/s]
Map:  47%|     | 23675/50245 [00:10<00:11, 2370.53 examples/s]
Map:  48%|     | 23917/50245 [00:10<00:11, 2380.14 examples/s]
Map:  48%|     | 24221/50245 [00:10<00:11, 2210.17 examples/s]
Map:  49%|     | 24469/50245 [00:10<00:11, 2278.08 examples/s]
Map:  49%|     | 24716/50245 [00:10<00:10, 2324.90 examples/s]
Map:  50%|     | 24976/50245 [00:10<00:10, 2397.91 examples/s]
Map:  50%|     | 25295/50245 [00:10<00:10, 2293.67 examples/s]
Map:  51%|     | 25562/50245 [00:11<00:10, 2387.82 examples/s]
Map:  52%|    | 25915/50245 [00:11<00:10, 2370.26 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2252.21 examples/s]
Map:  53%|    | 26483/50245 [00:11<00:10, 2295.11 examples/s]
Map:  53%|    | 26737/50245 [00:11<00:09, 2354.17 examples/s]
Map:  54%|    | 26984/50245 [00:11<00:09, 2381.13 examples/s]
Map:  54%|    | 27300/50245 [00:11<00:10, 2277.21 examples/s]
Map:  55%|    | 27559/50245 [00:11<00:09, 2354.88 examples/s]
Map:  56%|    | 27929/50245 [00:12<00:09, 2391.16 examples/s]
Map:  56%|    | 28231/50245 [00:12<00:09, 2241.02 examples/s]
Map:  57%|    | 28489/50245 [00:12<00:09, 2318.22 examples/s]
Map:  57%|    | 28729/50245 [00:12<00:09, 2336.23 examples/s]
Map:  58%|    | 28978/50245 [00:12<00:08, 2374.03 examples/s]
Map:  58%|    | 29294/50245 [00:12<00:09, 2272.73 examples/s]
Map:  59%|    | 29529/50245 [00:12<00:09, 2285.57 examples/s]
Map:  59%|    | 29773/50245 [00:12<00:08, 2322.12 examples/s]
Map:  60%|    | 30120/50245 [00:13<00:09, 2213.19 examples/s]
Map:  60%|    | 30370/50245 [00:13<00:08, 2282.97 examples/s]
Map:  61%|    | 30622/50245 [00:13<00:08, 2342.78 examples/s]
Map:  61%|   | 30862/50245 [00:13<00:08, 2354.03 examples/s]
Map:  62%|   | 31175/50245 [00:13<00:08, 2253.29 examples/s]
Map:  63%|   | 31421/50245 [00:13<00:08, 2303.35 examples/s]
Map:  63%|   | 31675/50245 [00:13<00:07, 2363.40 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2248.11 examples/s]
Map:  64%|   | 32237/50245 [00:13<00:07, 2275.69 examples/s]
Map:  65%|   | 32485/50245 [00:14<00:07, 2329.39 examples/s]
Map:  65%|   | 32740/50245 [00:14<00:07, 2389.22 examples/s]
Map:  66%|   | 32988/50245 [00:14<00:07, 2413.76 examples/s]
Map:  66%|   | 33319/50245 [00:14<00:07, 2329.82 examples/s]
Map:  67%|   | 33562/50245 [00:14<00:07, 2352.22 examples/s]
Map:  67%|   | 33803/50245 [00:14<00:06, 2364.87 examples/s]
Map:  68%|   | 34128/50245 [00:14<00:07, 2273.36 examples/s]
Map:  68%|   | 34386/50245 [00:14<00:06, 2348.92 examples/s]
Map:  69%|   | 34638/50245 [00:14<00:06, 2389.44 examples/s]
Map:  69%|   | 34901/50245 [00:15<00:06, 2454.23 examples/s]
Map:  70%|   | 35244/50245 [00:15<00:06, 2327.11 examples/s]
Map:  71%|   | 35488/50245 [00:15<00:06, 2353.36 examples/s]
Map:  71%|   | 35728/50245 [00:15<00:06, 2363.59 examples/s]
Map:  72%|  | 35976/50245 [00:15<00:05, 2393.60 examples/s]
Map:  72%|  | 36293/50245 [00:15<00:06, 2285.29 examples/s]
Map:  73%|  | 36546/50245 [00:15<00:05, 2346.73 examples/s]
Map:  73%|  | 36795/50245 [00:15<00:05, 2383.90 examples/s]
Map:  74%|  | 37116/50245 [00:16<00:05, 2238.64 examples/s]
Map:  75%|  | 37471/50245 [00:16<00:05, 2280.65 examples/s]
Map:  75%|  | 37711/50245 [00:16<00:05, 2307.12 examples/s]
Map:  76%|  | 37955/50245 [00:16<00:05, 2339.45 examples/s]
Map:  76%|  | 38255/50245 [00:16<00:05, 2215.61 examples/s]
Map:  77%|  | 38502/50245 [00:16<00:05, 2276.94 examples/s]
Map:  77%|  | 38763/50245 [00:16<00:04, 2363.27 examples/s]
Map:  78%|  | 39126/50245 [00:16<00:04, 2306.26 examples/s]
Map:  78%|  | 39378/50245 [00:16<00:04, 2355.77 examples/s]
Map:  79%|  | 39618/50245 [00:17<00:04, 2366.04 examples/s]
Map:  79%|  | 39868/50245 [00:17<00:04, 2397.58 examples/s]
Map:  80%|  | 40179/50245 [00:17<00:04, 2272.30 examples/s]
Map:  81%|  | 40449/50245 [00:17<00:04, 2380.83 examples/s]
Map:  81%|  | 40821/50245 [00:17<00:03, 2413.69 examples/s]
Map:  82%| | 41130/50245 [00:17<00:03, 2290.04 examples/s]
Map:  83%| | 41484/50245 [00:17<00:03, 2310.36 examples/s]
Map:  83%| | 41728/50245 [00:17<00:03, 2338.50 examples/s]
Map:  84%| | 42023/50245 [00:18<00:03, 2211.36 examples/s]
Map:  84%| | 42274/50245 [00:18<00:03, 2281.30 examples/s]
Map:  85%| | 42523/50245 [00:18<00:03, 2328.60 examples/s]
Map:  85%| | 42772/50245 [00:18<00:03, 2369.91 examples/s]
Map:  86%| | 43116/50245 [00:18<00:03, 2240.92 examples/s]
Map:  86%| | 43374/50245 [00:18<00:02, 2323.53 examples/s]
Map:  87%| | 43620/50245 [00:18<00:02, 2355.67 examples/s]
Map:  87%| | 43964/50245 [00:18<00:02, 2330.57 examples/s]
Map:  88%| | 44258/50245 [00:19<00:02, 2201.10 examples/s]
Map:  89%| | 44492/50245 [00:19<00:02, 2233.31 examples/s]
Map:  89%| | 44736/50245 [00:19<00:02, 2285.31 examples/s]
Map:  90%| | 44978/50245 [00:19<00:02, 2318.45 examples/s]
Map:  90%| | 45268/50245 [00:19<00:02, 2173.79 examples/s]
Map:  91%| | 45502/50245 [00:19<00:02, 2214.49 examples/s]
Map:  91%| | 45737/50245 [00:19<00:02, 2247.04 examples/s]
Map:  92%|| 45982/50245 [00:19<00:01, 2300.91 examples/s]
Map:  92%|| 46282/50245 [00:20<00:01, 2188.10 examples/s]
Map:  93%|| 46530/50245 [00:20<00:01, 2262.44 examples/s]
Map:  93%|| 46872/50245 [00:20<00:01, 2264.23 examples/s]
Map:  94%|| 47183/50245 [00:20<00:01, 2195.09 examples/s]
Map:  95%|| 47518/50245 [00:20<00:01, 2201.89 examples/s]
Map:  95%|| 47800/50245 [00:20<00:01, 1698.05 examples/s]
Map:  96%|| 48000/50245 [00:20<00:01, 1733.04 examples/s]
Map:  96%|| 48250/50245 [00:21<00:01, 1897.02 examples/s]
Map:  97%|| 48508/50245 [00:21<00:00, 2053.90 examples/s]
Map:  97%|| 48824/50245 [00:21<00:00, 2009.15 examples/s]
Map:  98%|| 49131/50245 [00:21<00:00, 2018.59 examples/s]
Map:  98%|| 49355/50245 [00:21<00:00, 2066.92 examples/s]
Map:  99%|| 49587/50245 [00:21<00:00, 2127.09 examples/s]
Map:  99%|| 49833/50245 [00:21<00:00, 2209.31 examples/s]
Map: 100%|| 50124/50245 [00:21<00:00, 2109.46 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2282.97 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [17] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14d04292b4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14d0428f5434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14d06de948c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14d06de95572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14d06de955f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d06de54ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d06de54ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d06de54ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14d0438bac4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14d0438be901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14d0438c5a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14d0438c6e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14d0438c9aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14d0438d8a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14d06de492d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14d06de4d02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14d06de5be90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14d0824d9fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14d081d25285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14d0bb993cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 17 STDERR----------
Global rank 18 (PID 183500) exited with code 1
----------Begin global rank 18 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 18 STDOUT----------
----------Begin global rank 18 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 244/50245 [00:00<00:20, 2403.08 examples/s]
Map:   1%|          | 501/50245 [00:00<00:19, 2494.27 examples/s]
Map:   2%|         | 759/50245 [00:00<00:19, 2530.09 examples/s]
Map:   2%|         | 1118/50245 [00:00<00:21, 2275.80 examples/s]
Map:   3%|         | 1469/50245 [00:00<00:21, 2296.28 examples/s]
Map:   3%|         | 1706/50245 [00:00<00:20, 2314.95 examples/s]
Map:   4%|         | 1950/50245 [00:00<00:20, 2349.50 examples/s]
Map:   5%|         | 2273/50245 [00:00<00:21, 2273.36 examples/s]
Map:   5%|         | 2511/50245 [00:01<00:20, 2298.17 examples/s]
Map:   5%|         | 2753/50245 [00:01<00:20, 2330.90 examples/s]
Map:   6%|         | 3056/50245 [00:01<00:21, 2211.36 examples/s]
Map:   7%|         | 3288/50245 [00:01<00:20, 2237.26 examples/s]
Map:   7%|         | 3540/50245 [00:01<00:20, 2310.85 examples/s]
Map:   8%|         | 3876/50245 [00:01<00:20, 2279.80 examples/s]
Map:   8%|         | 4120/50245 [00:01<00:20, 2198.45 examples/s]
Map:   9%|         | 4356/50245 [00:01<00:20, 2236.43 examples/s]
Map:   9%|         | 4606/50245 [00:02<00:19, 2303.05 examples/s]
Map:  10%|         | 4950/50245 [00:02<00:19, 2293.78 examples/s]
Map:  10%|         | 5268/50245 [00:02<00:20, 2229.80 examples/s]
Map:  11%|         | 5522/50245 [00:02<00:19, 2304.96 examples/s]
Map:  11%|        | 5768/50245 [00:02<00:19, 2340.12 examples/s]
Map:  12%|        | 6127/50245 [00:02<00:19, 2277.38 examples/s]
Map:  13%|        | 6376/50245 [00:02<00:18, 2327.11 examples/s]
Map:  13%|        | 6630/50245 [00:02<00:18, 2380.92 examples/s]
Map:  14%|        | 6888/50245 [00:02<00:17, 2433.05 examples/s]
Map:  14%|        | 7252/50245 [00:03<00:18, 2334.99 examples/s]
Map:  15%|        | 7495/50245 [00:03<00:18, 2355.65 examples/s]
Map:  16%|        | 7864/50245 [00:03<00:17, 2388.71 examples/s]
Map:  16%|        | 8193/50245 [00:03<00:18, 2319.93 examples/s]
Map:  17%|        | 8435/50245 [00:03<00:17, 2341.17 examples/s]
Map:  17%|        | 8687/50245 [00:03<00:17, 2385.57 examples/s]
Map:  18%|        | 8941/50245 [00:03<00:17, 2423.27 examples/s]
Map:  18%|        | 9266/50245 [00:03<00:17, 2325.40 examples/s]
Map:  19%|        | 9531/50245 [00:04<00:16, 2405.50 examples/s]
Map:  20%|        | 9893/50245 [00:04<00:16, 2404.71 examples/s]
Map:  20%|        | 10249/50245 [00:04<00:17, 2293.71 examples/s]
Map:  21%|        | 10486/50245 [00:04<00:17, 2308.63 examples/s]
Map:  21%|       | 10743/50245 [00:04<00:16, 2371.36 examples/s]
Map:  22%|       | 10993/50245 [00:04<00:16, 2404.42 examples/s]
Map:  23%|       | 11309/50245 [00:04<00:16, 2293.03 examples/s]
Map:  23%|       | 11556/50245 [00:04<00:16, 2335.42 examples/s]
Map:  24%|       | 11811/50245 [00:05<00:16, 2391.57 examples/s]
Map:  24%|       | 12138/50245 [00:05<00:16, 2309.12 examples/s]
Map:  25%|       | 12379/50245 [00:05<00:16, 2332.41 examples/s]
Map:  25%|       | 12628/50245 [00:05<00:15, 2371.85 examples/s]
Map:  26%|       | 12897/50245 [00:05<00:15, 2458.65 examples/s]
Map:  26%|       | 13258/50245 [00:05<00:15, 2357.62 examples/s]
Map:  27%|       | 13500/50245 [00:05<00:15, 2372.35 examples/s]
Map:  27%|       | 13744/50245 [00:05<00:15, 2386.36 examples/s]
Map:  28%|       | 13989/50245 [00:05<00:15, 2402.28 examples/s]
Map:  28%|       | 14301/50245 [00:06<00:15, 2279.28 examples/s]
Map:  29%|       | 14539/50245 [00:06<00:15, 2303.97 examples/s]
Map:  29%|       | 14791/50245 [00:06<00:15, 2361.53 examples/s]
Map:  30%|       | 15123/50245 [00:06<00:15, 2302.03 examples/s]
Map:  31%|       | 15366/50245 [00:06<00:14, 2333.20 examples/s]
Map:  31%|      | 15724/50245 [00:06<00:14, 2343.55 examples/s]
Map:  32%|      | 15973/50245 [00:06<00:14, 2378.54 examples/s]
Map:  32%|      | 16284/50245 [00:06<00:14, 2265.16 examples/s]
Map:  33%|      | 16546/50245 [00:07<00:14, 2350.57 examples/s]
Map:  33%|      | 16806/50245 [00:07<00:13, 2414.81 examples/s]
Map:  34%|      | 17125/50245 [00:07<00:14, 2307.33 examples/s]
Map:  35%|      | 17367/50245 [00:07<00:14, 2332.80 examples/s]
Map:  35%|      | 17620/50245 [00:07<00:13, 2384.92 examples/s]
Map:  36%|      | 17875/50245 [00:07<00:13, 2425.16 examples/s]
Map:  36%|      | 18194/50245 [00:07<00:13, 2311.24 examples/s]
Map:  37%|      | 18442/50245 [00:07<00:13, 2353.27 examples/s]
Map:  37%|      | 18690/50245 [00:07<00:13, 2377.62 examples/s]
Map:  38%|      | 18944/50245 [00:08<00:12, 2420.86 examples/s]
Map:  38%|      | 19261/50245 [00:08<00:13, 2304.55 examples/s]
Map:  39%|      | 19512/50245 [00:08<00:13, 2356.10 examples/s]
Map:  39%|      | 19758/50245 [00:08<00:12, 2381.37 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2298.79 examples/s]
Map:  40%|      | 20245/50245 [00:08<00:12, 2337.82 examples/s]
Map:  41%|      | 20502/50245 [00:08<00:12, 2401.86 examples/s]
Map:  41%|     | 20753/50245 [00:08<00:12, 2429.59 examples/s]
Map:  42%|     | 21061/50245 [00:09<00:12, 2283.79 examples/s]
Map:  42%|     | 21312/50245 [00:09<00:12, 2336.48 examples/s]
Map:  43%|     | 21562/50245 [00:09<00:12, 2378.32 examples/s]
Map:  43%|     | 21813/50245 [00:09<00:11, 2411.89 examples/s]
Map:  44%|     | 22126/50245 [00:09<00:12, 2276.11 examples/s]
Map:  45%|     | 22368/50245 [00:09<00:12, 2310.13 examples/s]
Map:  45%|     | 22617/50245 [00:09<00:11, 2355.47 examples/s]
Map:  46%|     | 22874/50245 [00:09<00:11, 2411.24 examples/s]
Map:  46%|     | 23181/50245 [00:09<00:11, 2270.70 examples/s]
Map:  47%|     | 23444/50245 [00:10<00:11, 2363.66 examples/s]
Map:  47%|     | 23687/50245 [00:10<00:11, 2380.20 examples/s]
Map:  48%|     | 23931/50245 [00:10<00:10, 2395.36 examples/s]
Map:  48%|     | 24229/50245 [00:10<00:11, 2235.09 examples/s]
Map:  49%|     | 24476/50245 [00:10<00:11, 2292.20 examples/s]
Map:  49%|     | 24726/50245 [00:10<00:10, 2346.14 examples/s]
Map:  50%|     | 24985/50245 [00:10<00:10, 2413.75 examples/s]
Map:  50%|     | 25305/50245 [00:10<00:10, 2307.11 examples/s]
Map:  51%|     | 25576/50245 [00:10<00:10, 2409.45 examples/s]
Map:  52%|    | 25928/50245 [00:11<00:10, 2382.53 examples/s]
Map:  52%|    | 26241/50245 [00:11<00:10, 2269.37 examples/s]
Map:  53%|    | 26486/50245 [00:11<00:10, 2309.42 examples/s]
Map:  53%|    | 26744/50245 [00:11<00:09, 2375.76 examples/s]
Map:  54%|    | 26994/50245 [00:11<00:09, 2405.13 examples/s]
Map:  54%|    | 27314/50245 [00:11<00:09, 2298.86 examples/s]
Map:  55%|    | 27566/50245 [00:11<00:09, 2352.37 examples/s]
Map:  56%|    | 27927/50245 [00:11<00:09, 2366.42 examples/s]
Map:  56%|    | 28229/50245 [00:12<00:09, 2211.89 examples/s]
Map:  57%|    | 28482/50245 [00:12<00:09, 2284.47 examples/s]
Map:  57%|    | 28719/50245 [00:12<00:09, 2302.64 examples/s]
Map:  58%|    | 28965/50245 [00:12<00:09, 2340.16 examples/s]
Map:  58%|    | 29279/50245 [00:12<00:09, 2248.00 examples/s]
Map:  59%|    | 29513/50245 [00:12<00:09, 2269.77 examples/s]
Map:  59%|    | 29748/50245 [00:12<00:08, 2287.70 examples/s]
Map:  60%|    | 30044/50245 [00:12<00:09, 2173.00 examples/s]
Map:  60%|    | 30291/50245 [00:12<00:08, 2247.72 examples/s]
Map:  61%|    | 30535/50245 [00:13<00:08, 2297.15 examples/s]
Map:  61%|   | 30777/50245 [00:13<00:08, 2328.60 examples/s]
Map:  62%|   | 31124/50245 [00:13<00:08, 2231.71 examples/s]
Map:  62%|   | 31369/50245 [00:13<00:08, 2283.94 examples/s]
Map:  63%|   | 31612/50245 [00:13<00:08, 2322.00 examples/s]
Map:  63%|   | 31858/50245 [00:13<00:07, 2358.53 examples/s]
Map:  64%|   | 32151/50245 [00:13<00:08, 2203.77 examples/s]
Map:  64%|   | 32381/50245 [00:13<00:08, 2227.95 examples/s]
Map:  65%|   | 32641/50245 [00:14<00:07, 2326.08 examples/s]
Map:  65%|   | 32887/50245 [00:14<00:07, 2360.39 examples/s]
Map:  66%|   | 33132/50245 [00:14<00:07, 2259.32 examples/s]
Map:  66%|   | 33378/50245 [00:14<00:07, 2313.24 examples/s]
Map:  67%|   | 33620/50245 [00:14<00:07, 2339.98 examples/s]
Map:  67%|   | 33859/50245 [00:14<00:06, 2351.79 examples/s]
Map:  68%|   | 34175/50245 [00:14<00:07, 2252.02 examples/s]
Map:  69%|   | 34430/50245 [00:14<00:06, 2328.80 examples/s]
Map:  69%|   | 34680/50245 [00:14<00:06, 2371.58 examples/s]
Map:  70%|   | 34941/50245 [00:14<00:06, 2437.41 examples/s]
Map:  70%|   | 35256/50245 [00:15<00:06, 2305.23 examples/s]
Map:  71%|   | 35499/50245 [00:15<00:06, 2334.26 examples/s]
Map:  71%|  | 35852/50245 [00:15<00:06, 2336.20 examples/s]
Map:  72%|  | 36175/50245 [00:15<00:06, 2271.75 examples/s]
Map:  72%|  | 36419/50245 [00:15<00:05, 2310.62 examples/s]
Map:  73%|  | 36667/50245 [00:15<00:05, 2351.92 examples/s]
Map:  73%|  | 36911/50245 [00:15<00:05, 2373.74 examples/s]
Map:  74%|  | 37217/50245 [00:16<00:05, 2184.36 examples/s]
Map:  75%|  | 37464/50245 [00:16<00:05, 2253.86 examples/s]
Map:  75%|  | 37700/50245 [00:16<00:05, 2281.39 examples/s]
Map:  76%|  | 37943/50245 [00:16<00:05, 2319.67 examples/s]
Map:  76%|  | 38241/50245 [00:16<00:05, 2193.67 examples/s]
Map:  77%|  | 38485/50245 [00:16<00:05, 2250.89 examples/s]
Map:  77%|  | 38745/50245 [00:16<00:04, 2342.20 examples/s]
Map:  78%|  | 39000/50245 [00:16<00:04, 2260.69 examples/s]
Map:  78%|  | 39244/50245 [00:16<00:04, 2306.39 examples/s]
Map:  79%|  | 39494/50245 [00:16<00:04, 2357.21 examples/s]
Map:  79%|  | 39735/50245 [00:17<00:04, 2370.19 examples/s]
Map:  80%|  | 40021/50245 [00:17<00:04, 2192.11 examples/s]
Map:  80%|  | 40273/50245 [00:17<00:04, 2278.14 examples/s]
Map:  81%|  | 40538/50245 [00:17<00:04, 2377.28 examples/s]
Map:  81%|  | 40780/50245 [00:17<00:03, 2386.38 examples/s]
Map:  82%| | 41128/50245 [00:17<00:04, 2247.95 examples/s]
Map:  83%| | 41474/50245 [00:17<00:03, 2265.53 examples/s]
Map:  83%| | 41718/50245 [00:17<00:03, 2304.15 examples/s]
Map:  84%| | 42000/50245 [00:18<00:03, 2142.27 examples/s]
Map:  84%| | 42249/50245 [00:18<00:03, 2225.37 examples/s]
Map:  85%| | 42481/50245 [00:18<00:03, 2241.10 examples/s]
Map:  85%| | 42730/50245 [00:18<00:03, 2306.13 examples/s]
Map:  86%| | 43023/50245 [00:18<00:03, 2173.56 examples/s]
Map:  86%| | 43279/50245 [00:18<00:03, 2270.10 examples/s]
Map:  87%| | 43529/50245 [00:18<00:02, 2327.85 examples/s]
Map:  87%| | 43786/50245 [00:18<00:02, 2391.79 examples/s]
Map:  88%| | 44121/50245 [00:19<00:02, 2262.31 examples/s]
Map:  88%| | 44360/50245 [00:19<00:02, 2287.69 examples/s]
Map:  89%| | 44602/50245 [00:19<00:02, 2321.81 examples/s]
Map:  89%| | 44849/50245 [00:19<00:02, 2360.44 examples/s]
Map:  90%| | 45159/50245 [00:19<00:02, 2247.43 examples/s]
Map:  90%| | 45396/50245 [00:19<00:02, 2275.26 examples/s]
Map:  91%| | 45650/50245 [00:19<00:01, 2345.23 examples/s]
Map:  91%|| 45894/50245 [00:19<00:01, 2369.91 examples/s]
Map:  92%|| 46250/50245 [00:19<00:01, 2274.72 examples/s]
Map:  93%|| 46505/50245 [00:20<00:01, 2341.83 examples/s]
Map:  93%|| 46750/50245 [00:20<00:01, 2366.94 examples/s]
Map:  94%|| 47000/50245 [00:20<00:01, 2272.47 examples/s]
Map:  94%|| 47249/50245 [00:20<00:01, 2329.00 examples/s]
Map:  95%|| 47598/50245 [00:20<00:01, 2322.65 examples/s]
Map:  95%|| 47929/50245 [00:20<00:01, 1775.59 examples/s]
Map:  96%|| 48257/50245 [00:20<00:01, 1880.67 examples/s]
Map:  97%|| 48522/50245 [00:21<00:00, 2037.66 examples/s]
Map:  97%|| 48771/50245 [00:21<00:00, 2138.25 examples/s]
Map:  98%|| 49122/50245 [00:21<00:00, 2135.30 examples/s]
Map:  98%|| 49354/50245 [00:21<00:00, 2173.82 examples/s]
Map:  99%|| 49591/50245 [00:21<00:00, 2219.67 examples/s]
Map:  99%|| 49841/50245 [00:21<00:00, 2290.48 examples/s]
Map: 100%|| 50151/50245 [00:21<00:00, 2205.25 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2302.94 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [18] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x153c533c54d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x153c5338f434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x153c7e92e8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x153c7e92f572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x153c7e92f5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153c7e8eeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153c7e8eeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153c7e8eeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x153c54354c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x153c54358901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x153c5435fa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x153c54360e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x153c54363aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x153c54372a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x153c7e8e32d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x153c7e8e702a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x153c7e8f5e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x153c92f73fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x153c927bf285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x153ccc42dcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 18 STDERR----------
Global rank 19 (PID 183501) exited with code 1
----------Begin global rank 19 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 19 STDOUT----------
----------Begin global rank 19 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 166/50245 [00:00<00:30, 1636.85 examples/s]
Map:   1%|          | 418/50245 [00:00<00:23, 2150.93 examples/s]
Map:   1%|         | 682/50245 [00:00<00:20, 2365.69 examples/s]
ERROR:composer.cli.launcher:Global rank 16 (PID 183498) exited with code 143
Map:   2%|         | 935/50245 [00:00<00:20, 2428.22 examples/s]
Map:   2%|         | 1240/50245 [00:00<00:24, 1963.46 examples/s]
Map:   3%|         | 1476/50245 [00:00<00:23, 2070.72 examples/s]
Map:   3%|         | 1716/50245 [00:00<00:22, 2161.09 examples/s]
Map:   4%|         | 1962/50245 [00:00<00:21, 2245.83 examples/s]
Map:   5%|         | 2287/50245 [00:01<00:21, 2213.92 examples/s]
Map:   5%|         | 2529/50245 [00:01<00:21, 2265.60 examples/s]
Map:   6%|         | 2764/50245 [00:01<00:20, 2287.89 examples/s]
Map:   6%|         | 3000/50245 [00:01<00:21, 2189.09 examples/s]
Map:   6%|         | 3233/50245 [00:01<00:21, 2227.69 examples/s]
Map:   7%|         | 3492/50245 [00:01<00:20, 2327.94 examples/s]
Map:   8%|         | 3845/50245 [00:01<00:19, 2333.00 examples/s]
Map:   8%|         | 4150/50245 [00:01<00:20, 2224.81 examples/s]
Map:   9%|         | 4389/50245 [00:01<00:20, 2265.41 examples/s]
Map:   9%|         | 4641/50245 [00:02<00:19, 2330.74 examples/s]
Map:  10%|         | 4983/50245 [00:02<00:19, 2309.25 examples/s]
Map:  11%|         | 5309/50245 [00:02<00:19, 2261.42 examples/s]
Map:  11%|         | 5570/50245 [00:02<00:19, 2341.89 examples/s]
Map:  12%|        | 5813/50245 [00:02<00:18, 2359.93 examples/s]
Map:  12%|        | 6149/50245 [00:02<00:19, 2313.34 examples/s]
Map:  13%|        | 6402/50245 [00:02<00:18, 2364.76 examples/s]
Map:  13%|        | 6658/50245 [00:02<00:18, 2414.80 examples/s]
Map:  14%|        | 6922/50245 [00:03<00:17, 2474.53 examples/s]
Map:  14%|        | 7252/50245 [00:03<00:18, 2358.23 examples/s]
Map:  15%|        | 7497/50245 [00:03<00:17, 2381.07 examples/s]
Map:  16%|        | 7870/50245 [00:03<00:17, 2411.93 examples/s]
Map:  16%|        | 8130/50245 [00:03<00:18, 2333.32 examples/s]
Map:  17%|        | 8376/50245 [00:03<00:17, 2362.78 examples/s]
Map:  17%|        | 8632/50245 [00:03<00:17, 2412.93 examples/s]
Map:  18%|        | 8889/50245 [00:03<00:16, 2453.77 examples/s]
Map:  18%|        | 9253/50245 [00:04<00:17, 2370.25 examples/s]
Map:  19%|        | 9520/50245 [00:04<00:16, 2445.58 examples/s]
Map:  20%|        | 9886/50245 [00:04<00:16, 2438.09 examples/s]
Map:  20%|        | 10247/50245 [00:04<00:17, 2323.36 examples/s]
Map:  21%|        | 10487/50245 [00:04<00:17, 2338.03 examples/s]
Map:  21%|       | 10749/50245 [00:04<00:16, 2405.08 examples/s]
Map:  22%|       | 11000/50245 [00:04<00:16, 2310.13 examples/s]
Map:  22%|       | 11250/50245 [00:04<00:16, 2356.90 examples/s]
Map:  23%|       | 11499/50245 [00:04<00:16, 2386.94 examples/s]
Map:  23%|       | 11762/50245 [00:05<00:15, 2452.64 examples/s]
Map:  24%|       | 12134/50245 [00:05<00:16, 2358.66 examples/s]
Map:  25%|       | 12378/50245 [00:05<00:15, 2377.89 examples/s]
Map:  25%|       | 12632/50245 [00:05<00:15, 2417.91 examples/s]
Map:  26%|       | 12907/50245 [00:05<00:14, 2505.73 examples/s]
Map:  26%|       | 13256/50245 [00:05<00:15, 2387.72 examples/s]
Map:  27%|       | 13502/50245 [00:05<00:15, 2405.65 examples/s]
Map:  27%|       | 13749/50245 [00:05<00:15, 2420.54 examples/s]
Map:  28%|       | 14000/50245 [00:06<00:15, 2309.06 examples/s]
Map:  28%|       | 14244/50245 [00:06<00:15, 2340.98 examples/s]
Map:  29%|       | 14487/50245 [00:06<00:15, 2365.24 examples/s]
Map:  29%|       | 14745/50245 [00:06<00:14, 2422.49 examples/s]
Map:  30%|       | 15000/50245 [00:06<00:15, 2345.90 examples/s]
Map:  30%|       | 15248/50245 [00:06<00:14, 2379.84 examples/s]
Map:  31%|       | 15607/50245 [00:06<00:14, 2379.38 examples/s]
Map:  32%|      | 15863/50245 [00:06<00:14, 2424.15 examples/s]
Map:  32%|      | 16180/50245 [00:06<00:14, 2308.97 examples/s]
Map:  33%|      | 16424/50245 [00:07<00:14, 2338.96 examples/s]
Map:  33%|      | 16702/50245 [00:07<00:13, 2455.96 examples/s]
Map:  34%|      | 16959/50245 [00:07<00:13, 2485.76 examples/s]
Map:  34%|      | 17284/50245 [00:07<00:13, 2362.85 examples/s]
Map:  35%|      | 17535/50245 [00:07<00:13, 2395.77 examples/s]
Map:  35%|      | 17798/50245 [00:07<00:13, 2456.97 examples/s]
Map:  36%|      | 18131/50245 [00:07<00:13, 2349.68 examples/s]
Map:  37%|      | 18379/50245 [00:07<00:13, 2381.09 examples/s]
Map:  37%|      | 18637/50245 [00:07<00:13, 2430.93 examples/s]
Map:  38%|      | 18890/50245 [00:08<00:12, 2457.31 examples/s]
Map:  38%|      | 19257/50245 [00:08<00:13, 2350.14 examples/s]
Map:  39%|      | 19512/50245 [00:08<00:12, 2399.28 examples/s]
Map:  39%|      | 19761/50245 [00:08<00:12, 2421.51 examples/s]
Map:  40%|      | 20119/50245 [00:08<00:12, 2345.63 examples/s]
Map:  41%|      | 20379/50245 [00:08<00:12, 2405.31 examples/s]
Map:  41%|      | 20643/50245 [00:08<00:12, 2465.83 examples/s]
Map:  42%|     | 21000/50245 [00:08<00:12, 2321.05 examples/s]
Map:  42%|     | 21256/50245 [00:09<00:12, 2377.48 examples/s]
Map:  43%|     | 21505/50245 [00:09<00:11, 2404.89 examples/s]
Map:  43%|     | 21764/50245 [00:09<00:11, 2452.19 examples/s]
Map:  44%|     | 22128/50245 [00:09<00:12, 2332.34 examples/s]
Map:  45%|     | 22372/50245 [00:09<00:11, 2355.26 examples/s]
Map:  45%|     | 22625/50245 [00:09<00:11, 2398.47 examples/s]
Map:  46%|     | 22883/50245 [00:09<00:11, 2445.09 examples/s]
Map:  46%|     | 23243/50245 [00:09<00:11, 2307.04 examples/s]
Map:  47%|     | 23508/50245 [00:09<00:11, 2392.23 examples/s]
Map:  48%|     | 23871/50245 [00:10<00:11, 2397.08 examples/s]
Map:  48%|     | 24121/50245 [00:10<00:11, 2290.71 examples/s]
Map:  48%|     | 24362/50245 [00:10<00:11, 2319.83 examples/s]
Map:  49%|     | 24731/50245 [00:10<00:10, 2365.36 examples/s]
Map:  50%|     | 24992/50245 [00:10<00:10, 2422.83 examples/s]
Map:  50%|     | 25320/50245 [00:10<00:10, 2338.59 examples/s]
Map:  51%|     | 25592/50245 [00:10<00:10, 2433.18 examples/s]
Map:  52%|    | 25950/50245 [00:11<00:10, 2415.10 examples/s]
Map:  52%|    | 26265/50245 [00:11<00:10, 2306.60 examples/s]
Map:  53%|    | 26511/50245 [00:11<00:10, 2343.05 examples/s]
Map:  53%|    | 26771/50245 [00:11<00:09, 2403.70 examples/s]
Map:  54%|    | 27113/50245 [00:11<00:10, 2284.71 examples/s]
Map:  55%|    | 27393/50245 [00:11<00:09, 2406.65 examples/s]
Map:  55%|    | 27645/50245 [00:11<00:09, 2434.34 examples/s]
Map:  56%|    | 27901/50245 [00:11<00:09, 2465.76 examples/s]
Map:  56%|    | 28239/50245 [00:11<00:09, 2304.05 examples/s]
Map:  57%|    | 28503/50245 [00:12<00:09, 2386.97 examples/s]
Map:  57%|    | 28751/50245 [00:12<00:08, 2409.21 examples/s]
Map:  58%|    | 29000/50245 [00:12<00:09, 2290.40 examples/s]
Map:  58%|    | 29259/50245 [00:12<00:08, 2366.67 examples/s]
Map:  59%|    | 29501/50245 [00:12<00:08, 2379.72 examples/s]
Map:  59%|    | 29748/50245 [00:12<00:08, 2402.25 examples/s]
Map:  60%|    | 30057/50245 [00:12<00:08, 2271.62 examples/s]
Map:  60%|    | 30312/50245 [00:12<00:08, 2344.32 examples/s]
Map:  61%|    | 30561/50245 [00:12<00:08, 2380.89 examples/s]
Map:  61%|   | 30819/50245 [00:13<00:08, 2427.00 examples/s]
Map:  62%|   | 31136/50245 [00:13<00:08, 2307.88 examples/s]
Map:  62%|   | 31386/50245 [00:13<00:08, 2351.93 examples/s]
Map:  63%|   | 31647/50245 [00:13<00:07, 2418.24 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:07, 2311.75 examples/s]
Map:  64%|   | 32242/50245 [00:13<00:07, 2338.03 examples/s]
Map:  65%|   | 32496/50245 [00:13<00:07, 2389.86 examples/s]
Map:  65%|   | 32752/50245 [00:13<00:07, 2434.79 examples/s]
Map:  66%|   | 33000/50245 [00:14<00:07, 2320.19 examples/s]
Map:  66%|   | 33261/50245 [00:14<00:07, 2395.64 examples/s]
Map:  67%|   | 33520/50245 [00:14<00:06, 2448.83 examples/s]
Map:  67%|   | 33893/50245 [00:14<00:06, 2457.34 examples/s]
Map:  68%|   | 34268/50245 [00:14<00:06, 2375.29 examples/s]
Map:  69%|   | 34530/50245 [00:14<00:06, 2432.14 examples/s]
Map:  69%|   | 34782/50245 [00:14<00:06, 2453.40 examples/s]
Map:  70%|   | 35126/50245 [00:14<00:06, 2391.77 examples/s]
Map:  70%|   | 35377/50245 [00:14<00:06, 2416.54 examples/s]
Map:  71%|   | 35632/50245 [00:15<00:05, 2448.38 examples/s]
Map:  72%|  | 36000/50245 [00:15<00:06, 2339.21 examples/s]
Map:  72%|  | 36259/50245 [00:15<00:05, 2398.27 examples/s]
Map:  73%|  | 36519/50245 [00:15<00:05, 2447.84 examples/s]
Map:  73%|  | 36770/50245 [00:15<00:05, 2462.49 examples/s]
Map:  74%|  | 37119/50245 [00:15<00:05, 2319.59 examples/s]
Map:  75%|  | 37484/50245 [00:15<00:05, 2353.27 examples/s]
Map:  75%|  | 37728/50245 [00:15<00:05, 2372.60 examples/s]
Map:  76%|  | 37979/50245 [00:16<00:05, 2403.30 examples/s]
Map:  76%|  | 38291/50245 [00:16<00:05, 2281.67 examples/s]
Map:  77%|  | 38551/50245 [00:16<00:04, 2358.88 examples/s]
Map:  77%|  | 38812/50245 [00:16<00:04, 2424.62 examples/s]
Map:  78%|  | 39154/50245 [00:16<00:04, 2369.43 examples/s]
Map:  78%|  | 39414/50245 [00:16<00:04, 2424.73 examples/s]
Map:  79%|  | 39784/50245 [00:16<00:04, 2437.10 examples/s]
Map:  80%|  | 40126/50245 [00:16<00:04, 2329.69 examples/s]
Map:  80%|  | 40398/50245 [00:17<00:04, 2420.49 examples/s]
Map:  81%|  | 40662/50245 [00:17<00:03, 2471.53 examples/s]
Map:  82%| | 41000/50245 [00:17<00:03, 2342.38 examples/s]
Map:  82%| | 41246/50245 [00:17<00:03, 2366.81 examples/s]
Map:  83%| | 41500/50245 [00:17<00:03, 2408.72 examples/s]
Map:  83%| | 41751/50245 [00:17<00:03, 2432.43 examples/s]
Map:  84%| | 42058/50245 [00:17<00:03, 2287.05 examples/s]
Map:  84%| | 42317/50245 [00:17<00:03, 2360.78 examples/s]
Map:  85%| | 42579/50245 [00:17<00:03, 2428.98 examples/s]
Map:  85%| | 42832/50245 [00:18<00:03, 2454.63 examples/s]
Map:  86%| | 43143/50245 [00:18<00:03, 2309.19 examples/s]
Map:  86%| | 43419/50245 [00:18<00:02, 2426.17 examples/s]
Map:  87%| | 43680/50245 [00:18<00:02, 2474.40 examples/s]
Map:  87%| | 43932/50245 [00:18<00:02, 2483.31 examples/s]
Map:  88%| | 44249/50245 [00:18<00:02, 2336.70 examples/s]
Map:  89%| | 44500/50245 [00:18<00:02, 2380.13 examples/s]
Map:  89%| | 44760/50245 [00:18<00:02, 2434.92 examples/s]
Map:  90%| | 45121/50245 [00:19<00:02, 2340.22 examples/s]
Map:  90%| | 45365/50245 [00:19<00:02, 2359.93 examples/s]
Map:  91%| | 45618/50245 [00:19<00:01, 2402.11 examples/s]
Map:  91%|| 45871/50245 [00:19<00:01, 2433.30 examples/s]
Map:  92%|| 46125/50245 [00:19<00:01, 2310.59 examples/s]
Map:  92%|| 46371/50245 [00:19<00:01, 2345.33 examples/s]
Map:  93%|| 46642/50245 [00:19<00:01, 2445.27 examples/s]
Map:  93%|| 46897/50245 [00:19<00:01, 2475.00 examples/s]
Map:  94%|| 47250/50245 [00:19<00:01, 2343.08 examples/s]
Map:  95%|| 47610/50245 [00:20<00:01, 2358.97 examples/s]
Map:  95%|| 47933/50245 [00:20<00:01, 1830.72 examples/s]
Map:  96%|| 48262/50245 [00:20<00:01, 1925.88 examples/s]
Map:  97%|| 48527/50245 [00:20<00:00, 2071.52 examples/s]
Map:  97%|| 48780/50245 [00:20<00:00, 2174.03 examples/s]
Map:  98%|| 49125/50245 [00:20<00:00, 2158.12 examples/s]
Map:  98%|| 49361/50245 [00:20<00:00, 2201.27 examples/s]
Map:  99%|| 49606/50245 [00:21<00:00, 2260.47 examples/s]
Map:  99%|| 49858/50245 [00:21<00:00, 2322.45 examples/s]
Map: 100%|| 50174/50245 [00:21<00:00, 2241.45 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2349.83 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:04, 10191.21 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 10222.10 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 10327.11 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 10394.75 examples/s]
Filter:  20%|        | 10000/50245 [00:00<00:03, 10432.41 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 10429.91 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 10532.49 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 10450.11 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 10482.66 examples/s]
Filter:  40%|      | 20000/50245 [00:01<00:02, 10555.01 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 10514.73 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 10484.02 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 10500.05 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 10517.64 examples/s]
Filter:  60%|    | 30000/50245 [00:02<00:01, 10448.88 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 10507.46 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 10519.41 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 10554.65 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 10498.90 examples/s]
Filter:  80%|  | 40000/50245 [00:03<00:00, 10520.78 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 10516.97 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 10604.13 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 10565.05 examples/s]
Filter:  96%|| 48000/50245 [00:04<00:00, 10524.81 examples/s]
Filter: 100%|| 50000/50245 [00:04<00:00, 10576.74 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10485.63 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:06, 7376.43 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 8458.70 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 8899.53 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:05, 9144.66 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9235.68 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9371.80 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9468.54 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9490.93 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9531.46 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9536.24 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9568.07 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9586.69 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9674.51 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9651.83 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9651.61 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9588.89 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9635.95 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9587.91 examples/s]
Filter:  38%|      | 19000/50245 [00:02<00:03, 9642.00 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9688.11 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9660.92 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9631.92 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9608.72 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9593.06 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9560.88 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9605.12 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9562.07 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 9608.07 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9578.04 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9538.85 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9597.49 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9612.73 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9642.25 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9632.25 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9732.50 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9677.82 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9698.45 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 9588.57 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9620.34 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9597.37 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9605.40 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9522.26 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9590.42 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9702.32 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9682.77 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9629.99 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 9647.47 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9568.27 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9688.10 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9623.52 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9530.22 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [19] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14df6feb54d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14df6fe7f434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14df9b41e8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14df9b41f572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14df9b41f5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14df9b3deac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14df9b3deac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14df9b3deac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14df70e44c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14df70e48901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14df70e4fa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14df70e50e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14df70e53aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14df70e62a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14df9b3d32d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14df9b3d702a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14df9b3e5e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14dfafa63fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14dfaf2af285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14dfe8f1dcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 19 STDERR----------
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:14<03:17, 14.08s/it]Loading checkpoint shards:  13%|        | 2/15 [00:37<04:12, 19.41s/it]Loading checkpoint shards:  20%|        | 3/15 [00:59<04:10, 20.89s/it]Loading checkpoint shards:  27%|       | 4/15 [01:22<03:56, 21.51s/it]Loading checkpoint shards:  33%|      | 5/15 [01:49<03:56, 23.65s/it]Loading checkpoint shards:  40%|      | 6/15 [02:11<03:27, 23.08s/it]Loading checkpoint shards:  47%|     | 7/15 [02:35<03:05, 23.20s/it]Loading checkpoint shards:  53%|    | 8/15 [02:59<02:45, 23.67s/it]Loading checkpoint shards:  60%|    | 9/15 [03:25<02:25, 24.30s/it]Loading checkpoint shards:  67%|   | 10/15 [03:46<01:56, 23.29s/it]Loading checkpoint shards:  73%|  | 11/15 [04:08<01:31, 22.77s/it]ERROR:composer.cli.launcher:Rank 15 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:18<04:21, 18.65s/it]Loading checkpoint shards:  13%|        | 2/15 [00:41<04:36, 21.29s/it]Loading checkpoint shards:  20%|        | 3/15 [01:04<04:22, 21.90s/it]Loading checkpoint shards:  27%|       | 4/15 [01:27<04:04, 22.25s/it]Loading checkpoint shards:  33%|      | 5/15 [01:54<04:00, 24.01s/it]Loading checkpoint shards:  40%|      | 6/15 [02:16<03:29, 23.32s/it]Loading checkpoint shards:  47%|     | 7/15 [02:39<03:07, 23.40s/it]Loading checkpoint shards:  53%|    | 8/15 [03:04<02:46, 23.78s/it]Loading checkpoint shards:  60%|    | 9/15 [03:30<02:26, 24.37s/it]Loading checkpoint shards:  67%|   | 10/15 [03:51<01:56, 23.34s/it]Loading checkpoint shards:  73%|  | 11/15 [04:12<01:31, 22.81s/it]ERROR:composer.cli.launcher:Rank 1 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:20<04:52, 20.87s/it]Loading checkpoint shards:  13%|        | 2/15 [00:44<04:48, 22.20s/it]Loading checkpoint shards:  20%|        | 3/15 [01:06<04:28, 22.40s/it]Loading checkpoint shards:  27%|       | 4/15 [01:29<04:07, 22.52s/it]Loading checkpoint shards:  33%|      | 5/15 [01:56<04:02, 24.21s/it]Loading checkpoint shards:  40%|      | 6/15 [02:18<03:31, 23.46s/it]Loading checkpoint shards:  47%|     | 7/15 [02:41<03:07, 23.44s/it]Loading checkpoint shards:  53%|    | 8/15 [03:06<02:47, 23.86s/it]Loading checkpoint shards:  60%|    | 9/15 [03:32<02:26, 24.42s/it]Loading checkpoint shards:  67%|   | 10/15 [03:53<01:56, 23.37s/it]Loading checkpoint shards:  73%|  | 11/15 [04:14<01:31, 22.83s/it]ERROR:composer.cli.launcher:Rank 6 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:22<05:16, 22.60s/it]Loading checkpoint shards:  13%|        | 2/15 [00:40<04:20, 20.02s/it]Loading checkpoint shards:  20%|        | 3/15 [01:02<04:11, 20.99s/it]Loading checkpoint shards:  27%|       | 4/15 [01:23<03:50, 20.92s/it]Loading checkpoint shards:  33%|      | 5/15 [01:47<03:37, 21.79s/it]Loading checkpoint shards:  40%|      | 6/15 [02:02<02:55, 19.49s/it]Loading checkpoint shards:  47%|     | 7/15 [02:25<02:46, 20.77s/it]Loading checkpoint shards:  53%|    | 8/15 [02:50<02:34, 22.02s/it]Loading checkpoint shards:  60%|    | 9/15 [03:15<02:19, 23.17s/it]Loading checkpoint shards:  67%|   | 10/15 [03:36<01:52, 22.51s/it]Loading checkpoint shards:  73%|  | 11/15 [03:58<01:28, 22.23s/it]ERROR:composer.cli.launcher:Rank 31 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:15<03:33, 15.23s/it]Loading checkpoint shards:  13%|        | 2/15 [00:38<04:18, 19.87s/it]Loading checkpoint shards:  20%|        | 3/15 [01:01<04:15, 21.27s/it]Loading checkpoint shards:  27%|       | 4/15 [01:23<03:57, 21.62s/it]Loading checkpoint shards:  33%|      | 5/15 [01:50<03:57, 23.71s/it]Loading checkpoint shards:  40%|      | 6/15 [02:12<03:28, 23.13s/it]Loading checkpoint shards:  47%|     | 7/15 [02:36<03:05, 23.23s/it]Loading checkpoint shards:  53%|    | 8/15 [03:01<02:45, 23.70s/it]Loading checkpoint shards:  60%|    | 9/15 [03:26<02:25, 24.32s/it]Loading checkpoint shards:  67%|   | 10/15 [03:47<01:56, 23.31s/it]Loading checkpoint shards:  73%|  | 11/15 [04:09<01:31, 22.78s/it]ERROR:composer.cli.launcher:Rank 25 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:23<05:35, 23.95s/it]Loading checkpoint shards:  13%|        | 2/15 [00:48<05:14, 24.18s/it]Loading checkpoint shards:  20%|        | 3/15 [01:10<04:39, 23.26s/it]Loading checkpoint shards:  27%|       | 4/15 [01:31<04:05, 22.32s/it]Loading checkpoint shards:  33%|      | 5/15 [01:54<03:46, 22.67s/it]Loading checkpoint shards:  40%|      | 6/15 [02:09<03:00, 20.08s/it]Loading checkpoint shards:  47%|     | 7/15 [02:33<02:49, 21.16s/it]Loading checkpoint shards:  53%|    | 8/15 [02:57<02:35, 22.28s/it]Loading checkpoint shards:  60%|    | 9/15 [03:23<02:20, 23.35s/it]Loading checkpoint shards:  67%|   | 10/15 [03:44<01:53, 22.63s/it]Loading checkpoint shards:  73%|  | 11/15 [04:06<01:29, 22.32s/it]ERROR:composer.cli.launcher:Rank 21 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
srun: error: lrdn0224: task 4: Exited with exit code 143
Loading checkpoint shards:  73%|  | 11/15 [04:20<01:34, 23.67s/it]
Loading checkpoint shards:  73%|  | 11/15 [04:23<01:35, 23.97s/it]
Loading checkpoint shards:  73%|  | 11/15 [04:12<01:31, 22.99s/it]
Loading checkpoint shards:  73%|  | 11/15 [04:22<01:35, 23.86s/it]
Loading checkpoint shards:  73%|  | 11/15 [04:27<01:37, 24.28s/it]
Loading checkpoint shards:  73%|  | 11/15 [04:29<01:37, 24.48s/it]
Loading checkpoint shards:   0%|          | 0/15 [00:00<?, ?it/s]Loading checkpoint shards:   7%|         | 1/15 [00:14<03:17, 14.08s/it]Loading checkpoint shards:  13%|        | 2/15 [00:37<04:12, 19.41s/it]Loading checkpoint shards:  20%|        | 3/15 [00:59<04:10, 20.88s/it]Loading checkpoint shards:  27%|       | 4/15 [01:22<03:57, 21.63s/it]Loading checkpoint shards:  33%|      | 5/15 [01:49<03:56, 23.61s/it]Loading checkpoint shards:  40%|      | 6/15 [02:11<03:27, 23.06s/it]Loading checkpoint shards:  47%|     | 7/15 [02:35<03:05, 23.18s/it]Loading checkpoint shards:  53%|    | 8/15 [02:59<02:45, 23.66s/it]Loading checkpoint shards:  60%|    | 9/15 [03:25<02:25, 24.30s/it]Loading checkpoint shards:  67%|   | 10/15 [03:46<01:56, 23.30s/it]Loading checkpoint shards:  73%|  | 11/15 [04:08<01:31, 22.78s/it]ERROR:composer.cli.launcher:Rank 9 crashed with exit code 1.
Waiting up to 30 seconds for all training processes to terminate. Press Ctrl-C to exit immediately.
Loading checkpoint shards:  73%|  | 11/15 [04:26<01:37, 24.26s/it]
Global rank 0 (PID 173520) exited with code 143
Global rank 1 (PID 173521) exited with code 1
----------Begin global rank 1 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 1 STDOUT----------
----------Begin global rank 1 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 244/50245 [00:00<00:20, 2419.56 examples/s]
Map:   1%|          | 501/50245 [00:00<00:19, 2504.68 examples/s]
Map:   2%|         | 759/50245 [00:00<00:19, 2534.36 examples/s]
Map:   2%|         | 1121/50245 [00:00<00:21, 2307.46 examples/s]
Map:   3%|         | 1474/50245 [00:00<00:21, 2320.20 examples/s]
Map:   3%|         | 1712/50245 [00:00<00:20, 2334.83 examples/s]
Map:   4%|         | 1964/50245 [00:00<00:20, 2380.71 examples/s]
Map:   5%|         | 2285/50245 [00:00<00:20, 2287.49 examples/s]
Map:   5%|         | 2522/50245 [00:01<00:20, 2305.81 examples/s]
Map:   5%|         | 2762/50245 [00:01<00:20, 2329.39 examples/s]
Map:   6%|         | 3000/50245 [00:01<00:21, 2212.09 examples/s]
Map:   6%|         | 3230/50245 [00:01<00:21, 2235.89 examples/s]
Map:   7%|         | 3486/50245 [00:01<00:20, 2320.81 examples/s]
Map:   8%|         | 3837/50245 [00:01<00:19, 2320.65 examples/s]
Map:   8%|         | 4143/50245 [00:01<00:20, 2221.23 examples/s]
Map:   9%|         | 4379/50245 [00:01<00:20, 2251.30 examples/s]
Map:   9%|         | 4628/50245 [00:02<00:19, 2311.92 examples/s]
Map:  10%|         | 4971/50245 [00:02<00:19, 2299.13 examples/s]
Map:  11%|         | 5290/50245 [00:02<00:20, 2236.16 examples/s]
Map:  11%|         | 5545/50245 [00:02<00:19, 2309.59 examples/s]
Map:  12%|        | 5790/50245 [00:02<00:18, 2341.97 examples/s]
Map:  12%|        | 6126/50245 [00:02<00:19, 2275.63 examples/s]
Map:  13%|        | 6372/50245 [00:02<00:18, 2317.78 examples/s]
Map:  13%|        | 6625/50245 [00:02<00:18, 2371.84 examples/s]
Map:  14%|        | 6883/50245 [00:02<00:17, 2427.59 examples/s]
Map:  14%|        | 7254/50245 [00:03<00:18, 2341.31 examples/s]
Map:  15%|        | 7497/50245 [00:03<00:18, 2360.86 examples/s]
Map:  16%|        | 7866/50245 [00:03<00:17, 2391.51 examples/s]
Map:  16%|        | 8197/50245 [00:03<00:18, 2326.90 examples/s]
Map:  17%|        | 8437/50245 [00:03<00:17, 2342.02 examples/s]
Map:  17%|        | 8687/50245 [00:03<00:17, 2380.31 examples/s]
Map:  18%|        | 8942/50245 [00:03<00:17, 2419.59 examples/s]
Map:  18%|        | 9269/50245 [00:03<00:17, 2329.51 examples/s]
Map:  19%|        | 9532/50245 [00:04<00:16, 2404.84 examples/s]
Map:  20%|        | 9893/50245 [00:04<00:16, 2401.80 examples/s]
Map:  20%|        | 10249/50245 [00:04<00:17, 2302.60 examples/s]
Map:  21%|        | 10487/50245 [00:04<00:17, 2315.47 examples/s]
Map:  21%|       | 10744/50245 [00:04<00:16, 2376.62 examples/s]
Map:  22%|       | 10995/50245 [00:04<00:16, 2408.87 examples/s]
Map:  23%|       | 11311/50245 [00:04<00:16, 2297.50 examples/s]
Map:  23%|       | 11558/50245 [00:04<00:16, 2338.88 examples/s]
Map:  24%|       | 11814/50245 [00:05<00:16, 2395.47 examples/s]
Map:  24%|       | 12142/50245 [00:05<00:16, 2315.95 examples/s]
Map:  25%|       | 12383/50245 [00:05<00:16, 2337.99 examples/s]
Map:  25%|       | 12635/50245 [00:05<00:15, 2383.88 examples/s]
Map:  26%|       | 12905/50245 [00:05<00:15, 2468.61 examples/s]
Map:  26%|       | 13260/50245 [00:05<00:15, 2374.65 examples/s]
Map:  27%|       | 13503/50245 [00:05<00:15, 2383.98 examples/s]
Map:  27%|       | 13747/50245 [00:05<00:15, 2395.33 examples/s]
Map:  28%|       | 13996/50245 [00:05<00:14, 2417.64 examples/s]
Map:  28%|       | 14308/50245 [00:06<00:15, 2287.54 examples/s]
Map:  29%|       | 14547/50245 [00:06<00:15, 2313.68 examples/s]
Map:  29%|       | 14799/50245 [00:06<00:14, 2365.37 examples/s]
Map:  30%|       | 15135/50245 [00:06<00:15, 2317.78 examples/s]
Map:  31%|       | 15377/50245 [00:06<00:14, 2340.78 examples/s]
Map:  31%|      | 15734/50245 [00:06<00:14, 2347.41 examples/s]
Map:  32%|      | 15985/50245 [00:06<00:14, 2386.08 examples/s]
Map:  32%|      | 16298/50245 [00:06<00:14, 2277.63 examples/s]
Map:  33%|      | 16561/50245 [00:07<00:14, 2363.09 examples/s]
Map:  33%|      | 16818/50245 [00:07<00:13, 2413.92 examples/s]
Map:  34%|      | 17141/50245 [00:07<00:14, 2317.61 examples/s]
Map:  35%|      | 17378/50245 [00:07<00:14, 2329.38 examples/s]
Map:  35%|      | 17638/50245 [00:07<00:13, 2399.33 examples/s]
Map:  36%|      | 17889/50245 [00:07<00:13, 2426.46 examples/s]
Map:  36%|      | 18257/50245 [00:07<00:13, 2331.57 examples/s]
Map:  37%|      | 18511/50245 [00:07<00:13, 2380.38 examples/s]
Map:  38%|      | 18874/50245 [00:08<00:13, 2392.49 examples/s]
Map:  38%|      | 19203/50245 [00:08<00:13, 2322.66 examples/s]
Map:  39%|      | 19451/50245 [00:08<00:13, 2358.16 examples/s]
Map:  39%|      | 19702/50245 [00:08<00:12, 2393.65 examples/s]
Map:  40%|      | 19961/50245 [00:08<00:12, 2443.00 examples/s]
Map:  40%|      | 20277/50245 [00:08<00:12, 2319.17 examples/s]
Map:  41%|      | 20532/50245 [00:08<00:12, 2376.50 examples/s]
Map:  41%|     | 20780/50245 [00:08<00:12, 2401.99 examples/s]
Map:  42%|     | 21128/50245 [00:09<00:12, 2269.67 examples/s]
Map:  43%|     | 21366/50245 [00:09<00:12, 2295.83 examples/s]
Map:  43%|     | 21621/50245 [00:09<00:12, 2358.23 examples/s]
Map:  44%|     | 21863/50245 [00:09<00:11, 2368.87 examples/s]
Map:  44%|     | 22171/50245 [00:09<00:12, 2249.61 examples/s]
Map:  45%|     | 22414/50245 [00:09<00:12, 2293.13 examples/s]
Map:  45%|     | 22663/50245 [00:09<00:11, 2344.20 examples/s]
Map:  46%|     | 22911/50245 [00:09<00:11, 2379.75 examples/s]
Map:  46%|     | 23249/50245 [00:09<00:11, 2278.25 examples/s]
Map:  47%|     | 23508/50245 [00:10<00:11, 2356.45 examples/s]
Map:  47%|     | 23751/50245 [00:10<00:11, 2374.40 examples/s]
Map:  48%|     | 24000/50245 [00:10<00:11, 2268.51 examples/s]
Map:  48%|     | 24359/50245 [00:10<00:11, 2303.60 examples/s]
Map:  49%|     | 24718/50245 [00:10<00:10, 2331.63 examples/s]
Map:  50%|     | 24981/50245 [00:10<00:10, 2402.48 examples/s]
Map:  50%|     | 25303/50245 [00:10<00:10, 2313.60 examples/s]
Map:  51%|     | 25568/50245 [00:10<00:10, 2393.55 examples/s]
Map:  52%|    | 25921/50245 [00:11<00:10, 2376.28 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2264.21 examples/s]
Map:  53%|    | 26486/50245 [00:11<00:10, 2307.02 examples/s]
Map:  53%|    | 26743/50245 [00:11<00:09, 2371.10 examples/s]
Map:  54%|    | 26992/50245 [00:11<00:09, 2399.65 examples/s]
Map:  54%|    | 27323/50245 [00:11<00:09, 2323.72 examples/s]
Map:  55%|    | 27583/50245 [00:11<00:09, 2392.66 examples/s]
Map:  56%|    | 27956/50245 [00:11<00:09, 2423.40 examples/s]
Map:  56%|    | 28254/50245 [00:12<00:09, 2269.24 examples/s]
Map:  57%|    | 28513/50245 [00:12<00:09, 2344.96 examples/s]
Map:  57%|    | 28754/50245 [00:12<00:09, 2359.76 examples/s]
Map:  58%|    | 29000/50245 [00:12<00:09, 2248.14 examples/s]
Map:  58%|    | 29254/50245 [00:12<00:09, 2323.44 examples/s]
Map:  59%|    | 29493/50245 [00:12<00:08, 2339.58 examples/s]
Map:  59%|    | 29732/50245 [00:12<00:08, 2350.38 examples/s]
Map:  60%|    | 29969/50245 [00:12<00:08, 2354.38 examples/s]
Map:  60%|    | 30294/50245 [00:12<00:08, 2278.18 examples/s]
Map:  61%|    | 30546/50245 [00:13<00:08, 2340.18 examples/s]
Map:  61%|   | 30795/50245 [00:13<00:08, 2379.46 examples/s]
Map:  62%|   | 31127/50245 [00:13<00:08, 2289.48 examples/s]
Map:  62%|   | 31376/50245 [00:13<00:08, 2338.14 examples/s]
Map:  63%|   | 31626/50245 [00:13<00:07, 2380.30 examples/s]
Map:  63%|   | 31872/50245 [00:13<00:07, 2397.90 examples/s]
Map:  64%|   | 32183/50245 [00:13<00:07, 2272.81 examples/s]
Map:  65%|   | 32419/50245 [00:13<00:07, 2292.47 examples/s]
Map:  65%|   | 32677/50245 [00:13<00:07, 2368.30 examples/s]
Map:  66%|   | 32930/50245 [00:14<00:07, 2411.33 examples/s]
Map:  66%|   | 33254/50245 [00:14<00:07, 2291.68 examples/s]
Map:  67%|   | 33508/50245 [00:14<00:07, 2355.65 examples/s]
Map:  67%|   | 33749/50245 [00:14<00:06, 2366.17 examples/s]
Map:  68%|   | 33995/50245 [00:14<00:06, 2390.81 examples/s]
Map:  68%|   | 34323/50245 [00:14<00:06, 2311.63 examples/s]
Map:  69%|   | 34578/50245 [00:14<00:06, 2373.28 examples/s]
Map:  69%|   | 34825/50245 [00:14<00:06, 2397.50 examples/s]
Map:  70%|   | 35159/50245 [00:15<00:06, 2331.05 examples/s]
Map:  70%|   | 35404/50245 [00:15<00:06, 2360.84 examples/s]
Map:  71%|   | 35654/50245 [00:15<00:06, 2395.60 examples/s]
Map:  72%|  | 36000/50245 [00:15<00:06, 2271.73 examples/s]
Map:  72%|  | 36254/50245 [00:15<00:05, 2336.17 examples/s]
Map:  73%|  | 36509/50245 [00:15<00:05, 2391.14 examples/s]
Map:  73%|  | 36758/50245 [00:15<00:05, 2413.51 examples/s]
Map:  74%|  | 37117/50245 [00:15<00:05, 2277.51 examples/s]
Map:  75%|  | 37472/50245 [00:16<00:05, 2303.72 examples/s]
Map:  75%|  | 37713/50245 [00:16<00:05, 2326.11 examples/s]
Map:  76%|  | 37960/50245 [00:16<00:05, 2360.95 examples/s]
Map:  76%|  | 38266/50245 [00:16<00:05, 2243.93 examples/s]
Map:  77%|  | 38516/50245 [00:16<00:05, 2307.89 examples/s]
Map:  77%|  | 38775/50245 [00:16<00:04, 2378.50 examples/s]
Map:  78%|  | 39126/50245 [00:16<00:04, 2323.86 examples/s]
Map:  78%|  | 39379/50245 [00:16<00:04, 2372.16 examples/s]
Map:  79%|  | 39620/50245 [00:16<00:04, 2379.22 examples/s]
Map:  79%|  | 39873/50245 [00:17<00:04, 2416.68 examples/s]
Map:  80%|  | 40186/50245 [00:17<00:04, 2289.12 examples/s]
Map:  81%|  | 40461/50245 [00:17<00:04, 2407.01 examples/s]
Map:  81%| | 40836/50245 [00:17<00:03, 2434.77 examples/s]
Map:  82%| | 41144/50245 [00:17<00:03, 2301.33 examples/s]
Map:  83%| | 41505/50245 [00:17<00:03, 2332.16 examples/s]
Map:  83%| | 41750/50245 [00:17<00:03, 2356.49 examples/s]
Map:  84%| | 42050/50245 [00:17<00:03, 2234.13 examples/s]
Map:  84%| | 42307/50245 [00:18<00:03, 2312.13 examples/s]
Map:  85%| | 42563/50245 [00:18<00:03, 2372.32 examples/s]
Map:  85%| | 42811/50245 [00:18<00:03, 2398.43 examples/s]
Map:  86%| | 43123/50245 [00:18<00:03, 2268.20 examples/s]
Map:  86%| | 43391/50245 [00:18<00:02, 2371.05 examples/s]
Map:  87%| | 43650/50245 [00:18<00:02, 2429.09 examples/s]
Map:  88%| | 44000/50245 [00:18<00:02, 2325.02 examples/s]
Map:  88%| | 44238/50245 [00:18<00:02, 2335.66 examples/s]
Map:  89%| | 44477/50245 [00:18<00:02, 2343.97 examples/s]
Map:  89%| | 44731/50245 [00:19<00:02, 2395.16 examples/s]
Map:  90%| | 44984/50245 [00:19<00:02, 2430.45 examples/s]
Map:  90%| | 45290/50245 [00:19<00:02, 2279.83 examples/s]
Map:  91%| | 45532/50245 [00:19<00:02, 2311.81 examples/s]
Map:  91%| | 45773/50245 [00:19<00:01, 2334.83 examples/s]
Map:  92%|| 46123/50245 [00:19<00:01, 2243.21 examples/s]
Map:  92%|| 46363/50245 [00:19<00:01, 2281.16 examples/s]
Map:  93%|| 46622/50245 [00:19<00:01, 2360.71 examples/s]
Map:  93%|| 46874/50245 [00:20<00:01, 2402.00 examples/s]
Map:  94%|| 47129/50245 [00:20<00:01, 2311.30 examples/s]
Map:  94%|| 47475/50245 [00:20<00:01, 2303.90 examples/s]
Map:  95%|| 47800/50245 [00:20<00:01, 1783.17 examples/s]
Map:  96%|| 48000/50245 [00:20<00:01, 1800.92 examples/s]
Map:  96%|| 48253/50245 [00:20<00:01, 1962.09 examples/s]
Map:  97%|| 48511/50245 [00:20<00:00, 2096.54 examples/s]
Map:  97%|| 48754/50245 [00:20<00:00, 2177.53 examples/s]
Map:  98%|| 49000/50245 [00:21<00:00, 2116.36 examples/s]
Map:  98%|| 49229/50245 [00:21<00:00, 2157.84 examples/s]
Map:  98%|| 49453/50245 [00:21<00:00, 2175.47 examples/s]
Map:  99%|| 49703/50245 [00:21<00:00, 2257.93 examples/s]
Map:  99%|| 49940/50245 [00:21<00:00, 2285.07 examples/s]
Map: 100%|| 50239/50245 [00:21<00:00, 2172.50 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2313.15 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [1] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x153d1da624d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x153d1da2c434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x153d48fcb8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x153d48fcc572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x153d48fcc5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153d48f8bac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153d48f8bac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153d48f8bac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x153d1e9f1c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x153d1e9f5901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x153d1e9fca2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x153d1e9fde31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x153d1ea00aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x153d1ea0fa41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x153d48f802d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x153d48f8402a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x153d48f92e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x153d5d610fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x153d5ce5c285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x153d96acacf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 1 STDERR----------
Global rank 2 (PID 173522) exited with code 1
----------Begin global rank 2 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 2 STDOUT----------
----------Begin global rank 2 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:06, 7543.48 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 8744.19 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 9165.80 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 9371.17 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9536.09 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9685.16 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9858.52 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9902.32 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:03, 9859.49 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9860.57 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9952.01 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9943.09 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9882.24 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9906.29 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9878.99 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9977.09 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:02, 9963.26 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9935.73 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9918.28 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9869.14 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9873.34 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9846.44 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:02, 9890.26 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9883.18 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9891.18 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9834.32 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9939.03 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9928.91 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 9883.05 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9919.48 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9886.10 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9998.35 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9980.17 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9958.29 examples/s]
Filter:  96%|| 48000/50245 [00:04<00:00, 9931.62 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9918.10 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9837.56 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 8943.98 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9069.09 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 8973.16 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:05, 8867.34 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:05, 8908.82 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 8966.20 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9059.94 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 8987.51 examples/s]
Filter:  18%|        | 9000/50245 [00:01<00:04, 8985.34 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9054.62 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9080.97 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:04, 9052.64 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:04, 9091.46 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9176.65 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9130.31 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9133.89 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9219.62 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9061.73 examples/s]
Filter:  38%|      | 19000/50245 [00:02<00:03, 9158.77 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9258.73 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9220.68 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:03, 9229.60 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9218.30 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9231.32 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9062.36 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9195.64 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9091.64 examples/s]
Filter:  56%|    | 28000/50245 [00:03<00:02, 9210.25 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9096.66 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9017.73 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9090.37 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9125.71 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9140.88 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9179.49 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9215.74 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9245.34 examples/s]
Filter:  74%|  | 37000/50245 [00:04<00:01, 9289.81 examples/s]
Filter:  76%|  | 38000/50245 [00:04<00:01, 9182.15 examples/s]
ERROR:composer.cli.launcher:Global rank 0 (PID 173520) exited with code 143
Filter:  78%|  | 39000/50245 [00:04<00:01, 9287.25 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9229.81 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:01, 9169.26 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9040.18 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9152.53 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9273.72 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9181.88 examples/s]
Filter:  92%|| 46000/50245 [00:05<00:00, 9200.25 examples/s]
Filter:  94%|| 47000/50245 [00:05<00:00, 9287.23 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9237.30 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9185.71 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9012.89 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9118.86 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [2] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x15241a8c54d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x15241a88f434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x152445e2e8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x152445e2f572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x152445e2f5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x152445deeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x152445deeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x152445deeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x15241b854c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x15241b858901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x15241b85fa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x15241b860e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x15241b863aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x15241b872a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x152445de32d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x152445de702a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x152445df5e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x15245a473fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x152459cbf285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x15249392dcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 2 STDERR----------
Global rank 3 (PID 173523) exited with code 1
----------Begin global rank 3 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 3 STDOUT----------
----------Begin global rank 3 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:08, 5971.42 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:06, 7515.38 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 8246.37 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:05, 8600.50 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:05, 8822.41 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9047.13 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9173.97 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9240.49 examples/s]
Filter:  18%|        | 9000/50245 [00:01<00:04, 9323.28 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9321.21 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9348.56 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:04, 9352.26 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9447.07 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9439.75 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9452.54 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9376.02 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9407.61 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9386.99 examples/s]
Filter:  38%|      | 19000/50245 [00:02<00:03, 9422.62 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9485.13 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9474.59 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9441.45 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9407.84 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9376.07 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9361.61 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9414.92 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9379.65 examples/s]
Filter:  56%|    | 28000/50245 [00:03<00:02, 9423.65 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9372.27 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9356.01 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9381.81 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9378.26 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9383.78 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9386.27 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9500.91 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9454.49 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9490.07 examples/s]
Filter:  76%|  | 38000/50245 [00:04<00:01, 9348.25 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9418.85 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9401.80 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9438.15 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9354.13 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9393.66 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9465.55 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9462.80 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9425.20 examples/s]
Filter:  94%|| 47000/50245 [00:05<00:00, 9458.09 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9380.36 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9504.72 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9443.92 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9289.40 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [3] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14e3fd84b4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14e3fd815434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14e428db48c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14e428db5572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14e428db55f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e428d74ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e428d74ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e428d74ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14e3fe7dac4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14e3fe7de901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14e3fe7e5a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14e3fe7e6e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14e3fe7e9aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14e3fe7f8a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14e428d692d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14e428d6d02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14e428d7be90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14e43d3f9fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14e43cc45285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14e4768b3cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 3 STDERR----------
Global rank 20 (PID 174620) exited with code 143
Global rank 21 (PID 174621) exited with code 1
----------Begin global rank 21 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 21 STDOUT----------
----------Begin global rank 21 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 238/50245 [00:00<00:21, 2361.71 examples/s]
Map:   1%|          | 488/50245 [00:00<00:20, 2432.56 examples/s]
Map:   1%|         | 742/50245 [00:00<00:19, 2477.29 examples/s]
Map:   2%|         | 1044/50245 [00:00<00:21, 2241.05 examples/s]
Map:   3%|         | 1388/50245 [00:00<00:21, 2259.71 examples/s]
Map:   3%|         | 1735/50245 [00:00<00:21, 2276.72 examples/s]
Map:   4%|         | 1984/50245 [00:00<00:20, 2316.03 examples/s]
Map:   5%|         | 2296/50245 [00:01<00:21, 2229.45 examples/s]
Map:   5%|         | 2526/50245 [00:01<00:21, 2246.29 examples/s]
Map:   5%|         | 2761/50245 [00:01<00:20, 2268.94 examples/s]
Map:   6%|         | 2993/50245 [00:01<00:20, 2279.58 examples/s]
Map:   7%|         | 3288/50245 [00:01<00:21, 2159.17 examples/s]
Map:   7%|         | 3535/50245 [00:01<00:20, 2237.31 examples/s]
Map:   8%|         | 3873/50245 [00:01<00:20, 2236.12 examples/s]
Map:   8%|         | 4174/50245 [00:01<00:21, 2155.40 examples/s]
Map:   9%|         | 4406/50245 [00:01<00:20, 2194.43 examples/s]
Map:   9%|         | 4649/50245 [00:02<00:20, 2251.72 examples/s]
Map:  10%|         | 4979/50245 [00:02<00:20, 2228.88 examples/s]
Map:  11%|         | 5292/50245 [00:02<00:20, 2176.68 examples/s]
Map:  11%|         | 5541/50245 [00:02<00:19, 2250.45 examples/s]
Map:  12%|        | 5779/50245 [00:02<00:19, 2281.51 examples/s]
Map:  12%|        | 6125/50245 [00:02<00:19, 2219.10 examples/s]
Map:  13%|        | 6365/50245 [00:02<00:19, 2262.98 examples/s]
Map:  13%|        | 6609/50245 [00:02<00:18, 2308.78 examples/s]
Map:  14%|        | 6858/50245 [00:03<00:18, 2355.02 examples/s]
Map:  14%|        | 7168/50245 [00:03<00:19, 2245.09 examples/s]
Map:  15%|        | 7415/50245 [00:03<00:18, 2299.70 examples/s]
Map:  15%|        | 7655/50245 [00:03<00:18, 2323.71 examples/s]
Map:  16%|        | 7891/50245 [00:03<00:18, 2332.67 examples/s]
Map:  16%|        | 8250/50245 [00:03<00:18, 2268.97 examples/s]
Map:  17%|        | 8486/50245 [00:03<00:18, 2290.48 examples/s]
Map:  17%|        | 8728/50245 [00:03<00:17, 2322.97 examples/s]
Map:  18%|        | 8977/50245 [00:03<00:17, 2366.25 examples/s]
Map:  19%|        | 9300/50245 [00:04<00:17, 2279.28 examples/s]
Map:  19%|        | 9547/50245 [00:04<00:17, 2327.08 examples/s]
Map:  20%|        | 9901/50245 [00:04<00:17, 2335.92 examples/s]
Map:  20%|        | 10242/50245 [00:04<00:17, 2230.71 examples/s]
Map:  21%|        | 10472/50245 [00:04<00:17, 2244.31 examples/s]
Map:  21%|       | 10717/50245 [00:04<00:17, 2293.07 examples/s]
Map:  22%|       | 10965/50245 [00:04<00:16, 2337.00 examples/s]
Map:  22%|       | 11273/50245 [00:04<00:17, 2228.56 examples/s]
Map:  23%|       | 11515/50245 [00:05<00:17, 2273.97 examples/s]
Map:  23%|       | 11763/50245 [00:05<00:16, 2324.19 examples/s]
Map:  24%|       | 12000/50245 [00:05<00:17, 2202.76 examples/s]
Map:  24%|       | 12249/50245 [00:05<00:16, 2279.20 examples/s]
Map:  25%|       | 12482/50245 [00:05<00:16, 2291.22 examples/s]
Map:  25%|       | 12732/50245 [00:05<00:15, 2348.01 examples/s]
Map:  26%|       | 12993/50245 [00:05<00:15, 2420.43 examples/s]
Map:  26%|       | 13312/50245 [00:05<00:16, 2304.46 examples/s]
Map:  27%|       | 13665/50245 [00:05<00:15, 2316.55 examples/s]
Map:  28%|       | 13899/50245 [00:06<00:15, 2321.33 examples/s]
Map:  28%|       | 14234/50245 [00:06<00:16, 2221.35 examples/s]
Map:  29%|       | 14466/50245 [00:06<00:15, 2242.83 examples/s]
Map:  29%|       | 14709/50245 [00:06<00:15, 2289.33 examples/s]
Map:  30%|       | 14964/50245 [00:06<00:14, 2357.83 examples/s]
Map:  30%|       | 15274/50245 [00:06<00:15, 2249.69 examples/s]
Map:  31%|       | 15616/50245 [00:06<00:15, 2256.90 examples/s]
Map:  32%|      | 15861/50245 [00:06<00:14, 2302.83 examples/s]
Map:  32%|      | 16167/50245 [00:07<00:15, 2207.47 examples/s]
Map:  33%|      | 16403/50245 [00:07<00:15, 2240.84 examples/s]
Map:  33%|      | 16663/50245 [00:07<00:14, 2333.00 examples/s]
Map:  34%|      | 16908/50245 [00:07<00:14, 2361.59 examples/s]
Map:  34%|      | 17246/50245 [00:07<00:14, 2270.18 examples/s]
Map:  35%|      | 17479/50245 [00:07<00:14, 2284.57 examples/s]
Map:  35%|      | 17732/50245 [00:07<00:13, 2347.25 examples/s]
Map:  36%|      | 17972/50245 [00:07<00:13, 2358.01 examples/s]
Map:  36%|      | 18281/50245 [00:08<00:14, 2243.51 examples/s]
Map:  37%|      | 18529/50245 [00:08<00:13, 2302.48 examples/s]
Map:  37%|      | 18764/50245 [00:08<00:13, 2311.69 examples/s]
Map:  38%|      | 19000/50245 [00:08<00:14, 2189.20 examples/s]
Map:  38%|      | 19252/50245 [00:08<00:13, 2274.33 examples/s]
Map:  39%|      | 19494/50245 [00:08<00:13, 2313.09 examples/s]
Map:  39%|      | 19732/50245 [00:08<00:13, 2329.70 examples/s]
Map:  40%|      | 19983/50245 [00:08<00:12, 2380.88 examples/s]
Map:  40%|      | 20291/50245 [00:08<00:13, 2250.69 examples/s]
Map:  41%|      | 20541/50245 [00:09<00:12, 2315.04 examples/s]
Map:  41%|     | 20780/50245 [00:09<00:12, 2330.21 examples/s]
Map:  42%|     | 21127/50245 [00:09<00:13, 2219.20 examples/s]
Map:  43%|     | 21363/50245 [00:09<00:12, 2248.89 examples/s]
Map:  43%|     | 21612/50245 [00:09<00:12, 2308.53 examples/s]
Map:  43%|     | 21851/50245 [00:09<00:12, 2329.76 examples/s]
Map:  44%|     | 22151/50245 [00:09<00:12, 2203.50 examples/s]
Map:  45%|     | 22386/50245 [00:09<00:12, 2238.85 examples/s]
Map:  45%|     | 22629/50245 [00:09<00:12, 2287.73 examples/s]
Map:  46%|     | 22875/50245 [00:10<00:11, 2333.54 examples/s]
Map:  46%|     | 23175/50245 [00:10<00:12, 2204.92 examples/s]
Map:  47%|     | 23432/50245 [00:10<00:11, 2299.73 examples/s]
Map:  47%|     | 23671/50245 [00:10<00:11, 2322.99 examples/s]
Map:  48%|     | 23910/50245 [00:10<00:11, 2337.96 examples/s]
Map:  48%|     | 24216/50245 [00:10<00:11, 2175.39 examples/s]
Map:  49%|     | 24461/50245 [00:10<00:11, 2243.12 examples/s]
Map:  49%|     | 24701/50245 [00:10<00:11, 2283.40 examples/s]
Map:  50%|     | 24955/50245 [00:10<00:10, 2351.12 examples/s]
Map:  50%|     | 25271/50245 [00:11<00:11, 2255.53 examples/s]
Map:  51%|     | 25529/50245 [00:11<00:10, 2337.08 examples/s]
Map:  51%|    | 25767/50245 [00:11<00:10, 2345.47 examples/s]
Map:  52%|    | 26057/50245 [00:11<00:11, 2188.82 examples/s]
Map:  52%|    | 26298/50245 [00:11<00:10, 2244.99 examples/s]
Map:  53%|    | 26531/50245 [00:11<00:10, 2267.25 examples/s]
Map:  53%|    | 26780/50245 [00:11<00:10, 2325.32 examples/s]
Map:  54%|    | 27105/50245 [00:11<00:10, 2178.49 examples/s]
Map:  54%|    | 27377/50245 [00:12<00:09, 2314.16 examples/s]
Map:  55%|    | 27623/50245 [00:12<00:09, 2351.37 examples/s]
Map:  56%|    | 27987/50245 [00:12<00:09, 2371.52 examples/s]
Map:  56%|    | 28272/50245 [00:12<00:09, 2206.89 examples/s]
Map:  57%|    | 28526/50245 [00:12<00:09, 2285.53 examples/s]
Map:  57%|    | 28763/50245 [00:12<00:09, 2305.34 examples/s]
Map:  58%|    | 29000/50245 [00:12<00:09, 2188.35 examples/s]
Map:  58%|    | 29248/50245 [00:12<00:09, 2263.53 examples/s]
Map:  59%|    | 29486/50245 [00:12<00:09, 2292.18 examples/s]
Map:  59%|    | 29718/50245 [00:13<00:08, 2297.26 examples/s]
Map:  60%|    | 29954/50245 [00:13<00:08, 2309.87 examples/s]
Map:  60%|    | 30271/50245 [00:13<00:08, 2230.76 examples/s]
Map:  61%|    | 30512/50245 [00:13<00:08, 2275.00 examples/s]
Map:  61%|    | 30752/50245 [00:13<00:08, 2304.92 examples/s]
Map:  62%|   | 30999/50245 [00:13<00:08, 2347.03 examples/s]
Map:  62%|   | 31305/50245 [00:13<00:08, 2226.43 examples/s]
Map:  63%|   | 31547/50245 [00:13<00:08, 2273.81 examples/s]
Map:  63%|   | 31787/50245 [00:13<00:08, 2303.02 examples/s]
Map:  64%|   | 32115/50245 [00:14<00:08, 2186.85 examples/s]
Map:  64%|   | 32347/50245 [00:14<00:08, 2218.75 examples/s]
Map:  65%|   | 32602/50245 [00:14<00:07, 2306.06 examples/s]
Map:  65%|   | 32847/50245 [00:14<00:07, 2339.79 examples/s]
Map:  66%|   | 33164/50245 [00:14<00:07, 2250.75 examples/s]
Map:  66%|   | 33407/50245 [00:14<00:07, 2294.11 examples/s]
Map:  67%|   | 33648/50245 [00:14<00:07, 2323.97 examples/s]
Map:  67%|   | 33894/50245 [00:14<00:06, 2356.70 examples/s]
Map:  68%|   | 34255/50245 [00:15<00:07, 2265.80 examples/s]
Map:  69%|   | 34505/50245 [00:15<00:06, 2323.96 examples/s]
Map:  69%|   | 34870/50245 [00:15<00:06, 2358.58 examples/s]
Map:  70%|   | 35180/50245 [00:15<00:06, 2258.92 examples/s]
Map:  71%|   | 35423/50245 [00:15<00:06, 2296.62 examples/s]
Map:  71%|   | 35666/50245 [00:15<00:06, 2329.46 examples/s]
Map:  72%|  | 36000/50245 [00:15<00:06, 2191.92 examples/s]
Map:  72%|  | 36239/50245 [00:15<00:06, 2237.76 examples/s]
Map:  73%|  | 36477/50245 [00:16<00:06, 2273.57 examples/s]
Map:  73%|  | 36825/50245 [00:16<00:05, 2285.44 examples/s]
Map:  74%|  | 37096/50245 [00:16<00:06, 2108.63 examples/s]
Map:  74%|  | 37415/50245 [00:16<00:06, 2112.47 examples/s]
Map:  75%|  | 37647/50245 [00:16<00:05, 2160.94 examples/s]
Map:  76%|  | 37977/50245 [00:16<00:05, 2171.33 examples/s]
Map:  76%|  | 38253/50245 [00:16<00:05, 2058.45 examples/s]
Map:  77%|  | 38485/50245 [00:16<00:05, 2116.39 examples/s]
Map:  77%|  | 38733/50245 [00:17<00:05, 2204.86 examples/s]
Map:  78%|  | 38978/50245 [00:17<00:04, 2268.31 examples/s]
Map:  78%|  | 39278/50245 [00:17<00:05, 2167.88 examples/s]
Map:  79%|  | 39519/50245 [00:17<00:04, 2227.50 examples/s]
Map:  79%|  | 39861/50245 [00:17<00:04, 2243.96 examples/s]
Map:  80%|  | 40138/50245 [00:17<00:04, 2107.63 examples/s]
Map:  80%|  | 40386/50245 [00:17<00:04, 2192.57 examples/s]
Map:  81%|  | 40627/50245 [00:17<00:04, 2247.45 examples/s]
Map:  82%| | 40951/50245 [00:18<00:04, 2207.38 examples/s]
Map:  82%| | 41235/50245 [00:18<00:04, 2081.62 examples/s]
Map:  83%| | 41463/50245 [00:18<00:04, 2126.46 examples/s]
Map:  83%| | 41698/50245 [00:18<00:03, 2180.87 examples/s]
Map:  84%| | 42000/50245 [00:18<00:04, 2026.22 examples/s]
Map:  84%| | 42232/50245 [00:18<00:03, 2096.63 examples/s]
Map:  85%| | 42463/50245 [00:18<00:03, 2149.32 examples/s]
Map:  85%| | 42697/50245 [00:18<00:03, 2198.78 examples/s]
Map:  86%| | 43000/50245 [00:19<00:03, 2066.91 examples/s]
Map:  86%| | 43244/50245 [00:19<00:03, 2159.35 examples/s]
Map:  87%| | 43484/50245 [00:19<00:03, 2218.84 examples/s]
Map:  87%| | 43740/50245 [00:19<00:02, 2307.10 examples/s]
Map:  88%| | 44029/50245 [00:19<00:02, 2163.43 examples/s]
Map:  88%| | 44366/50245 [00:19<00:02, 2188.26 examples/s]
Map:  89%| | 44597/50245 [00:19<00:02, 2217.14 examples/s]
Map:  89%| | 44834/50245 [00:19<00:02, 2256.03 examples/s]
Map:  90%| | 45123/50245 [00:20<00:02, 2136.72 examples/s]
Map:  90%| | 45353/50245 [00:20<00:02, 2173.06 examples/s]
Map:  91%| | 45586/50245 [00:20<00:02, 2211.50 examples/s]
Map:  91%| | 45822/50245 [00:20<00:01, 2248.14 examples/s]
Map:  92%|| 46116/50245 [00:20<00:01, 2137.48 examples/s]
Map:  92%|| 46349/50245 [00:20<00:01, 2185.92 examples/s]
Map:  93%|| 46597/50245 [00:20<00:01, 2261.42 examples/s]
Map:  93%|| 46840/50245 [00:20<00:01, 2305.24 examples/s]
Map:  94%|| 47152/50245 [00:20<00:01, 2215.50 examples/s]
Map:  95%|| 47482/50245 [00:21<00:01, 2206.69 examples/s]
Map:  95%|| 47792/50245 [00:21<00:01, 1707.21 examples/s]
Map:  96%|| 48000/50245 [00:21<00:01, 1708.85 examples/s]
Map:  96%|| 48232/50245 [00:21<00:01, 1837.89 examples/s]
Map:  96%|| 48478/50245 [00:21<00:00, 1978.91 examples/s]
Map:  97%|| 48709/50245 [00:21<00:00, 2059.45 examples/s]
Map:  97%|| 48935/50245 [00:21<00:00, 2110.10 examples/s]
Map:  98%|| 49227/50245 [00:22<00:00, 2037.98 examples/s]
Map:  99%|| 49557/50245 [00:22<00:00, 2089.48 examples/s]
Map:  99%|| 49795/50245 [00:22<00:00, 2158.14 examples/s]
Map: 100%|| 50117/50245 [00:22<00:00, 2076.17 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2231.88 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [21] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x1494a80474d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x1494a8011434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x1494d35b08c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x1494d35b1572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x1494d35b15f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1494d3570ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1494d3570ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1494d3570ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x1494a8fd6c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x1494a8fda901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x1494a8fe1a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x1494a8fe2e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x1494a8fe5aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x1494a8ff4a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x1494d35652d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x1494d356902a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x1494d3577e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x1494e7bf5fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x1494e7441285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x1495210afcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 21 STDERR----------
Global rank 22 (PID 174622) exited with code 1
----------Begin global rank 22 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 22 STDOUT----------
----------Begin global rank 22 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 167/50245 [00:00<00:30, 1642.36 examples/s]
Map:   1%|          | 417/50245 [00:00<00:23, 2141.40 examples/s]
Map:   1%|         | 676/50245 [00:00<00:21, 2338.19 examples/s]
Map:   2%|         | 925/50245 [00:00<00:20, 2393.17 examples/s]
Map:   2%|         | 1234/50245 [00:00<00:25, 1959.38 examples/s]
Map:   3%|         | 1466/50245 [00:00<00:23, 2056.75 examples/s]
Map:   3%|         | 1702/50245 [00:00<00:22, 2139.93 examples/s]
Map:   4%|         | 1940/50245 [00:00<00:21, 2204.76 examples/s]
Map:   4%|         | 2255/50245 [00:01<00:22, 2159.69 examples/s]
Map:   5%|         | 2484/50245 [00:01<00:21, 2193.27 examples/s]
Map:   5%|         | 2729/50245 [00:01<00:21, 2259.79 examples/s]
Map:   6%|         | 2960/50245 [00:01<00:20, 2271.51 examples/s]
Map:   6%|         | 3265/50245 [00:01<00:21, 2179.63 examples/s]
Map:   7%|         | 3519/50245 [00:01<00:20, 2273.59 examples/s]
Map:   8%|         | 3863/50245 [00:01<00:20, 2276.57 examples/s]
Map:   8%|         | 4171/50245 [00:01<00:20, 2198.63 examples/s]
Map:   9%|         | 4412/50245 [00:02<00:20, 2248.62 examples/s]
Map:   9%|         | 4660/50245 [00:02<00:19, 2306.14 examples/s]
Map:  10%|         | 4997/50245 [00:02<00:19, 2280.90 examples/s]
Map:  11%|         | 5320/50245 [00:02<00:20, 2234.03 examples/s]
Map:  11%|         | 5579/50245 [00:02<00:19, 2318.91 examples/s]
Map:  12%|        | 5817/50245 [00:02<00:19, 2332.44 examples/s]
Map:  12%|        | 6152/50245 [00:02<00:19, 2296.48 examples/s]
Map:  13%|        | 6403/50245 [00:02<00:18, 2346.72 examples/s]
Map:  13%|        | 6656/50245 [00:02<00:18, 2392.68 examples/s]
Map:  14%|        | 6918/50245 [00:03<00:17, 2450.72 examples/s]
Map:  14%|        | 7250/50245 [00:03<00:18, 2334.58 examples/s]
Map:  15%|        | 7494/50245 [00:03<00:18, 2358.54 examples/s]
Map:  16%|        | 7863/50245 [00:03<00:17, 2391.64 examples/s]
Map:  16%|        | 8197/50245 [00:03<00:18, 2332.52 examples/s]
Map:  17%|        | 8439/50245 [00:03<00:17, 2350.17 examples/s]
Map:  17%|        | 8690/50245 [00:03<00:17, 2387.48 examples/s]
Map:  18%|        | 8944/50245 [00:03<00:17, 2426.34 examples/s]
Map:  18%|        | 9273/50245 [00:04<00:17, 2338.09 examples/s]
Map:  19%|        | 9536/50245 [00:04<00:16, 2409.47 examples/s]
Map:  20%|        | 9899/50245 [00:04<00:16, 2409.77 examples/s]
Map:  20%|        | 10245/50245 [00:04<00:17, 2295.34 examples/s]
Map:  21%|        | 10482/50245 [00:04<00:17, 2309.91 examples/s]
Map:  21%|       | 10738/50245 [00:04<00:16, 2369.15 examples/s]
Map:  22%|       | 10990/50245 [00:04<00:16, 2403.60 examples/s]
Map:  23%|       | 11307/50245 [00:04<00:16, 2295.28 examples/s]
Map:  23%|       | 11557/50245 [00:05<00:16, 2341.64 examples/s]
Map:  24%|       | 11814/50245 [00:05<00:16, 2397.94 examples/s]
Map:  24%|       | 12141/50245 [00:05<00:16, 2315.54 examples/s]
Map:  25%|       | 12383/50245 [00:05<00:16, 2340.17 examples/s]
Map:  25%|       | 12634/50245 [00:05<00:15, 2382.74 examples/s]
Map:  26%|       | 12905/50245 [00:05<00:15, 2470.55 examples/s]
Map:  26%|       | 13256/50245 [00:05<00:15, 2364.13 examples/s]
Map:  27%|       | 13499/50245 [00:05<00:15, 2379.84 examples/s]
Map:  27%|       | 13743/50245 [00:05<00:15, 2394.33 examples/s]
Map:  28%|       | 13992/50245 [00:06<00:15, 2415.17 examples/s]
Map:  28%|       | 14308/50245 [00:06<00:15, 2294.94 examples/s]
Map:  29%|       | 14548/50245 [00:06<00:15, 2319.17 examples/s]
Map:  29%|       | 14799/50245 [00:06<00:14, 2369.81 examples/s]
Map:  30%|       | 15137/50245 [00:06<00:15, 2321.88 examples/s]
Map:  31%|       | 15375/50245 [00:06<00:14, 2333.04 examples/s]
Map:  31%|      | 15725/50245 [00:06<00:14, 2332.04 examples/s]
Map:  32%|      | 15967/50245 [00:06<00:14, 2347.67 examples/s]
Map:  32%|      | 16278/50245 [00:07<00:15, 2248.08 examples/s]
Map:  33%|      | 16535/50245 [00:07<00:14, 2326.00 examples/s]
Map:  33%|      | 16793/50245 [00:07<00:13, 2390.75 examples/s]
Map:  34%|      | 17128/50245 [00:07<00:14, 2297.93 examples/s]
Map:  35%|      | 17368/50245 [00:07<00:14, 2318.97 examples/s]
Map:  35%|      | 17621/50245 [00:07<00:13, 2371.01 examples/s]
Map:  36%|      | 17874/50245 [00:07<00:13, 2410.04 examples/s]
Map:  36%|      | 18193/50245 [00:07<00:13, 2301.81 examples/s]
Map:  37%|      | 18440/50245 [00:07<00:13, 2341.82 examples/s]
Map:  37%|      | 18685/50245 [00:08<00:13, 2370.04 examples/s]
Map:  38%|      | 18935/50245 [00:08<00:13, 2404.10 examples/s]
Map:  38%|      | 19254/50245 [00:08<00:13, 2286.94 examples/s]
Map:  39%|      | 19503/50245 [00:08<00:13, 2336.55 examples/s]
Map:  39%|      | 19747/50245 [00:08<00:12, 2359.34 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2275.70 examples/s]
Map:  40%|      | 20245/50245 [00:08<00:12, 2319.52 examples/s]
Map:  41%|      | 20501/50245 [00:08<00:12, 2385.65 examples/s]
Map:  41%|     | 20750/50245 [00:08<00:12, 2414.73 examples/s]
Map:  42%|     | 21054/50245 [00:09<00:12, 2264.85 examples/s]
Map:  42%|     | 21304/50245 [00:09<00:12, 2322.55 examples/s]
Map:  43%|     | 21552/50245 [00:09<00:12, 2363.76 examples/s]
Map:  43%|     | 21802/50245 [00:09<00:11, 2399.15 examples/s]
Map:  44%|     | 22127/50245 [00:09<00:12, 2273.26 examples/s]
Map:  45%|     | 22365/50245 [00:09<00:12, 2299.49 examples/s]
Map:  45%|     | 22613/50245 [00:09<00:11, 2345.56 examples/s]
Map:  46%|     | 22866/50245 [00:09<00:11, 2395.00 examples/s]
Map:  46%|     | 23174/50245 [00:10<00:11, 2262.34 examples/s]
Map:  47%|     | 23437/50245 [00:10<00:11, 2357.34 examples/s]
Map:  47%|     | 23792/50245 [00:10<00:11, 2359.05 examples/s]
Map:  48%|     | 24121/50245 [00:10<00:11, 2273.36 examples/s]
Map:  48%|     | 24359/50245 [00:10<00:11, 2295.36 examples/s]
Map:  49%|     | 24724/50245 [00:10<00:10, 2337.15 examples/s]
Map:  50%|     | 24982/50245 [00:10<00:10, 2394.92 examples/s]
Map:  50%|     | 25304/50245 [00:10<00:10, 2305.65 examples/s]
Map:  51%|     | 25572/50245 [00:11<00:10, 2395.86 examples/s]
Map:  52%|    | 25925/50245 [00:11<00:10, 2375.50 examples/s]
Map:  52%|    | 26240/50245 [00:11<00:10, 2259.58 examples/s]
Map:  53%|    | 26485/50245 [00:11<00:10, 2302.77 examples/s]
Map:  53%|    | 26740/50245 [00:11<00:09, 2362.20 examples/s]
Map:  54%|    | 26989/50245 [00:11<00:09, 2391.23 examples/s]
Map:  54%|    | 27310/50245 [00:11<00:09, 2297.18 examples/s]
Map:  55%|    | 27564/50245 [00:11<00:09, 2358.18 examples/s]
Map:  56%|    | 27935/50245 [00:12<00:09, 2396.74 examples/s]
Map:  56%|    | 28235/50245 [00:12<00:09, 2247.34 examples/s]
Map:  57%|    | 28492/50245 [00:12<00:09, 2323.61 examples/s]
Map:  57%|    | 28734/50245 [00:12<00:09, 2346.51 examples/s]
Map:  58%|    | 28985/50245 [00:12<00:08, 2389.04 examples/s]
Map:  58%|    | 29303/50245 [00:12<00:09, 2288.76 examples/s]
Map:  59%|    | 29538/50245 [00:12<00:08, 2302.05 examples/s]
Map:  59%|    | 29784/50245 [00:12<00:08, 2340.37 examples/s]
Map:  60%|    | 30122/50245 [00:12<00:08, 2237.49 examples/s]
Map:  60%|    | 30372/50245 [00:13<00:08, 2300.63 examples/s]
Map:  61%|    | 30626/50245 [00:13<00:08, 2362.03 examples/s]
Map:  61%|   | 30868/50245 [00:13<00:08, 2376.34 examples/s]
Map:  62%|   | 31185/50245 [00:13<00:08, 2275.19 examples/s]
Map:  63%|   | 31431/50245 [00:13<00:08, 2321.83 examples/s]
Map:  63%|   | 31686/50245 [00:13<00:07, 2378.02 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2266.02 examples/s]
Map:  64%|   | 32239/50245 [00:13<00:07, 2296.09 examples/s]
Map:  65%|   | 32489/50245 [00:13<00:07, 2347.51 examples/s]
Map:  65%|   | 32738/50245 [00:14<00:07, 2383.43 examples/s]
Map:  66%|   | 32990/50245 [00:14<00:07, 2420.66 examples/s]
Map:  66%|   | 33324/50245 [00:14<00:07, 2342.37 examples/s]
Map:  67%|   | 33568/50245 [00:14<00:07, 2365.92 examples/s]
Map:  67%|   | 33809/50245 [00:14<00:06, 2376.85 examples/s]
Map:  68%|   | 34132/50245 [00:14<00:07, 2283.37 examples/s]
Map:  68%|   | 34392/50245 [00:14<00:06, 2362.23 examples/s]
Map:  69%|   | 34643/50245 [00:14<00:06, 2401.43 examples/s]
Map:  69%|   | 34909/50245 [00:15<00:06, 2470.91 examples/s]
Map:  70%|   | 35249/50245 [00:15<00:06, 2345.27 examples/s]
Map:  71%|   | 35495/50245 [00:15<00:06, 2370.42 examples/s]
Map:  71%|  | 35855/50245 [00:15<00:06, 2377.97 examples/s]
Map:  72%|  | 36189/50245 [00:15<00:06, 2323.64 examples/s]
Map:  73%|  | 36441/50245 [00:15<00:05, 2368.63 examples/s]
Map:  73%|  | 36686/50245 [00:15<00:05, 2386.62 examples/s]
Map:  74%|  | 36932/50245 [00:15<00:05, 2402.79 examples/s]
Map:  74%|  | 37219/50245 [00:16<00:05, 2216.05 examples/s]
Map:  75%|  | 37473/50245 [00:16<00:05, 2297.86 examples/s]
Map:  75%|  | 37713/50245 [00:16<00:05, 2322.98 examples/s]
Map:  76%|  | 37959/50245 [00:16<00:05, 2358.70 examples/s]
Map:  76%|  | 38262/50245 [00:16<00:05, 2228.26 examples/s]
Map:  77%|  | 38512/50245 [00:16<00:05, 2294.00 examples/s]
Map:  77%|  | 38773/50245 [00:16<00:04, 2372.43 examples/s]
Map:  78%|  | 39128/50245 [00:16<00:04, 2325.56 examples/s]
Map:  78%|  | 39381/50245 [00:16<00:04, 2375.23 examples/s]
Map:  79%|  | 39745/50245 [00:17<00:04, 2389.40 examples/s]
Map:  80%|  | 39991/50245 [00:17<00:04, 2405.38 examples/s]
Map:  80%|  | 40321/50245 [00:17<00:04, 2328.39 examples/s]
Map:  81%|  | 40584/50245 [00:17<00:04, 2400.81 examples/s]
Map:  81%| | 40835/50245 [00:17<00:03, 2427.64 examples/s]
Map:  82%| | 41142/50245 [00:17<00:03, 2287.99 examples/s]
Map:  83%| | 41505/50245 [00:17<00:03, 2329.81 examples/s]
Map:  83%| | 41751/50245 [00:17<00:03, 2357.93 examples/s]
Map:  84%| | 42051/50245 [00:18<00:03, 2230.05 examples/s]
Map:  84%| | 42309/50245 [00:18<00:03, 2312.88 examples/s]
Map:  85%| | 42564/50245 [00:18<00:03, 2371.82 examples/s]
Map:  85%| | 42805/50245 [00:18<00:03, 2380.98 examples/s]
Map:  86%| | 43122/50245 [00:18<00:03, 2247.34 examples/s]
Map:  86%| | 43388/50245 [00:18<00:02, 2351.42 examples/s]
Map:  87%| | 43646/50245 [00:18<00:02, 2410.67 examples/s]
Map:  88%| | 44000/50245 [00:18<00:02, 2311.59 examples/s]
Map:  88%| | 44359/50245 [00:19<00:02, 2335.72 examples/s]
Map:  89%| | 44602/50245 [00:19<00:02, 2355.15 examples/s]
Map:  89%| | 44853/50245 [00:19<00:02, 2390.78 examples/s]
Map:  90%| | 45171/50245 [00:19<00:02, 2291.82 examples/s]
Map:  91%| | 45534/50245 [00:19<00:02, 2329.32 examples/s]
Map:  91%| | 45780/50245 [00:19<00:01, 2360.10 examples/s]
Map:  92%|| 46124/50245 [00:19<00:01, 2282.81 examples/s]
Map:  92%|| 46367/50245 [00:19<00:01, 2315.15 examples/s]
Map:  93%|| 46629/50245 [00:20<00:01, 2391.59 examples/s]
Map:  93%|| 46882/50245 [00:20<00:01, 2427.53 examples/s]
Map:  94%|| 47129/50245 [00:20<00:01, 2328.86 examples/s]
Map:  94%|| 47478/50245 [00:20<00:01, 2323.76 examples/s]
Map:  95%|| 47805/50245 [00:20<00:01, 1785.00 examples/s]
Map:  96%|| 48126/50245 [00:20<00:01, 1871.89 examples/s]
Map:  96%|| 48396/50245 [00:20<00:00, 2041.52 examples/s]
Map:  97%|| 48646/50245 [00:21<00:00, 2144.42 examples/s]
Map:  97%|| 48892/50245 [00:21<00:00, 2218.78 examples/s]
Map:  98%|| 49241/50245 [00:21<00:00, 2183.88 examples/s]
Map:  98%|| 49481/50245 [00:21<00:00, 2232.91 examples/s]
Map:  99%|| 49734/50245 [00:21<00:00, 2306.41 examples/s]
Map:  99%|| 49978/50245 [00:21<00:00, 2332.40 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2182.01 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2312.55 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [22] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x145c39c4c4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x145c39c16434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x145c651b58c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x145c651b6572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x145c651b65f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x145c65175ac1 in 
ERROR:composer.cli.launcher:Global rank 20 (PID 174620) exited with code 143
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x145c65175ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x145c65175ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x145c3abdbc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x145c3abdf901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x145c3abe6a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x145c3abe7e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x145c3abeaaed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x145c3abf9a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x145c6516a2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x145c6516e02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x145c6517ce90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x145c797fafee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x145c79046285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x145cb2cb4cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 22 STDERR----------
Global rank 23 (PID 174623) exited with code 1
----------Begin global rank 23 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 23 STDOUT----------
----------Begin global rank 23 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 164/50245 [00:00<00:30, 1617.93 examples/s]
Map:   1%|          | 413/50245 [00:00<00:23, 2119.41 examples/s]
Map:   1%|         | 669/50245 [00:00<00:21, 2314.78 examples/s]
Map:   2%|         | 914/50245 [00:00<00:20, 2366.36 examples/s]
Map:   2%|         | 1234/50245 [00:00<00:24, 1973.49 examples/s]
Map:   3%|         | 1465/50245 [00:00<00:23, 2064.38 examples/s]
Map:   3%|         | 1700/50245 [00:00<00:22, 2140.75 examples/s]
Map:   4%|         | 1942/50245 [00:00<00:21, 2215.10 examples/s]
Map:   4%|         | 2255/50245 [00:01<00:22, 2163.63 examples/s]
Map:   5%|         | 2483/50245 [00:01<00:21, 2193.14 examples/s]
Map:   5%|         | 2725/50245 [00:01<00:21, 2252.85 examples/s]
Map:   6%|         | 3020/50245 [00:01<00:22, 2145.46 examples/s]
Map:   6%|         | 3252/50245 [00:01<00:21, 2187.90 examples/s]
Map:   7%|         | 3503/50245 [00:01<00:20, 2273.34 examples/s]
Map:   8%|         | 3846/50245 [00:01<00:20, 2274.53 examples/s]
Map:   8%|         | 4146/50245 [00:01<00:21, 2177.81 examples/s]
Map:   9%|         | 4377/50245 [00:02<00:20, 2208.44 examples/s]
Map:   9%|         | 4623/50245 [00:02<00:20, 2268.31 examples/s]
Map:  10%|         | 4961/50245 [00:02<00:20, 2260.28 examples/s]
Map:  10%|         | 5275/50245 [00:02<00:20, 2200.80 examples/s]
Map:  11%|         | 5527/50245 [00:02<00:19, 2275.30 examples/s]
Map:  11%|        | 5771/50245 [00:02<00:19, 2313.51 examples/s]
Map:  12%|        | 6126/50245 [00:02<00:19, 2257.29 examples/s]
Map:  13%|        | 6371/50245 [00:02<00:19, 2301.06 examples/s]
Map:  13%|        | 6624/50245 [00:02<00:18, 2355.80 examples/s]
Map:  14%|        | 6880/50245 [00:03<00:18, 2406.94 examples/s]
Map:  14%|        | 7250/50245 [00:03<00:18, 2315.86 examples/s]
Map:  15%|        | 7490/50245 [00:03<00:18, 2334.12 examples/s]
Map:  15%|        | 7728/50245 [00:03<00:18, 2344.28 examples/s]
Map:  16%|        | 7979/50245 [00:03<00:17, 2387.33 examples/s]
Map:  17%|        | 8300/50245 [00:03<00:18, 2292.80 examples/s]
Map:  17%|        | 8540/50245 [00:03<00:17, 2318.07 examples/s]
Map:  18%|        | 8795/50245 [00:03<00:17, 2378.06 examples/s]
Map:  18%|        | 9120/50245 [00:04<00:18, 2283.96 examples/s]
Map:  19%|        | 9380/50245 [00:04<00:17, 2360.77 examples/s]
Map:  19%|        | 9623/50245 [00:04<00:17, 2376.09 examples/s]
Map:  20%|        | 9866/50245 [00:04<00:16, 2387.17 examples/s]
Map:  20%|        | 10179/50245 [00:04<00:17, 2271.41 examples/s]
Map:  21%|        | 10411/50245 [00:04<00:17, 2282.36 examples/s]
Map:  21%|        | 10653/50245 [00:04<00:17, 2318.18 examples/s]
Map:  22%|       | 10909/50245 [00:04<00:16, 2381.28 examples/s]
Map:  22%|       | 11244/50245 [00:04<00:17, 2273.21 examples/s]
Map:  23%|       | 11485/50245 [00:05<00:16, 2307.62 examples/s]
Map:  23%|       | 11741/50245 [00:05<00:16, 2372.43 examples/s]
Map:  24%|       | 11984/50245 [00:05<00:16, 2384.62 examples/s]
Map:  24%|       | 12303/50245 [00:05<00:16, 2285.26 examples/s]
Map:  25%|       | 12671/50245 [00:05<00:16, 2339.60 examples/s]
Map:  26%|       | 12935/50245 [00:05<00:15, 2411.04 examples/s]
Map:  26%|       | 13262/50245 [00:05<00:15, 2329.40 examples/s]
Map:  27%|       | 13502/50245 [00:05<00:15, 2342.80 examples/s]
Map:  27%|       | 13744/50245 [00:06<00:15, 2359.85 examples/s]
Map:  28%|       | 13989/50245 [00:06<00:15, 2382.59 examples/s]
Map:  28%|       | 14300/50245 [00:06<00:15, 2263.80 examples/s]
Map:  29%|       | 14536/50245 [00:06<00:15, 2285.42 examples/s]
Map:  29%|       | 14785/50245 [00:06<00:15, 2337.73 examples/s]
Map:  30%|       | 15118/50245 [00:06<00:15, 2278.99 examples/s]
Map:  31%|       | 15357/50245 [00:06<00:15, 2304.66 examples/s]
Map:  31%|      | 15705/50245 [00:06<00:14, 2303.92 examples/s]
Map:  32%|      | 15948/50245 [00:06<00:14, 2333.69 examples/s]
Map:  32%|      | 16255/50245 [00:07<00:15, 2230.39 examples/s]
Map:  33%|      | 16513/50245 [00:07<00:14, 2314.01 examples/s]
Map:  33%|      | 16772/50245 [00:07<00:14, 2380.12 examples/s]
Map:  34%|      | 17125/50245 [00:07<00:14, 2292.13 examples/s]
Map:  35%|      | 17365/50245 [00:07<00:14, 2317.39 examples/s]
Map:  35%|      | 17616/50245 [00:07<00:13, 2366.26 examples/s]
Map:  36%|      | 17868/50245 [00:07<00:13, 2402.88 examples/s]
Map:  36%|      | 18185/50245 [00:07<00:14, 2289.19 examples/s]
Map:  37%|      | 18427/50245 [00:08<00:13, 2321.14 examples/s]
Map:  37%|      | 18672/50245 [00:08<00:13, 2353.18 examples/s]
Map:  38%|      | 18921/50245 [00:08<00:13, 2388.00 examples/s]
Map:  38%|      | 19255/50245 [00:08<00:13, 2286.45 examples/s]
Map:  39%|      | 19503/50245 [00:08<00:13, 2333.97 examples/s]
Map:  39%|      | 19744/50245 [00:08<00:12, 2353.91 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2275.17 examples/s]
Map:  40%|      | 20243/50245 [00:08<00:12, 2314.00 examples/s]
Map:  41%|      | 20494/50245 [00:08<00:12, 2366.05 examples/s]
Map:  41%|     | 20739/50245 [00:09<00:12, 2387.12 examples/s]
Map:  42%|     | 21044/50245 [00:09<00:12, 2248.79 examples/s]
Map:  42%|     | 21288/50245 [00:09<00:12, 2298.56 examples/s]
Map:  43%|     | 21532/50245 [00:09<00:12, 2336.14 examples/s]
Map:  43%|     | 21784/50245 [00:09<00:11, 2385.65 examples/s]
Map:  44%|     | 22125/50245 [00:09<00:12, 2255.96 examples/s]
Map:  45%|     | 22364/50245 [00:09<00:12, 2287.34 examples/s]
Map:  45%|     | 22609/50245 [00:09<00:11, 2328.58 examples/s]
Map:  45%|     | 22860/50245 [00:09<00:11, 2375.91 examples/s]
Map:  46%|     | 23166/50245 [00:10<00:12, 2248.01 examples/s]
Map:  47%|     | 23427/50245 [00:10<00:11, 2340.34 examples/s]
Map:  47%|     | 23671/50245 [00:10<00:11, 2363.28 examples/s]
Map:  48%|     | 23914/50245 [00:10<00:11, 2377.87 examples/s]
Map:  48%|     | 24227/50245 [00:10<00:11, 2224.07 examples/s]
Map:  49%|     | 24472/50245 [00:10<00:11, 2279.32 examples/s]
Map:  49%|     | 24718/50245 [00:10<00:10, 2324.90 examples/s]
Map:  50%|     | 24978/50245 [00:10<00:10, 2397.42 examples/s]
Map:  50%|     | 25296/50245 [00:11<00:10, 2289.23 examples/s]
Map:  51%|     | 25562/50245 [00:11<00:10, 2383.35 examples/s]
Map:  52%|    | 25915/50245 [00:11<00:10, 2369.44 examples/s]
Map:  52%|    | 26237/50245 [00:11<00:10, 2250.94 examples/s]
Map:  53%|    | 26479/50245 [00:11<00:10, 2290.26 examples/s]
Map:  53%|    | 26731/50245 [00:11<00:10, 2347.78 examples/s]
Map:  54%|    | 26979/50245 [00:11<00:09, 2378.97 examples/s]
Map:  54%|    | 27293/50245 [00:11<00:10, 2272.32 examples/s]
Map:  55%|    | 27554/50245 [00:11<00:09, 2356.77 examples/s]
Map:  55%|    | 27794/50245 [00:12<00:09, 2365.73 examples/s]
Map:  56%|    | 28108/50245 [00:12<00:09, 2229.37 examples/s]
Map:  56%|    | 28361/50245 [00:12<00:09, 2303.94 examples/s]
Map:  57%|    | 28608/50245 [00:12<00:09, 2345.54 examples/s]
Map:  57%|    | 28847/50245 [00:12<00:09, 2356.91 examples/s]
Map:  58%|    | 29168/50245 [00:12<00:09, 2273.86 examples/s]
Map:  59%|    | 29417/50245 [00:12<00:08, 2323.48 examples/s]
Map:  59%|    | 29776/50245 [00:12<00:08, 2344.66 examples/s]
Map:  60%|    | 30120/50245 [00:13<00:09, 2234.05 examples/s]
Map:  60%|    | 30369/50245 [00:13<00:08, 2293.56 examples/s]
Map:  61%|    | 30620/50245 [00:13<00:08, 2345.26 examples/s]
Map:  61%|   | 30862/50245 [00:13<00:08, 2362.31 examples/s]
Map:  62%|   | 31176/50245 [00:13<00:08, 2262.96 examples/s]
Map:  63%|   | 31421/50245 [00:13<00:08, 2306.85 examples/s]
Map:  63%|   | 31675/50245 [00:13<00:07, 2364.83 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2244.79 examples/s]
Map:  64%|   | 32236/50245 [00:14<00:07, 2272.41 examples/s]
Map:  65%|   | 32486/50245 [00:14<00:07, 2327.75 examples/s]
Map:  65%|   | 32742/50245 [00:14<00:07, 2388.58 examples/s]
Map:  66%|   | 32992/50245 [00:14<00:07, 2416.29 examples/s]
Map:  66%|   | 33318/50245 [00:14<00:07, 2323.90 examples/s]
Map:  67%|   | 33561/50245 [00:14<00:07, 2348.65 examples/s]
Map:  67%|   | 33800/50245 [00:14<00:06, 2356.18 examples/s]
Map:  68%|   | 34128/50245 [00:14<00:07, 2263.26 examples/s]
Map:  68%|   | 34385/50245 [00:14<00:06, 2340.48 examples/s]
Map:  69%|   | 34634/50245 [00:15<00:06, 2378.99 examples/s]
Map:  69%|   | 34894/50245 [00:15<00:06, 2438.19 examples/s]
Map:  70%|   | 35244/50245 [00:15<00:06, 2323.95 examples/s]
Map:  71%|   | 35487/50245 [00:15<00:06, 2348.47 examples/s]
Map:  71%|   | 35726/50245 [00:15<00:06, 2358.51 examples/s]
Map:  72%|  | 35975/50245 [00:15<00:05, 2391.70 examples/s]
Map:  72%|  | 36295/50245 [00:15<00:06, 2292.34 examples/s]
Map:  73%|  | 36549/50245 [00:15<00:05, 2354.53 examples/s]
Map:  73%|  | 36798/50245 [00:15<00:05, 2387.10 examples/s]
Map:  74%|  | 37116/50245 [00:16<00:05, 2231.76 examples/s]
Map:  75%|  | 37471/50245 [00:16<00:05, 2275.74 examples/s]
Map:  75%|  | 37711/50245 [00:16<00:05, 2302.70 examples/s]
Map:  76%|  | 37956/50245 [00:16<00:05, 2338.48 examples/s]
Map:  76%|  | 38258/50245 [00:16<00:05, 2216.81 examples/s]
Map:  77%|  | 38505/50245 [00:16<00:05, 2278.29 examples/s]
Map:  77%|  | 38764/50245 [00:16<00:04, 2358.43 examples/s]
Map:  78%|  | 39124/50245 [00:16<00:04, 2299.05 examples/s]
Map:  78%|  | 39373/50245 [00:17<00:04, 2344.34 examples/s]
Map:  79%|  | 39612/50245 [00:17<00:04, 2355.08 examples/s]
Map:  79%|  | 39862/50245 [00:17<00:04, 2392.60 examples/s]
Map:  80%|  | 40171/50245 [00:17<00:04, 2268.66 examples/s]
Map:  80%|  | 40440/50245 [00:17<00:04, 2376.21 examples/s]
Map:  81%|  | 40686/50245 [00:17<00:03, 2397.08 examples/s]
Map:  82%| | 41000/50245 [00:17<00:04, 2271.75 examples/s]
Map:  82%| | 41238/50245 [00:17<00:03, 2297.96 examples/s]
Map:  83%| | 41486/50245 [00:17<00:03, 2344.50 examples/s]
Map:  83%| | 41728/50245 [00:18<00:03, 2362.93 examples/s]
Map:  84%| | 42021/50245 [00:18<00:03, 2207.89 examples/s]
Map:  84%| | 42273/50245 [00:18<00:03, 2287.45 examples/s]
Map:  85%| | 42521/50245 [00:18<00:03, 2338.23 examples/s]
Map:  85%| | 42771/50245 [00:18<00:03, 2381.59 examples/s]
Map:  86%| | 43121/50245 [00:18<00:03, 2261.22 examples/s]
Map:  86%| | 43387/50245 [00:18<00:02, 2360.53 examples/s]
Map:  87%| | 43645/50245 [00:18<00:02, 2414.87 examples/s]
Map:  88%| | 44000/50245 [00:19<00:02, 2307.59 examples/s]
Map:  88%| | 44358/50245 [00:19<00:02, 2330.35 examples/s]
Map:  89%| | 44600/50245 [00:19<00:02, 2350.47 examples/s]
Map:  89%| | 44850/50245 [00:19<00:02, 2385.53 examples/s]
Map:  90%| | 45166/50245 [00:19<00:02, 2283.31 examples/s]
Map:  90%| | 45401/50245 [00:19<00:02, 2297.37 examples/s]
Map:  91%| | 45654/50245 [00:19<00:01, 2356.58 examples/s]
Map:  91%|| 45903/50245 [00:19<00:01, 2389.41 examples/s]
Map:  92%|| 46245/50245 [00:20<00:01, 2276.86 examples/s]
Map:  93%|| 46500/50245 [00:20<00:01, 2342.43 examples/s]
Map:  93%|| 46744/50245 [00:20<00:01, 2364.10 examples/s]
Map:  94%|| 47000/50245 [00:20<00:01, 2280.41 examples/s]
Map:  94%|| 47247/50245 [00:20<00:01, 2328.96 examples/s]
Map:  95%|| 47601/50245 [00:20<00:01, 2334.83 examples/s]
Map:  95%|| 47928/50245 [00:20<00:01, 1788.38 examples/s]
Map:  96%|| 48256/50245 [00:21<00:01, 1887.76 examples/s]
Map:  97%|| 48518/50245 [00:21<00:00, 2039.15 examples/s]
Map:  97%|| 48764/50245 [00:21<00:00, 2133.86 examples/s]
Map:  98%|| 49000/50245 [00:21<00:00, 2099.30 examples/s]
Map:  98%|| 49238/50245 [00:21<00:00, 2167.79 examples/s]
Map:  98%|| 49472/50245 [00:21<00:00, 2211.81 examples/s]
Map:  99%|| 49719/50245 [00:21<00:00, 2280.23 examples/s]
Map:  99%|| 49958/50245 [00:21<00:00, 2310.01 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2136.58 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2294.64 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [23] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14cbf2dee4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14cbf2db8434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14cc1e3578c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14cc1e358572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14cc1e3585f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14cc1e317ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14cc1e317ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14cc1e317ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14cbf3d7dc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14cbf3d81901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14cbf3d88a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14cbf3d89e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14cbf3d8caed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14cbf3d9ba41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14cc1e30c2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14cc1e31002a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14cc1e31ee90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14cc3299cfee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14cc321e8285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14cc6be56cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 23 STDERR----------
Global rank 28 (PID 178921) exited with code 143
Global rank 29 (PID 178922) exited with code 1
----------Begin global rank 29 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 29 STDOUT----------
----------Begin global rank 29 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 245/50245 [00:00<00:20, 2433.75 examples/s]
Map:   1%|          | 503/50245 [00:00<00:19, 2512.58 examples/s]
Map:   2%|         | 762/50245 [00:00<00:19, 2541.70 examples/s]
Map:   2%|         | 1120/50245 [00:00<00:21, 2308.93 examples/s]
Map:   3%|         | 1471/50245 [00:00<00:21, 2317.90 examples/s]
Map:   3%|         | 1711/50245 [00:00<00:20, 2334.62 examples/s]
Map:   4%|         | 1960/50245 [00:00<00:20, 2375.76 examples/s]
Map:   5%|         | 2283/50245 [00:00<00:20, 2287.55 examples/s]
Map:   5%|         | 2522/50245 [00:01<00:20, 2312.52 examples/s]
Map:   5%|         | 2762/50245 [00:01<00:20, 2334.46 examples/s]
Map:   6%|         | 3000/50245 [00:01<00:21, 2215.66 examples/s]
Map:   6%|         | 3232/50245 [00:01<00:20, 2241.86 examples/s]
Map:   7%|         | 3487/50245 [00:01<00:20, 2326.66 examples/s]
Map:   8%|         | 3839/50245 [00:01<00:19, 2327.89 examples/s]
Map:   8%|         | 4146/50245 [00:01<00:20, 2225.11 examples/s]
Map:   9%|         | 4382/50245 [00:01<00:20, 2257.51 examples/s]
Map:   9%|         | 4631/50245 [00:02<00:19, 2315.40 examples/s]
Map:  10%|         | 4973/50245 [00:02<00:19, 2296.72 examples/s]
Map:  11%|         | 5297/50245 [00:02<00:20, 2244.62 examples/s]
Map:  11%|         | 5552/50245 [00:02<00:19, 2316.69 examples/s]
Map:  12%|        | 5797/50245 [00:02<00:18, 2347.79 examples/s]
Map:  12%|        | 6127/50245 [00:02<00:19, 2285.13 examples/s]
Map:  13%|        | 6375/50245 [00:02<00:18, 2331.07 examples/s]
Map:  13%|        | 6628/50245 [00:02<00:18, 2382.66 examples/s]
Map:  14%|        | 6888/50245 [00:02<00:17, 2440.60 examples/s]
Map:  14%|        | 7254/50245 [00:03<00:18, 2349.41 examples/s]
Map:  15%|        | 7498/50245 [00:03<00:18, 2368.09 examples/s]
Map:  16%|        | 7869/50245 [00:03<00:17, 2401.42 examples/s]
Map:  16%|        | 8129/50245 [00:03<00:18, 2324.46 examples/s]
Map:  17%|        | 8373/50245 [00:03<00:17, 2352.75 examples/s]
Map:  17%|        | 8626/50245 [00:03<00:17, 2397.71 examples/s]
Map:  18%|        | 8880/50245 [00:03<00:16, 2436.63 examples/s]
Map:  18%|        | 9251/50245 [00:03<00:17, 2352.91 examples/s]
Map:  19%|        | 9516/50245 [00:04<00:16, 2426.22 examples/s]
Map:  20%|        | 9879/50245 [00:04<00:16, 2420.27 examples/s]
Map:  20%|        | 10129/50245 [00:04<00:17, 2305.04 examples/s]
Map:  21%|        | 10367/50245 [00:04<00:17, 2318.01 examples/s]
Map:  21%|        | 10612/50245 [00:04<00:16, 2347.94 examples/s]
Map:  22%|       | 10876/50245 [00:04<00:16, 2426.62 examples/s]
Map:  22%|       | 11196/50245 [00:04<00:16, 2314.95 examples/s]
Map:  23%|       | 11437/50245 [00:04<00:16, 2336.63 examples/s]
Map:  23%|       | 11694/50245 [00:04<00:16, 2397.92 examples/s]
Map:  24%|       | 11946/50245 [00:05<00:15, 2430.48 examples/s]
Map:  24%|       | 12275/50245 [00:05<00:16, 2335.24 examples/s]
Map:  25%|       | 12513/50245 [00:05<00:16, 2343.72 examples/s]
Map:  25%|       | 12783/50245 [00:05<00:15, 2438.17 examples/s]
Map:  26%|       | 13129/50245 [00:05<00:15, 2358.85 examples/s]
Map:  27%|       | 13392/50245 [00:05<00:15, 2425.22 examples/s]
Map:  27%|       | 13751/50245 [00:05<00:15, 2410.06 examples/s]
Map:  28%|       | 14000/50245 [00:05<00:15, 2308.21 examples/s]
Map:  28%|       | 14243/50245 [00:06<00:15, 2332.35 examples/s]
Map:  29%|       | 14485/50245 [00:06<00:15, 2352.87 examples/s]
Map:  29%|       | 14740/50245 [00:06<00:14, 2404.53 examples/s]
Map:  30%|       | 15000/50245 [00:06<00:15, 2324.57 examples/s]
Map:  30%|       | 15246/50245 [00:06<00:14, 2358.07 examples/s]
Map:  31%|       | 15599/50245 [00:06<00:14, 2354.01 examples/s]
Map:  32%|      | 15854/50245 [00:06<00:14, 2401.84 examples/s]
Map:  32%|      | 16171/50245 [00:06<00:14, 2293.12 examples/s]
Map:  33%|      | 16408/50245 [00:06<00:14, 2311.86 examples/s]
Map:  33%|      | 16676/50245 [00:07<00:13, 2407.28 examples/s]
Map:  34%|      | 16931/50245 [00:07<00:13, 2444.08 examples/s]
Map:  34%|      | 17254/50245 [00:07<00:14, 2332.97 examples/s]
Map:  35%|      | 17495/50245 [00:07<00:13, 2351.98 examples/s]
Map:  35%|      | 17752/50245 [00:07<00:13, 2409.04 examples/s]
Map:  36%|      | 18000/50245 [00:07<00:14, 2293.33 examples/s]
Map:  36%|      | 18257/50245 [00:07<00:13, 2363.31 examples/s]
Map:  37%|      | 18509/50245 [00:07<00:13, 2405.39 examples/s]
Map:  38%|      | 18874/50245 [00:08<00:13, 2410.19 examples/s]
Map:  38%|      | 19205/50245 [00:08<00:13, 2334.79 examples/s]
Map:  39%|      | 19453/50245 [00:08<00:13, 2367.71 examples/s]
Map:  39%|      | 19704/50245 [00:08<00:12, 2401.91 examples/s]
Map:  40%|      | 19964/50245 [00:08<00:12, 2452.59 examples/s]
Map:  40%|      | 20285/50245 [00:08<00:12, 2334.80 examples/s]
Map:  41%|      | 20545/50245 [00:08<00:12, 2400.18 examples/s]
Map:  42%|     | 20908/50245 [00:08<00:12, 2405.56 examples/s]
Map:  42%|     | 21254/50245 [00:09<00:12, 2322.28 examples/s]
Map:  43%|     | 21499/50245 [00:09<00:12, 2349.52 examples/s]
Map:  43%|     | 21757/50245 [00:09<00:11, 2404.73 examples/s]
Map:  44%|     | 22127/50245 [00:09<00:12, 2301.65 examples/s]
Map:  45%|     | 22368/50245 [00:09<00:11, 2325.95 examples/s]
Map:  45%|     | 22617/50245 [00:09<00:11, 2364.86 examples/s]
Map:  46%|     | 22874/50245 [00:09<00:11, 2417.09 examples/s]
Map:  46%|     | 23185/50245 [00:09<00:11, 2288.89 examples/s]
Map:  47%|     | 23448/50245 [00:09<00:11, 2372.19 examples/s]
Map:  47%|     | 23802/50245 [00:10<00:11, 2367.25 examples/s]
Map:  48%|     | 24121/50245 [00:10<00:11, 2274.60 examples/s]
Map:  48%|     | 24358/50245 [00:10<00:11, 2295.79 examples/s]
Map:  49%|     | 24721/50245 [00:10<00:10, 2335.37 examples/s]
Map:  50%|     | 24986/50245 [00:10<00:10, 2409.41 examples/s]
Map:  50%|     | 25307/50245 [00:10<00:10, 2312.40 examples/s]
Map:  51%|     | 25576/50245 [00:10<00:10, 2403.70 examples/s]
Map:  52%|    | 25928/50245 [00:11<00:10, 2381.29 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2266.89 examples/s]
Map:  53%|    | 26484/50245 [00:11<00:10, 2308.75 examples/s]
Map:  53%|    | 26739/50245 [00:11<00:09, 2369.26 examples/s]
Map:  54%|    | 26987/50245 [00:11<00:09, 2396.66 examples/s]
Map:  54%|    | 27306/50245 [00:11<00:09, 2294.51 examples/s]
Map:  55%|    | 27565/50245 [00:11<00:09, 2368.16 examples/s]
Map:  56%|    | 27937/50245 [00:11<00:09, 2404.69 examples/s]
Map:  56%|    | 28235/50245 [00:12<00:09, 2258.19 examples/s]
Map:  57%|    | 28495/50245 [00:12<00:09, 2338.00 examples/s]
Map:  57%|    | 28737/50245 [00:12<00:09, 2357.56 examples/s]
Map:  58%|    | 28987/50245 [00:12<00:08, 2393.63 examples/s]
Map:  58%|    | 29305/50245 [00:12<00:09, 2291.38 examples/s]
Map:  59%|    | 29540/50245 [00:12<00:08, 2304.99 examples/s]
Map:  59%|    | 29785/50245 [00:12<00:08, 2340.95 examples/s]
Map:  60%|    | 30120/50245 [00:12<00:09, 2232.16 examples/s]
Map:  60%|    | 30372/50245 [00:12<00:08, 2300.97 examples/s]
Map:  61%|    | 30626/50245 [00:13<00:08, 2364.02 examples/s]
Map:  61%|   | 30870/50245 [00:13<00:08, 2379.85 examples/s]
Map:  62%|   | 31188/50245 [00:13<00:08, 2278.82 examples/s]
Map:  63%|   | 31439/50245 [00:13<00:08, 2335.27 examples/s]
Map:  63%|   | 31691/50245 [00:13<00:07, 2382.65 examples/s]
Map:  64%|   | 32001/50245 [00:13<00:08, 2262.97 examples/s]
Map:  64%|   | 32240/50245 [00:13<00:07, 2293.55 examples/s]
Map:  65%|   | 32491/50245 [00:13<00:07, 2349.49 examples/s]
Map:  65%|   | 32749/50245 [00:13<00:07, 2412.20 examples/s]
Map:  66%|   | 33000/50245 [00:14<00:07, 2298.24 examples/s]
Map:  66%|   | 33254/50245 [00:14<00:07, 2362.46 examples/s]
Map:  67%|   | 33509/50245 [00:14<00:06, 2414.15 examples/s]
Map:  67%|   | 33877/50245 [00:14<00:06, 2425.34 examples/s]
Map:  68%|   | 34130/50245 [00:14<00:06, 2305.60 examples/s]
Map:  68%|   | 34389/50245 [00:14<00:06, 2378.22 examples/s]
Map:  69%|   | 34642/50245 [00:14<00:06, 2418.17 examples/s]
Map:  69%|   | 34905/50245 [00:14<00:06, 2475.70 examples/s]
Map:  70%|   | 35244/50245 [00:15<00:06, 2334.11 examples/s]
Map:  71%|   | 35486/50245 [00:15<00:06, 2354.60 examples/s]
Map:  71%|   | 35728/50245 [00:15<00:06, 2369.76 examples/s]
Map:  72%|  | 35981/50245 [00:15<00:05, 2411.45 examples/s]
Map:  72%|  | 36302/50245 [00:15<00:06, 2304.44 examples/s]
Map:  73%|  | 36560/50245 [00:15<00:05, 2372.70 examples/s]
Map:  73%|  | 36812/50245 [00:15<00:05, 2410.16 examples/s]
Map:  74%|  | 37117/50245 [00:15<00:05, 2252.79 examples/s]
Map:  75%|  | 37475/50245 [00:15<00:05, 2295.18 examples/s]
Map:  75%|  | 37717/50245 [00:16<00:05, 2323.88 examples/s]
Map:  76%|  | 37964/50245 [00:16<00:05, 2357.02 examples/s]
Map:  76%|  | 38269/50245 [00:16<00:05, 2238.21 examples/s]
Map:  77%|  | 38520/50245 [00:16<00:05, 2304.34 examples/s]
Map:  77%|  | 38781/50245 [00:16<00:04, 2378.78 examples/s]
Map:  78%|  | 39126/50245 [00:16<00:04, 2323.79 examples/s]
Map:  78%|  | 39379/50245 [00:16<00:04, 2374.49 examples/s]
Map:  79%|  | 39744/50245 [00:16<00:04, 2391.28 examples/s]
Map:  80%|  | 40043/50245 [00:17<00:04, 2255.07 examples/s]
Map:  80%|  | 40301/50245 [00:17<00:04, 2331.22 examples/s]
Map:  81%|  | 40556/50245 [00:17<00:04, 2384.14 examples/s]
Map:  81%|  | 40812/50245 [00:17<00:03, 2428.92 examples/s]
Map:  82%| | 41129/50245 [00:17<00:03, 2285.71 examples/s]
Map:  83%| | 41478/50245 [00:17<00:03, 2293.71 examples/s]
Map:  83%| | 41720/50245 [00:17<00:03, 2322.47 examples/s]
Map:  84%| | 42007/50245 [00:17<00:03, 2178.61 examples/s]
Map:  84%| | 42255/50245 [00:18<00:03, 2250.74 examples/s]
Map:  85%| | 42493/50245 [00:18<00:03, 2280.68 examples/s]
Map:  85%| | 42746/50245 [00:18<00:03, 2344.28 examples/s]
Map:  86%| | 43041/50245 [00:18<00:03, 2204.52 examples/s]
Map:  86%| | 43301/50245 [00:18<00:03, 2303.63 examples/s]
Map:  87%| | 43659/50245 [00:18<00:02, 2332.78 examples/s]
Map:  87%| | 43899/50245 [00:18<00:02, 2347.97 examples/s]
Map:  88%| | 44229/50245 [00:18<00:02, 2224.70 examples/s]
Map:  88%| | 44463/50245 [00:18<00:02, 2250.67 examples/s]
Map:  89%| | 44715/50245 [00:19<00:02, 2312.83 examples/s]
Map:  89%| | 44954/50245 [00:19<00:02, 2330.80 examples/s]
Map:  90%| | 45251/50245 [00:19<00:02, 2199.89 examples/s]
Map:  91%| | 45486/50245 [00:19<00:02, 2231.31 examples/s]
Map:  91%| | 45720/50245 [00:19<00:02, 2258.83 examples/s]
Map:  91%|| 45968/50245 [00:19<00:01, 2316.14 examples/s]
Map:  92%|| 46272/50245 [00:19<00:01, 2204.95 examples/s]
Map:  93%|| 46521/50245 [00:19<00:01, 2277.06 examples/s]
Map:  93%|| 46761/50245 [00:19<00:01, 2307.30 examples/s]
Map:  94%|| 47000/50245 [00:20<00:01, 2209.44 examples/s]
Map:  94%|| 47241/50245 [00:20<00:01, 2262.30 examples/s]
Map:  95%|| 47579/50245 [00:20<00:01, 2254.62 examples/s]
Map:  95%|| 47921/50245 [00:20<00:01, 1742.62 examples/s]
Map:  96%|| 48122/50245 [00:20<00:01, 1770.52 examples/s]
Map:  96%|| 48380/50245 [00:20<00:00, 1948.05 examples/s]
Map:  97%|| 48630/50245 [00:20<00:00, 2076.64 examples/s]
Map:  97%|| 48870/50245 [00:21<00:00, 2155.97 examples/s]
Map:  98%|| 49176/50245 [00:21<00:00, 2113.01 examples/s]
Map:  98%|| 49403/50245 [00:21<00:00, 2149.32 examples/s]
Map:  99%|| 49641/50245 [00:21<00:00, 2208.65 examples/s]
Map:  99%|| 49878/50245 [00:21<00:00, 2250.19 examples/s]
Map: 100%|| 50119/50245 [00:21<00:00, 2152.85 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2308.64 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [29] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x148d390ab4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x148d39075434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x148d646148c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x148d64615572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x148d646155f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148d645d4ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148d645d4ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x148d645d4ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x148d3a03ac4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x148d3a03e901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x148d3a045a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x148d3a046e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x148d3a049aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x148d3a058a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x148d645c92d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x148d645cd02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x148d645dbe90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x148d78c59fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x148d784a5285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x148db2113cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 29 STDERR----------
Global rank 30 (PID 178923) exited with code 1
----------Begin global rank 30 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 30 STDOUT----------
----------Begin global rank 30 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 8299.69 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:04, 9804.20 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 10168.43 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 10445.09 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:03, 10536.40 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:03, 10592.24 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 10681.04 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 10705.69 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 10704.00 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:02, 10727.15 examples/s]
Filter:  42%|     | 21000/50245 [00:01<00:02, 10749.32 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 10704.01 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 10678.01 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 10678.45 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:01, 10682.87 examples/s]
Filter:  62%|   | 31000/50245 [00:02<00:01, 10700.24 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 10667.33 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 10731.15 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 10726.11 examples/s]
Filter:  78%|  | 39000/50245 [00:03<00:01, 10703.04 examples/s]
Filter:  82%| | 41000/50245 [00:03<00:00, 10720.44 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 10703.01 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 10742.50 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 10739.37 examples/s]
Filter:  98%|| 49000/50245 [00:04<00:00, 10753.44 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10694.85 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10632.37 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 9070.02 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9402.47 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:04, 9519.90 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 9552.77 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9586.05 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9679.57 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9753.79 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9756.74 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9801.84 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9811.92 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9800.63 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9783.18 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9897.37 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9902.30 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9799.25 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9821.17 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:03, 9815.67 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9845.40 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:02, 9815.57 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9795.27 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9782.78 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9762.33 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9716.33 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9775.99 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9757.29 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:02, 9792.83 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9749.05 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:01, 9727.54 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9734.90 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9766.58 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9781.41 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9864.32 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9860.93 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 9777.37 examples/s]
Filter:  78%|  | 39000/50245 [00:03<00:01, 9820.58 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9807.69 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9851.43 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9759.29 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9817.47 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9874.96 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9849.28 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 9869.25 examples/s]
Filter:  96%|| 48000/50245 [00:04<00:00, 9799.19 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9844.52 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9773.56 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [30] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x1507285154d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x1507284df434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x150753a7e8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x150753a7f572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x150753a7f5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150753a3eac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150753a3eac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x150753a3eac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x1507294a4c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x1507294a8901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x1507294afa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x1507294b0e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x1507294b3aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x1507294c2a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x150753a332d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x150753a3702a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x150753a45e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x1507680c3fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x15076790f285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x1507a157dcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 30 STDERR----------
Global rank 31 (PID 178924) exited with code 1
----------Begin global rank 31 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 31 STDOUT----------
----------Begin global rank 31 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 8586.09 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:04, 9832.19 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 10124.70 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 10322.30 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:03, 10437.86 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:03, 10475.03 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 10562.26 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 10584.51 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 10579.63 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:02, 10567.57 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:02, 10539.81 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 10529.81 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 10518.70 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 10541.41 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:02, 10537.53 examples/s]
Filter:  62%|   | 31000/50245 [00:02<00:01, 10565.08 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 10593.71 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 10646.24 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 10633.73 examples/s]
Filter:  78%|  | 39000/50245 [00:03<00:01, 10537.91 examples/s]
Filter:  82%| | 41000/50245 [00:03<00:00, 10584.88 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 10569.02 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 10625.76 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 10624.02 examples/s]
Filter:  98%|| 49000/50245 [00:04<00:00, 10636.62 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10563.88 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10513.37 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 9387.26 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9214.57 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 9321.07 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 9379.91 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9392.45 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9447.04 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9543.24 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9553.20 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9592.31 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9583.10 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9573.86 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9564.77 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9612.90 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9612.87 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9617.38 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9564.58 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9617.58 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9560.85 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:03, 9606.33 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9583.13 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9481.06 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9433.45 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9385.78 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9403.86 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9299.31 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9338.20 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9293.59 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 9325.99 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9269.14 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9215.40 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9068.91 examples/s]
ERROR:composer.cli.launcher:Global rank 28 (PID 178921) exited with code 143
Filter:  64%|   | 32000/50245 [00:03<00:01, 9130.85 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9181.04 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9177.34 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9304.36 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9276.57 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9302.06 examples/s]
Filter:  76%|  | 38000/50245 [00:04<00:01, 9218.67 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9357.83 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9305.76 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9344.91 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9237.95 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9296.31 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9352.85 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9343.13 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9304.04 examples/s]
Filter:  94%|| 47000/50245 [00:05<00:00, 9329.78 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9247.30 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9296.67 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9249.51 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9330.48 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [31] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x149d3dab94d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x149d3da83434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x149d690228c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x149d69023572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x149d690235f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149d68fe2ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149d68fe2ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149d68fe2ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x149d3ea48c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x149d3ea4c901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x149d3ea53a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x149d3ea54e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x149d3ea57aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x149d3ea66a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x149d68fd72d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x149d68fdb02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x149d68fe9e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x149d7d667fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x149d7ceb3285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x149db6b21cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 31 STDERR----------
Global rank 24 (PID 145817) exited with code 143
Global rank 25 (PID 145818) exited with code 1
----------Begin global rank 25 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 25 STDOUT----------
----------Begin global rank 25 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:06, 8059.85 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:04, 9757.96 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 10146.81 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 10432.90 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:03, 10532.13 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:03, 10591.80 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 10646.12 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 10673.49 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 10688.70 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:02, 10721.25 examples/s]
Filter:  42%|     | 21000/50245 [00:01<00:02, 10756.10 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 10724.18 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 10686.00 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 10693.94 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:01, 10653.41 examples/s]
Filter:  62%|   | 31000/50245 [00:02<00:01, 10673.80 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 10704.69 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 10778.72 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 10766.81 examples/s]
Filter:  78%|  | 39000/50245 [00:03<00:01, 10730.47 examples/s]
Filter:  82%| | 41000/50245 [00:03<00:00, 10763.62 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 10737.23 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 10789.09 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 10792.24 examples/s]
Filter:  98%|| 49000/50245 [00:04<00:00, 10801.56 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10746.41 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10644.91 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 8958.47 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9342.81 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:04, 9488.62 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 9559.29 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9581.35 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9664.67 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9755.46 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9785.63 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9805.09 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9801.21 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:03, 9812.41 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9814.55 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9885.49 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9879.06 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9826.04 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9857.92 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:03, 9866.97 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:02, 9905.44 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9883.88 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9836.84 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9823.65 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9789.06 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9805.09 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 9842.84 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:02, 9763.48 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9728.36 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:01, 9790.07 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9838.82 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9874.14 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9861.42 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9904.35 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9913.37 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 9834.17 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9876.10 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9887.65 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9805.23 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9850.99 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9897.02 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9879.39 examples/s]
Filter:  96%|| 48000/50245 [00:04<00:00, 9830.48 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9868.94 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9803.53 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [25] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x149b4c97c4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x149b4c946434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x149b77ee58c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x149b77ee6572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x149b77ee65f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149b77ea5ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149b77ea5ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149b77ea5ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x149b4d90bc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x149b4d90f901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x149b4d916a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x149b4d917e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x149b4d91aaed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x149b4d929a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x149b77e9a2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x149b77e9e02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x149b77eace90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x149b8c52afee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x149b8bd76285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x149bc59e4cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 25 STDERR----------
Global rank 26 (PID 145819) exited with code 1
----------Begin global rank 26 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 26 STDOUT----------
----------Begin global rank 26 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 244/50245 [00:00<00:20, 2402.95 examples/s]
Map:   1%|          | 499/50245 [00:00<00:20, 2486.19 examples/s]
Map:   2%|         | 756/50245 [00:00<00:19, 2517.86 examples/s]
Map:   2%|         | 1118/50245 [00:00<00:21, 2280.66 examples/s]
Map:   3%|         | 1468/50245 [00:00<00:21, 2295.10 examples/s]
Map:   3%|         | 1703/50245 [00:00<00:21, 2307.80 examples/s]
Map:   4%|         | 1945/50245 [00:00<00:20, 2336.47 examples/s]
Map:   5%|         | 2268/50245 [00:00<00:21, 2261.37 examples/s]
Map:   5%|         | 2505/50245 [00:01<00:20, 2287.92 examples/s]
Map:   5%|         | 2747/50245 [00:01<00:20, 2317.87 examples/s]
Map:   6%|         | 3046/50245 [00:01<00:21, 2191.88 examples/s]
Map:   7%|         | 3276/50245 [00:01<00:21, 2216.45 examples/s]
Map:   7%|         | 3527/50245 [00:01<00:20, 2293.84 examples/s]
Map:   8%|         | 3871/50245 [00:01<00:20, 2288.05 examples/s]
Map:   8%|         | 4174/50245 [00:01<00:20, 2195.11 examples/s]
Map:   9%|         | 4411/50245 [00:01<00:20, 2234.84 examples/s]
Map:   9%|         | 4658/50245 [00:02<00:19, 2288.44 examples/s]
Map:  10%|         | 4993/50245 [00:02<00:19, 2265.96 examples/s]
Map:  11%|         | 5311/50245 [00:02<00:20, 2214.82 examples/s]
Map:  11%|         | 5566/50245 [00:02<00:19, 2293.44 examples/s]
Map:  12%|        | 5805/50245 [00:02<00:19, 2315.50 examples/s]
Map:  12%|        | 6128/50245 [00:02<00:19, 2254.60 examples/s]
Map:  13%|        | 6371/50245 [00:02<00:19, 2298.08 examples/s]
Map:  13%|        | 6624/50245 [00:02<00:18, 2351.95 examples/s]
Map:  14%|        | 6878/50245 [00:02<00:18, 2402.29 examples/s]
Map:  14%|        | 7252/50245 [00:03<00:18, 2317.50 examples/s]
Map:  15%|        | 7492/50245 [00:03<00:18, 2334.89 examples/s]
Map:  15%|        | 7729/50245 [00:03<00:18, 2342.01 examples/s]
Map:  16%|        | 7982/50245 [00:03<00:17, 2391.26 examples/s]
Map:  17%|        | 8303/50245 [00:03<00:18, 2294.57 examples/s]
Map:  17%|        | 8542/50245 [00:03<00:18, 2316.75 examples/s]
Map:  18%|        | 8798/50245 [00:03<00:17, 2377.74 examples/s]
Map:  18%|        | 9119/50245 [00:03<00:18, 2279.13 examples/s]
Map:  19%|        | 9374/50245 [00:04<00:17, 2344.98 examples/s]
Map:  19%|        | 9613/50245 [00:04<00:17, 2356.20 examples/s]
Map:  20%|        | 9856/50245 [00:04<00:17, 2371.72 examples/s]
Map:  20%|        | 10167/50245 [00:04<00:17, 2256.70 examples/s]
Map:  21%|        | 10397/50245 [00:04<00:17, 2263.49 examples/s]
Map:  21%|        | 10640/50245 [00:04<00:17, 2304.45 examples/s]
Map:  22%|       | 10898/50245 [00:04<00:16, 2379.40 examples/s]
Map:  22%|       | 11245/50245 [00:04<00:17, 2275.55 examples/s]
Map:  23%|       | 11488/50245 [00:04<00:16, 2311.25 examples/s]
Map:  23%|       | 11745/50245 [00:05<00:16, 2376.65 examples/s]
Map:  24%|       | 11989/50245 [00:05<00:15, 2391.76 examples/s]
Map:  24%|       | 12309/50245 [00:05<00:16, 2292.82 examples/s]
Map:  25%|       | 12675/50245 [00:05<00:16, 2340.76 examples/s]
Map:  26%|       | 12939/50245 [00:05<00:15, 2414.10 examples/s]
Map:  26%|       | 13265/50245 [00:05<00:15, 2328.31 examples/s]
Map:  27%|       | 13504/50245 [00:05<00:15, 2340.96 examples/s]
Map:  27%|       | 13745/50245 [00:05<00:15, 2358.66 examples/s]
Map:  28%|       | 13989/50245 [00:06<00:15, 2379.33 examples/s]
Map:  28%|       | 14300/50245 [00:06<00:15, 2263.04 examples/s]
Map:  29%|       | 14535/50245 [00:06<00:15, 2282.70 examples/s]
Map:  29%|       | 14784/50245 [00:06<00:15, 2335.67 examples/s]
Map:  30%|       | 15123/50245 [00:06<00:15, 2285.70 examples/s]
Map:  31%|       | 15366/50245 [00:06<00:15, 2318.47 examples/s]
Map:  31%|      | 15720/50245 [00:06<00:14, 2327.19 examples/s]
Map:  32%|      | 15965/50245 [00:06<00:14, 2356.68 examples/s]
Map:  32%|      | 16271/50245 [00:07<00:15, 2243.85 examples/s]
Map:  33%|      | 16529/50245 [00:07<00:14, 2323.98 examples/s]
Map:  33%|      | 16787/50245 [00:07<00:14, 2387.51 examples/s]
Map:  34%|      | 17125/50245 [00:07<00:14, 2294.91 examples/s]
Map:  35%|      | 17364/50245 [00:07<00:14, 2315.90 examples/s]
Map:  35%|      | 17614/50245 [00:07<00:13, 2363.59 examples/s]
Map:  36%|      | 17865/50245 [00:07<00:13, 2401.47 examples/s]
Map:  36%|      | 18183/50245 [00:07<00:13, 2294.87 examples/s]
Map:  37%|      | 18425/50245 [00:07<00:13, 2325.24 examples/s]
Map:  37%|      | 18671/50245 [00:08<00:13, 2360.05 examples/s]
Map:  38%|      | 18919/50245 [00:08<00:13, 2392.44 examples/s]
Map:  38%|      | 19258/50245 [00:08<00:13, 2288.80 examples/s]
Map:  39%|      | 19506/50245 [00:08<00:13, 2336.48 examples/s]
Map:  39%|      | 19747/50245 [00:08<00:12, 2355.74 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2280.34 examples/s]
Map:  40%|      | 20244/50245 [00:08<00:12, 2322.31 examples/s]
Map:  41%|      | 20495/50245 [00:08<00:12, 2370.89 examples/s]
Map:  41%|     | 20739/50245 [00:08<00:12, 2389.48 examples/s]
Map:  42%|     | 21047/50245 [00:09<00:12, 2254.15 examples/s]
Map:  42%|     | 21295/50245 [00:09<00:12, 2311.60 examples/s]
Map:  43%|     | 21539/50245 [00:09<00:12, 2343.80 examples/s]
Map:  43%|     | 21790/50245 [00:09<00:11, 2389.44 examples/s]
Map:  44%|     | 22125/50245 [00:09<00:12, 2257.04 examples/s]
Map:  45%|     | 22363/50245 [00:09<00:12, 2287.15 examples/s]
Map:  45%|     | 22607/50245 [00:09<00:11, 2325.16 examples/s]
Map:  45%|     | 22859/50245 [00:09<00:11, 2376.53 examples/s]
Map:  46%|     | 23167/50245 [00:10<00:12, 2253.60 examples/s]
Map:  47%|     | 23427/50245 [00:10<00:11, 2342.42 examples/s]
Map:  47%|     | 23669/50245 [00:10<00:11, 2361.54 examples/s]
Map:  48%|     | 23912/50245 [00:10<00:11, 2376.55 examples/s]
Map:  48%|     | 24227/50245 [00:10<00:11, 2217.73 examples/s]
Map:  49%|     | 24471/50245 [00:10<00:11, 2271.11 examples/s]
Map:  49%|     | 24716/50245 [00:10<00:11, 2316.53 examples/s]
Map:  50%|     | 24977/50245 [00:10<00:10, 2394.20 examples/s]
Map:  50%|     | 25298/50245 [00:10<00:10, 2296.31 examples/s]
Map:  51%|     | 25563/50245 [00:11<00:10, 2383.84 examples/s]
Map:  52%|    | 25916/50245 [00:11<00:10, 2368.41 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2246.68 examples/s]
Map:  53%|    | 26482/50245 [00:11<00:10, 2287.07 examples/s]
Map:  53%|    | 26736/50245 [00:11<00:10, 2346.82 examples/s]
Map:  54%|    | 26984/50245 [00:11<00:09, 2379.07 examples/s]
Map:  54%|    | 27298/50245 [00:11<00:10, 2271.98 examples/s]
Map:  55%|    | 27558/50245 [00:11<00:09, 2355.21 examples/s]
Map:  56%|    | 27928/50245 [00:12<00:09, 2390.43 examples/s]
Map:  56%|    | 28232/50245 [00:12<00:09, 2238.87 examples/s]
Map:  57%|    | 28490/50245 [00:12<00:09, 2318.51 examples/s]
Map:  57%|    | 28729/50245 [00:12<00:09, 2333.02 examples/s]
Map:  58%|    | 28978/50245 [00:12<00:08, 2374.09 examples/s]
Map:  58%|    | 29292/50245 [00:12<00:09, 2270.48 examples/s]
Map:  59%|    | 29525/50245 [00:12<00:09, 2284.73 examples/s]
Map:  59%|    | 29768/50245 [00:12<00:08, 2318.80 examples/s]
Map:  60%|    | 30120/50245 [00:13<00:09, 2199.41 examples/s]
Map:  60%|    | 30367/50245 [00:13<00:08, 2265.74 examples/s]
Map:  61%|    | 30617/50245 [00:13<00:08, 2323.67 examples/s]
Map:  61%|   | 30861/50245 [00:13<00:08, 2349.74 examples/s]
Map:  62%|   | 31175/50245 [00:13<00:08, 2253.52 examples/s]
Map:  63%|   | 31419/50245 [00:13<00:08, 2298.62 examples/s]
Map:  63%|   | 31673/50245 [00:13<00:07, 2361.24 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2247.00 examples/s]
Map:  64%|   | 32234/50245 [00:13<00:07, 2270.26 examples/s]
Map:  65%|   | 32474/50245 [00:14<00:07, 2302.87 examples/s]
Map:  65%|   | 32722/50245 [00:14<00:07, 2349.96 examples/s]
Map:  66%|   | 32970/50245 [00:14<00:07, 2383.64 examples/s]
Map:  66%|   | 33292/50245 [00:14<00:07, 2287.68 examples/s]
Map:  67%|   | 33539/50245 [00:14<00:07, 2333.66 examples/s]
Map:  67%|   | 33897/50245 [00:14<00:06, 2350.28 examples/s]
Map:  68%|   | 34251/50245 [00:14<00:07, 2255.44 examples/s]
Map:  69%|   | 34500/50245 [00:14<00:06, 2309.88 examples/s]
Map:  69%|   | 34739/50245 [00:15<00:06, 2327.02 examples/s]
Map:  70%|   | 34999/50245 [00:15<00:06, 2397.20 examples/s]
Map:  70%|   | 35305/50245 [00:15<00:06, 2262.65 examples/s]
Map:  71%|   | 35662/50245 [00:15<00:06, 2298.90 examples/s]
Map:  72%|  | 36000/50245 [00:15<00:06, 2201.23 examples/s]
Map:  72%|  | 36244/50245 [00:15<00:06, 2255.27 examples/s]
Map:  73%|  | 36488/50245 [00:15<00:05, 2296.55 examples/s]
Map:  73%|  | 36725/50245 [00:15<00:05, 2314.88 examples/s]
Map:  74%|  | 36964/50245 [00:15<00:05, 2333.25 examples/s]
Map:  74%|  | 37233/50245 [00:16<00:06, 2130.73 examples/s]
Map:  75%|  | 37479/50245 [00:16<00:05, 2214.29 examples/s]
Map:  75%|  | 37710/50245 [00:16<00:05, 2238.18 examples/s]
Map:  76%|  | 37948/50245 [00:16<00:05, 2274.65 examples/s]
Map:  76%|  | 38240/50245 [00:16<00:05, 2147.89 examples/s]
Map:  77%|  | 38479/50245 [00:16<00:05, 2209.34 examples/s]
Map:  77%|  | 38731/50245 [00:16<00:05, 2292.69 examples/s]
Map:  78%|  | 38985/50245 [00:16<00:04, 2359.70 examples/s]
Map:  78%|  | 39294/50245 [00:17<00:04, 2244.57 examples/s]
Map:  79%|  | 39540/50245 [00:17<00:04, 2299.98 examples/s]
Map:  79%|  | 39890/50245 [00:17<00:04, 2308.26 examples/s]
Map:  80%|  | 40245/50245 [00:17<00:04, 2195.50 examples/s]
Map:  81%|  | 40503/50245 [00:17<00:04, 2284.88 examples/s]
Map:  81%|  | 40739/50245 [00:17<00:04, 2301.83 examples/s]
Map:  82%| | 40975/50245 [00:17<00:04, 2316.29 examples/s]
Map:  82%| | 41274/50245 [00:17<00:04, 2197.12 examples/s]
Map:  83%| | 41514/50245 [00:18<00:03, 2247.54 examples/s]
Map:  83%| | 41749/50245 [00:18<00:03, 2270.95 examples/s]
Map:  84%| | 42039/50245 [00:18<00:03, 2145.58 examples/s]
Map:  84%| | 42297/50245 [00:18<00:03, 2252.86 examples/s]
Map:  85%| | 42546/50245 [00:18<00:03, 2315.45 examples/s]
Map:  85%| | 42787/50245 [00:18<00:03, 2339.75 examples/s]
Map:  86%| | 43117/50245 [00:18<00:03, 2208.10 examples/s]
Map:  86%| | 43381/50245 [00:18<00:02, 2316.17 examples/s]
Map:  87%| | 43635/50245 [00:18<00:02, 2373.40 examples/s]
Map:  88%| | 43997/50245 [00:19<00:02, 2385.54 examples/s]
Map:  88%| | 44290/50245 [00:19<00:02, 2235.22 examples/s]
Map:  89%| | 44526/50245 [00:19<00:02, 2265.51 examples/s]
Map:  89%| | 44775/50245 [00:19<00:02, 2319.51 examples/s]
Map:  90%| | 45116/50245 [00:19<00:02, 2223.68 examples/s]
Map:  90%| | 45348/50245 [00:19<00:02, 2246.00 examples/s]
Map:  91%| | 45589/50245 [00:19<00:02, 2285.53 examples/s]
Map:  91%| | 45833/50245 [00:19<00:01, 2325.01 examples/s]
Map:  92%|| 46116/50245 [00:20<00:01, 2162.43 examples/s]
Map:  92%|| 46348/50245 [00:20<00:01, 2200.88 examples/s]
Map:  93%|| 46599/50245 [00:20<00:01, 2281.54 examples/s]
Map:  93%|| 46846/50245 [00:20<00:01, 2329.01 examples/s]
Map:  94%|| 47157/50245 [00:20<00:01, 2232.09 examples/s]
Map:  95%|| 47491/50245 [00:20<00:01, 2224.95 examples/s]
Map:  95%|| 47801/50245 [00:20<00:01, 1717.71 examples/s]
Map:  96%|| 48000/50245 [00:21<00:01, 1749.99 examples/s]
Map:  96%|| 48250/50245 [00:21<00:01, 1910.65 examples/s]
Map:  97%|| 48509/50245 [00:21<00:00, 2070.50 examples/s]
Map:  97%|| 48754/50245 [00:21<00:00, 2158.92 examples/s]
Map:  98%|| 49041/50245 [00:21<00:00, 2044.53 examples/s]
Map:  98%|| 49270/50245 [00:21<00:00, 2103.69 examples/s]
Map:  99%|| 49508/50245 [00:21<00:00, 2175.18 examples/s]
Map:  99%|| 49751/50245 [00:21<00:00, 2240.23 examples/s]
Map:  99%|| 49982/50245 [00:21<00:00, 2256.84 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2078.74 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2280.38 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [26] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14d631f864d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14d631f50434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14d65d4ef8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14d65d4f0572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14d65d4f05f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d65d4afac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d65d4afac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14d65d4afac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14d632f15c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14d632f19901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14d632f20a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14d632f21e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14d632f24aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14d632f33a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14d65d4a42d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14d65d4a802a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14d65d4b6e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14d671b34fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14d671380285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14d6aafeecf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 26 STDERR----------
Global rank 27 (PID 145820) exited with code 1
----------Begin global rank 27 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 27 STDOUT----------
----------Begin global rank 27 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 167/50245 [00:00<00:30, 1650.55 examples/s]
Map:   1%|          | 419/50245 [00:00<00:23, 2155.35 examples/s]
Map:   1%|         | 680/50245 [00:00<00:21, 2358.17 examples/s]
Map:   2%|         | 929/50245 [00:00<00:20, 2406.17 examples/s]
Map:   2%|         | 1238/50245 [00:00<00:23, 2047.71 examples/s]
Map:   3%|         | 1470/50245 [00:00<00:22, 2122.98 examples/s]
Map:   3%|         | 1707/50245 [00:00<00:22, 2191.32 examples/s]
Map:   4%|         | 1948/50245 [00:00<00:21, 2253.50 examples/s]
Map:   5%|         | 2275/50245 [00:01<00:21, 2220.08 examples/s]
Map:   5%|         | 2515/50245 [00:01<00:21, 2264.79 examples/s]
Map:   5%|         | 2754/50245 [00:01<00:20, 2295.06 examples/s]
Map:   6%|         | 2991/50245 [00:01<00:20, 2312.74 examples/s]
Map:   7%|         | 3293/50245 [00:01<00:21, 2198.32 examples/s]
Map:   7%|         | 3548/50245 [00:01<00:20, 2285.44 examples/s]
Map:   8%|         | 3891/50245 [00:01<00:20, 2283.04 examples/s]
Map:   8%|         | 4235/50245 [00:01<00:20, 2203.49 examples/s]
Map:   9%|         | 4484/50245 [00:02<00:20, 2268.68 examples/s]
Map:   9%|         | 4719/50245 [00:02<00:19, 2283.42 examples/s]
Map:  10%|         | 5012/50245 [00:02<00:20, 2162.30 examples/s]
Map:  10%|         | 5267/50245 [00:02<00:19, 2257.84 examples/s]
Map:  11%|         | 5522/50245 [00:02<00:19, 2331.26 examples/s]
Map:  11%|        | 5768/50245 [00:02<00:18, 2359.86 examples/s]
Map:  12%|        | 6126/50245 [00:02<00:19, 2292.68 examples/s]
Map:  13%|        | 6371/50245 [00:02<00:18, 2328.96 examples/s]
Map:  13%|        | 6624/50245 [00:02<00:18, 2380.33 examples/s]
Map:  14%|        | 6882/50245 [00:03<00:17, 2430.73 examples/s]
Map:  14%|        | 7249/50245 [00:03<00:18, 2330.56 examples/s]
Map:  15%|        | 7492/50245 [00:03<00:18, 2351.47 examples/s]
Map:  16%|        | 7860/50245 [00:03<00:17, 2384.04 examples/s]
Map:  16%|        | 8192/50245 [00:03<00:18, 2323.83 examples/s]
Map:  17%|        | 8431/50245 [00:03<00:17, 2338.92 examples/s]
Map:  17%|        | 8682/50245 [00:03<00:17, 2380.58 examples/s]
Map:  18%|        | 8934/50245 [00:03<00:17, 2415.07 examples/s]
Map:  18%|        | 9260/50245 [00:04<00:17, 2321.87 examples/s]
Map:  19%|        | 9523/50245 [00:04<00:16, 2397.43 examples/s]
Map:  20%|        | 9885/50245 [00:04<00:16, 2397.75 examples/s]
Map:  20%|        | 10243/50245 [00:04<00:17, 2283.62 examples/s]
Map:  21%|        | 10478/50245 [00:04<00:17, 2296.55 examples/s]
Map:  21%|       | 10733/50245 [00:04<00:16, 2357.54 examples/s]
Map:  22%|       | 10984/50245 [00:04<00:16, 2397.09 examples/s]
Map:  22%|       | 11298/50245 [00:04<00:17, 2285.49 examples/s]
Map:  23%|       | 11544/50245 [00:05<00:16, 2325.67 examples/s]
Map:  23%|       | 11799/50245 [00:05<00:16, 2383.91 examples/s]
Map:  24%|       | 12132/50245 [00:05<00:16, 2307.20 examples/s]
Map:  25%|       | 12372/50245 [00:05<00:16, 2326.66 examples/s]
Map:  25%|       | 12619/50245 [00:05<00:15, 2361.43 examples/s]
Map:  26%|       | 12886/50245 [00:05<00:15, 2443.92 examples/s]
Map:  26%|       | 13253/50245 [00:05<00:15, 2348.49 examples/s]
Map:  27%|       | 13494/50245 [00:05<00:15, 2360.70 examples/s]
Map:  27%|       | 13735/50245 [00:05<00:15, 2369.57 examples/s]
Map:  28%|       | 13981/50245 [00:06<00:15, 2390.67 examples/s]
Map:  28%|       | 14294/50245 [00:06<00:15, 2275.26 examples/s]
Map:  29%|       | 14532/50245 [00:06<00:15, 2301.10 examples/s]
Map:  29%|       | 14783/50245 [00:06<00:15, 2355.55 examples/s]
Map:  30%|       | 15124/50245 [00:06<00:15, 2311.61 examples/s]
Map:  31%|       | 15369/50245 [00:06<00:14, 2345.25 examples/s]
Map:  31%|      | 15725/50245 [00:06<00:14, 2350.68 examples/s]
Map:  32%|      | 15966/50245 [00:06<00:14, 2363.86 examples/s]
Map:  32%|      | 16281/50245 [00:07<00:14, 2267.18 examples/s]
Map:  33%|      | 16540/50245 [00:07<00:14, 2346.29 examples/s]
Map:  33%|      | 16800/50245 [00:07<00:13, 2410.59 examples/s]
Map:  34%|      | 17127/50245 [00:07<00:14, 2316.57 examples/s]
Map:  35%|      | 17369/50245 [00:07<00:14, 2338.89 examples/s]
Map:  35%|      | 17623/50245 [00:07<00:13, 2390.74 examples/s]
Map:  36%|      | 17875/50245 [00:07<00:13, 2425.46 examples/s]
Map:  36%|      | 18198/50245 [00:07<00:13, 2319.80 examples/s]
Map:  37%|      | 18445/50245 [00:07<00:13, 2355.81 examples/s]
Map:  37%|      | 18690/50245 [00:08<00:13, 2380.76 examples/s]
Map:  38%|      | 18944/50245 [00:08<00:12, 2421.21 examples/s]
Map:  38%|      | 19262/50245 [00:08<00:13, 2304.44 examples/s]
Map:  39%|      | 19514/50245 [00:08<00:13, 2359.02 examples/s]
Map:  39%|      | 19761/50245 [00:08<00:12, 2384.69 examples/s]
Map:  40%|      | 20119/50245 [00:08<00:13, 2310.65 examples/s]
Map:  41%|      | 20376/50245 [00:08<00:12, 2373.86 examples/s]
Map:  41%|      | 20633/50245 [00:08<00:12, 2421.97 examples/s]
Map:  42%|     | 20984/50245 [00:09<00:12, 2387.37 examples/s]
Map:  42%|     | 21304/50245 [00:09<00:12, 2294.50 examples/s]
Map:  43%|     | 21551/50245 [00:09<00:12, 2335.04 examples/s]
Map:  43%|     | 21799/50245 [00:09<00:12, 2368.76 examples/s]
Map:  44%|     | 22125/50245 [00:09<00:12, 2251.32 examples/s]
Map:  45%|     | 22362/50245 [00:09<00:12, 2278.27 examples/s]
Map:  45%|     | 22605/50245 [00:09<00:11, 2316.96 examples/s]
Map:  45%|     | 22856/50245 [00:09<00:11, 2367.15 examples/s]
Map:  46%|     | 23163/50245 [00:09<00:12, 2246.25 examples/s]
Map:  47%|     | 23425/50245 [00:10<00:11, 2342.61 examples/s]
Map:  47%|     | 23664/50245 [00:10<00:11, 2352.60 examples/s]
Map:  48%|     | 23907/50245 [00:10<00:11, 2369.32 examples/s]
Map:  48%|     | 24228/50245 [00:10<00:11, 2221.15 examples/s]
Map:  49%|     | 24474/50245 [00:10<00:11, 2278.86 examples/s]
Map:  49%|     | 24722/50245 [00:10<00:10, 2328.06 examples/s]
Map:  50%|     | 24977/50245 [00:10<00:10, 2387.19 examples/s]
Map:  50%|     | 25298/50245 [00:10<00:10, 2290.83 examples/s]
Map:  51%|     | 25563/50245 [00:11<00:10, 2383.85 examples/s]
Map:  52%|    | 25915/50245 [00:11<00:10, 2368.07 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2251.33 examples/s]
Map:  53%|    | 26482/50245 [00:11<00:10, 2293.36 examples/s]
Map:  53%|    | 26737/50245 [00:11<00:09, 2354.42 examples/s]
Map:  54%|    | 26984/50245 [00:11<00:09, 2382.63 examples/s]
Map:  54%|    | 27301/50245 [00:11<00:10, 2281.44 examples/s]
Map:  55%|    | 27556/50245 [00:11<00:09, 2348.48 examples/s]
Map:  55%|    | 27796/50245 [00:11<00:09, 2359.49 examples/s]
Map:  56%|    | 28108/50245 [00:12<00:09, 2221.13 examples/s]
Map:  56%|    | 28362/50245 [00:12<00:09, 2299.00 examples/s]
Map:  57%|    | 28610/50245 [00:12<00:09, 2344.90 examples/s]
Map:  57%|    | 28850/50245 [00:12<00:09, 2358.29 examples/s]
Map:  58%|    | 29173/50245 [00:12<00:09, 2276.55 examples/s]
Map:  59%|    | 29422/50245 [00:12<00:08, 2329.89 examples/s]
Map:  59%|    | 29782/50245 [00:12<00:08, 2350.65 examples/s]
Map:  60%|    | 30120/50245 [00:12<00:09, 2224.16 examples/s]
Map:  60%|    | 30370/50245 [00:13<00:08, 2287.83 examples/s]
Map:  61%|    | 30624/50245 [00:13<00:08, 2348.64 examples/s]
Map:  61%|   | 30866/50245 [00:13<00:08, 2364.43 examples/s]
Map:  62%|   | 31182/50245 [00:13<00:08, 2267.45 examples/s]
Map:  63%|   | 31428/50245 [00:13<00:08, 2314.77 examples/s]
Map:  63%|   | 31680/50245 [00:13<00:07, 2366.57 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2250.53 examples/s]
Map:  64%|   | 32240/50245 [00:13<00:07, 2286.58 examples/s]
ERROR:composer.cli.launcher:Global rank 24 (PID 145817) exited with code 143
Map:  65%|   | 32489/50245 [00:14<00:07, 2338.54 examples/s]
Map:  65%|   | 32738/50245 [00:14<00:07, 2376.96 examples/s]
Map:  66%|   | 32990/50245 [00:14<00:07, 2414.73 examples/s]
Map:  66%|   | 33320/50245 [00:14<00:07, 2330.42 examples/s]
Map:  67%|   | 33563/50245 [00:14<00:07, 2355.00 examples/s]
Map:  67%|   | 33804/50245 [00:14<00:06, 2367.20 examples/s]
Map:  68%|   | 34129/50245 [00:14<00:07, 2271.95 examples/s]
Map:  68%|   | 34388/50245 [00:14<00:06, 2350.17 examples/s]
Map:  69%|   | 34640/50245 [00:14<00:06, 2392.43 examples/s]
Map:  69%|   | 34904/50245 [00:15<00:06, 2457.54 examples/s]
Map:  70%|   | 35246/50245 [00:15<00:06, 2331.63 examples/s]
Map:  71%|   | 35489/50245 [00:15<00:06, 2356.20 examples/s]
Map:  71%|   | 35729/50245 [00:15<00:06, 2366.06 examples/s]
Map:  72%|  | 35980/50245 [00:15<00:05, 2403.43 examples/s]
Map:  72%|  | 36300/50245 [00:15<00:06, 2299.01 examples/s]
Map:  73%|  | 36558/50245 [00:15<00:05, 2368.44 examples/s]
Map:  73%|  | 36803/50245 [00:15<00:05, 2388.53 examples/s]
Map:  74%|  | 37117/50245 [00:15<00:05, 2239.74 examples/s]
Map:  75%|  | 37472/50245 [00:16<00:05, 2280.34 examples/s]
Map:  75%|  | 37713/50245 [00:16<00:05, 2308.86 examples/s]
Map:  76%|  | 37956/50245 [00:16<00:05, 2339.57 examples/s]
Map:  76%|  | 38257/50245 [00:16<00:05, 2216.27 examples/s]
Map:  77%|  | 38504/50245 [00:16<00:05, 2279.24 examples/s]
Map:  77%|  | 38765/50245 [00:16<00:04, 2361.69 examples/s]
Map:  78%|  | 39126/50245 [00:16<00:04, 2308.78 examples/s]
Map:  78%|  | 39378/50245 [00:16<00:04, 2357.87 examples/s]
Map:  79%|  | 39742/50245 [00:17<00:04, 2377.84 examples/s]
Map:  80%|  | 39987/50245 [00:17<00:04, 2392.78 examples/s]
Map:  80%|  | 40309/50245 [00:17<00:04, 2305.91 examples/s]
Map:  81%|  | 40568/50245 [00:17<00:04, 2374.96 examples/s]
Map:  81%|  | 40822/50245 [00:17<00:03, 2414.67 examples/s]
Map:  82%| | 41130/50245 [00:17<00:03, 2279.56 examples/s]
Map:  83%| | 41487/50245 [00:17<00:03, 2310.49 examples/s]
Map:  83%| | 41731/50245 [00:17<00:03, 2340.47 examples/s]
Map:  84%| | 42025/50245 [00:18<00:03, 2205.58 examples/s]
Map:  84%| | 42280/50245 [00:18<00:03, 2288.25 examples/s]
Map:  85%| | 42531/50245 [00:18<00:03, 2343.59 examples/s]
Map:  85%| | 42777/50245 [00:18<00:03, 2370.60 examples/s]
Map:  86%| | 43122/50245 [00:18<00:03, 2249.99 examples/s]
Map:  86%| | 43389/50245 [00:18<00:02, 2353.39 examples/s]
Map:  87%| | 43646/50245 [00:18<00:02, 2409.52 examples/s]
Map:  88%| | 44000/50245 [00:18<00:02, 2309.71 examples/s]
Map:  88%| | 44358/50245 [00:19<00:02, 2332.81 examples/s]
Map:  89%| | 44601/50245 [00:19<00:02, 2353.81 examples/s]
Map:  89%| | 44853/50245 [00:19<00:02, 2393.34 examples/s]
Map:  90%| | 45166/50245 [00:19<00:02, 2282.22 examples/s]
Map:  90%| | 45403/50245 [00:19<00:02, 2289.69 examples/s]
Map:  91%| | 45657/50245 [00:19<00:01, 2353.89 examples/s]
Map:  91%|| 45907/50245 [00:19<00:01, 2388.28 examples/s]
Map:  92%|| 46248/50245 [00:19<00:01, 2283.39 examples/s]
Map:  93%|| 46504/50245 [00:20<00:01, 2349.52 examples/s]
Map:  93%|| 46749/50245 [00:20<00:01, 2375.67 examples/s]
Map:  94%|| 47000/50245 [00:20<00:01, 2286.66 examples/s]
Map:  94%|| 47249/50245 [00:20<00:01, 2340.89 examples/s]
Map:  95%|| 47604/50245 [00:20<00:01, 2346.07 examples/s]
Map:  95%|| 47930/50245 [00:20<00:01, 1780.38 examples/s]
Map:  96%|| 48259/50245 [00:20<00:01, 1887.78 examples/s]
Map:  97%|| 48520/50245 [00:21<00:00, 2036.74 examples/s]
Map:  97%|| 48766/50245 [00:21<00:00, 2131.37 examples/s]
Map:  98%|| 49000/50245 [00:21<00:00, 2096.57 examples/s]
Map:  98%|| 49240/50245 [00:21<00:00, 2168.03 examples/s]
Map:  98%|| 49476/50245 [00:21<00:00, 2217.95 examples/s]
Map:  99%|| 49724/50245 [00:21<00:00, 2287.08 examples/s]
Map:  99%|| 49964/50245 [00:21<00:00, 2315.69 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2170.52 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2307.76 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 9292.78 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9159.65 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 9215.27 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:05, 9212.70 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9200.60 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9280.46 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9347.86 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9360.75 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9404.62 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9307.90 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9266.22 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:04, 9257.88 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9340.39 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9322.03 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9334.57 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9231.76 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9262.74 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9188.82 examples/s]
Filter:  38%|      | 19000/50245 [00:02<00:03, 9193.37 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9240.59 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9206.66 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:03, 9159.18 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9128.56 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9101.11 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9076.22 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9083.52 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9074.69 examples/s]
Filter:  56%|    | 28000/50245 [00:03<00:02, 9121.38 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9103.92 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9081.56 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9104.00 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:02, 9075.77 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9105.42 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9122.92 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9216.82 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9167.83 examples/s]
Filter:  74%|  | 37000/50245 [00:04<00:01, 9146.62 examples/s]
Filter:  76%|  | 38000/50245 [00:04<00:01, 9037.46 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9125.55 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9126.80 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:01, 9050.79 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 8983.64 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9056.21 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9165.55 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9135.23 examples/s]
Filter:  92%|| 46000/50245 [00:05<00:00, 9110.47 examples/s]
Filter:  94%|| 47000/50245 [00:05<00:00, 9169.04 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9114.91 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9258.51 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9210.43 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9163.77 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [27] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14e3625054d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14e3624cf434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14e38da6e8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14e38da6f572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14e38da6f5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e38da2eac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e38da2eac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14e38da2eac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14e363494c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14e363498901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14e36349fa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14e3634a0e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14e3634a3aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14e3634b2a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14e38da232d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14e38da2702a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14e38da35e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14e3a20b3fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14e3a18ff285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14e3db56dcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 27 STDERR----------
Global rank 12 (PID 215939) exited with code 143
Global rank 13 (PID 215940) exited with code 1
----------Begin global rank 13 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 13 STDOUT----------
----------Begin global rank 13 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 237/50245 [00:00<00:21, 2345.74 examples/s]
Map:   1%|          | 491/50245 [00:00<00:20, 2453.66 examples/s]
Map:   1%|         | 746/50245 [00:00<00:19, 2491.39 examples/s]
Map:   2%|         | 1048/50245 [00:00<00:21, 2251.20 examples/s]
Map:   3%|         | 1393/50245 [00:00<00:21, 2267.22 examples/s]
Map:   3%|         | 1742/50245 [00:00<00:21, 2285.05 examples/s]
Map:   4%|         | 1980/50245 [00:00<00:20, 2304.53 examples/s]
Map:   5%|         | 2286/50245 [00:01<00:21, 2207.91 examples/s]
Map:   5%|         | 2517/50245 [00:01<00:21, 2231.48 examples/s]
Map:   5%|         | 2754/50245 [00:01<00:20, 2264.47 examples/s]
Map:   6%|         | 3047/50245 [00:01<00:21, 2147.67 examples/s]
Map:   7%|         | 3274/50245 [00:01<00:21, 2173.29 examples/s]
Map:   7%|         | 3521/50245 [00:01<00:20, 2251.75 examples/s]
Map:   8%|         | 3859/50245 [00:01<00:20, 2249.88 examples/s]
Map:   8%|         | 4154/50245 [00:01<00:21, 2151.37 examples/s]
Map:   9%|         | 4384/50245 [00:01<00:20, 2184.75 examples/s]
Map:   9%|         | 4625/50245 [00:02<00:20, 2240.70 examples/s]
Map:  10%|         | 4958/50245 [00:02<00:20, 2229.01 examples/s]
Map:  10%|         | 5263/50245 [00:02<00:20, 2160.56 examples/s]
Map:  11%|         | 5511/50245 [00:02<00:20, 2235.27 examples/s]
Map:  11%|        | 5748/50245 [00:02<00:19, 2265.74 examples/s]
Map:  12%|        | 5988/50245 [00:02<00:19, 2301.15 examples/s]
Map:  13%|        | 6299/50245 [00:02<00:19, 2213.17 examples/s]
Map:  13%|        | 6541/50245 [00:02<00:19, 2263.73 examples/s]
Map:  13%|        | 6777/50245 [00:03<00:18, 2288.51 examples/s]
Map:  14%|        | 7116/50245 [00:03<00:19, 2232.39 examples/s]
Map:  15%|        | 7356/50245 [00:03<00:18, 2272.51 examples/s]
Map:  15%|        | 7592/50245 [00:03<00:18, 2290.64 examples/s]
Map:  16%|        | 7841/50245 [00:03<00:18, 2342.16 examples/s]
Map:  16%|        | 8158/50245 [00:03<00:18, 2254.39 examples/s]
Map:  17%|        | 8389/50245 [00:03<00:18, 2266.40 examples/s]
Map:  17%|        | 8633/50245 [00:03<00:18, 2308.50 examples/s]
Map:  18%|        | 8879/50245 [00:03<00:17, 2346.23 examples/s]
Map:  18%|        | 9118/50245 [00:04<00:18, 2227.10 examples/s]
Map:  19%|        | 9372/50245 [00:04<00:17, 2312.15 examples/s]
Map:  19%|        | 9610/50245 [00:04<00:17, 2327.89 examples/s]
Map:  20%|        | 9849/50245 [00:04<00:17, 2341.51 examples/s]
Map:  20%|        | 10156/50245 [00:04<00:18, 2224.33 examples/s]
Map:  21%|        | 10383/50245 [00:04<00:17, 2233.42 examples/s]
Map:  21%|        | 10617/50245 [00:04<00:17, 2260.77 examples/s]
Map:  22%|       | 10875/50245 [00:04<00:16, 2348.72 examples/s]
Map:  22%|       | 11181/50245 [00:04<00:17, 2229.77 examples/s]
Map:  23%|       | 11412/50245 [00:05<00:17, 2249.16 examples/s]
Map:  23%|       | 11662/50245 [00:05<00:16, 2314.35 examples/s]
Map:  24%|       | 11909/50245 [00:05<00:16, 2353.95 examples/s]
Map:  24%|       | 12249/50245 [00:05<00:16, 2252.57 examples/s]
Map:  25%|       | 12483/50245 [00:05<00:16, 2271.47 examples/s]
Map:  25%|       | 12737/50245 [00:05<00:16, 2337.87 examples/s]
Map:  26%|       | 12997/50245 [00:05<00:15, 2408.01 examples/s]
Map:  27%|       | 13316/50245 [00:05<00:16, 2301.65 examples/s]
Map:  27%|       | 13668/50245 [00:06<00:15, 2314.12 examples/s]
Map:  28%|       | 13905/50245 [00:06<00:15, 2324.15 examples/s]
Map:  28%|       | 14233/50245 [00:06<00:16, 2213.07 examples/s]
Map:  29%|       | 14465/50245 [00:06<00:15, 2236.83 examples/s]
Map:  29%|       | 14708/50245 [00:06<00:15, 2282.77 examples/s]
Map:  30%|       | 14962/50245 [00:06<00:15, 2348.34 examples/s]
Map:  30%|       | 15270/50245 [00:06<00:15, 2236.45 examples/s]
Map:  31%|       | 15608/50245 [00:06<00:15, 2240.33 examples/s]
Map:  32%|      | 15851/50245 [00:06<00:15, 2285.22 examples/s]
Map:  32%|      | 16156/50245 [00:07<00:15, 2195.02 examples/s]
Map:  33%|      | 16389/50245 [00:07<00:15, 2227.19 examples/s]
Map:  33%|      | 16651/50245 [00:07<00:14, 2327.84 examples/s]
Map:  34%|      | 16892/50245 [00:07<00:14, 2345.28 examples/s]
Map:  34%|      | 17246/50245 [00:07<00:14, 2261.47 examples/s]
Map:  35%|      | 17479/50245 [00:07<00:14, 2275.62 examples/s]
Map:  35%|      | 17732/50245 [00:07<00:13, 2339.48 examples/s]
Map:  36%|      | 17970/50245 [00:07<00:13, 2348.41 examples/s]
Map:  36%|      | 18279/50245 [00:08<00:14, 2237.47 examples/s]
Map:  37%|      | 18524/50245 [00:08<00:13, 2289.46 examples/s]
Map:  38%|      | 18873/50245 [00:08<00:13, 2296.99 examples/s]
Map:  38%|      | 19187/50245 [00:08<00:13, 2224.66 examples/s]
Map:  39%|      | 19425/50245 [00:08<00:13, 2261.01 examples/s]
Map:  39%|      | 19668/50245 [00:08<00:13, 2302.65 examples/s]
Map:  40%|      | 19915/50245 [00:08<00:12, 2341.52 examples/s]
Map:  40%|      | 20240/50245 [00:08<00:13, 2239.34 examples/s]
Map:  41%|      | 20487/50245 [00:09<00:12, 2295.24 examples/s]
Map:  41%|     | 20731/50245 [00:09<00:12, 2328.36 examples/s]
Map:  42%|     | 21028/50245 [00:09<00:13, 2199.25 examples/s]
Map:  42%|     | 21264/50245 [00:09<00:12, 2239.13 examples/s]
Map:  43%|     | 21508/50245 [00:09<00:12, 2289.59 examples/s]
Map:  43%|     | 21753/50245 [00:09<00:12, 2333.26 examples/s]
Map:  44%|     | 22049/50245 [00:09<00:12, 2197.40 examples/s]
Map:  44%|     | 22283/50245 [00:09<00:12, 2229.03 examples/s]
Map:  45%|     | 22524/50245 [00:09<00:12, 2275.66 examples/s]
Map:  45%|     | 22765/50245 [00:10<00:11, 2310.38 examples/s]
Map:  46%|     | 23000/50245 [00:10<00:12, 2192.98 examples/s]
Map:  46%|     | 23236/50245 [00:10<00:12, 2237.96 examples/s]
Map:  47%|     | 23495/50245 [00:10<00:11, 2332.54 examples/s]
Map:  47%|     | 23732/50245 [00:10<00:11, 2340.02 examples/s]
Map:  48%|     | 23975/50245 [00:10<00:11, 2364.64 examples/s]
Map:  48%|     | 24264/50245 [00:10<00:11, 2194.14 examples/s]
Map:  49%|     | 24494/50245 [00:10<00:11, 2215.90 examples/s]
Map:  49%|     | 24742/50245 [00:10<00:11, 2286.60 examples/s]
Map:  50%|     | 24996/50245 [00:10<00:10, 2357.50 examples/s]
Map:  50%|     | 25300/50245 [00:11<00:11, 2231.21 examples/s]
Map:  51%|     | 25560/50245 [00:11<00:10, 2325.11 examples/s]
Map:  52%|    | 25908/50245 [00:11<00:10, 2319.64 examples/s]
Map:  52%|    | 26234/50245 [00:11<00:10, 2194.61 examples/s]
Map:  53%|    | 26473/50245 [00:11<00:10, 2238.92 examples/s]
Map:  53%|    | 26720/50245 [00:11<00:10, 2295.17 examples/s]
Map:  54%|    | 26965/50245 [00:11<00:09, 2333.70 examples/s]
Map:  54%|    | 27272/50245 [00:12<00:10, 2225.61 examples/s]
Map:  55%|    | 27531/50245 [00:12<00:09, 2310.96 examples/s]
Map:  55%|    | 27768/50245 [00:12<00:09, 2323.90 examples/s]
Map:  56%|    | 28105/50245 [00:12<00:10, 2186.00 examples/s]
Map:  56%|    | 28352/50245 [00:12<00:09, 2254.22 examples/s]
Map:  57%|    | 28595/50245 [00:12<00:09, 2297.68 examples/s]
Map:  57%|    | 28830/50245 [00:12<00:09, 2309.98 examples/s]
Map:  58%|    | 29144/50245 [00:12<00:09, 2225.77 examples/s]
Map:  58%|    | 29389/50245 [00:12<00:09, 2282.30 examples/s]
Map:  59%|    | 29733/50245 [00:13<00:08, 2283.39 examples/s]
Map:  60%|    | 30028/50245 [00:13<00:09, 2173.13 examples/s]
Map:  60%|    | 30276/50245 [00:13<00:08, 2245.22 examples/s]
Map:  61%|    | 30518/50245 [00:13<00:08, 2286.91 examples/s]
Map:  61%|    | 30752/50245 [00:13<00:08, 2297.74 examples/s]
Map:  62%|   | 30997/50245 [00:13<00:08, 2337.25 examples/s]
Map:  62%|   | 31303/50245 [00:13<00:08, 2223.75 examples/s]
Map:  63%|   | 31545/50245 [00:13<00:08, 2270.75 examples/s]
Map:  63%|   | 31789/50245 [00:13<00:07, 2313.64 examples/s]
Map:  64%|   | 32115/50245 [00:14<00:08, 2194.28 examples/s]
Map:  64%|   | 32349/50245 [00:14<00:08, 2227.04 examples/s]
Map:  65%|   | 32602/50245 [00:14<00:07, 2306.77 examples/s]
Map:  65%|   | 32845/50245 [00:14<00:07, 2336.54 examples/s]
Map:  66%|   | 33161/50245 [00:14<00:07, 2248.10 examples/s]
Map:  66%|   | 33404/50245 [00:14<00:07, 2293.44 examples/s]
Map:  67%|   | 33641/50245 [00:14<00:07, 2310.90 examples/s]
Map:  67%|   | 33885/50245 [00:14<00:06, 2345.86 examples/s]
Map:  68%|   | 34126/50245 [00:15<00:07, 2211.18 examples/s]
Map:  68%|   | 34380/50245 [00:15<00:06, 2298.88 examples/s]
Map:  69%|   | 34627/50245 [00:15<00:06, 2342.80 examples/s]
Map:  69%|   | 34882/50245 [00:15<00:06, 2400.90 examples/s]
Map:  70%|   | 35240/50245 [00:15<00:06, 2286.27 examples/s]
Map:  71%|   | 35479/50245 [00:15<00:06, 2310.13 examples/s]
Map:  71%|   | 35718/50245 [00:15<00:06, 2327.92 examples/s]
Map:  72%|  | 35957/50245 [00:15<00:06, 2344.33 examples/s]
Map:  72%|  | 36272/50245 [00:15<00:06, 2250.39 examples/s]
Map:  73%|  | 36519/50245 [00:16<00:05, 2305.85 examples/s]
Map:  73%|  | 36763/50245 [00:16<00:05, 2339.73 examples/s]
Map:  74%|  | 37000/50245 [00:16<00:06, 2192.59 examples/s]
Map:  74%|  | 37334/50245 [00:16<00:05, 2202.76 examples/s]
Map:  75%|  | 37583/50245 [00:16<00:05, 2269.45 examples/s]
Map:  75%|  | 37820/50245 [00:16<00:05, 2293.80 examples/s]
Map:  76%|  | 38118/50245 [00:16<00:05, 2178.03 examples/s]
Map:  76%|  | 38350/50245 [00:16<00:05, 2212.38 examples/s]
Map:  77%|  | 38605/50245 [00:16<00:05, 2300.76 examples/s]
Map:  77%|  | 38858/50245 [00:17<00:04, 2357.67 examples/s]
Map:  78%|  | 39177/50245 [00:17<00:04, 2266.78 examples/s]
Map:  78%|  | 39430/50245 [00:17<00:04, 2329.80 examples/s]
Map:  79%|  | 39669/50245 [00:17<00:04, 2341.03 examples/s]
Map:  79%|  | 39908/50245 [00:17<00:04, 2353.06 examples/s]
Map:  80%|  | 40250/50245 [00:17<00:04, 2247.07 examples/s]
Map:  81%|  | 40513/50245 [00:17<00:04, 2341.78 examples/s]
Map:  81%| | 40872/50245 [00:17<00:03, 2357.21 examples/s]
Map:  82%| | 41175/50245 [00:18<00:04, 2235.89 examples/s]
Map:  82%| | 41410/50245 [00:18<00:03, 2262.01 examples/s]
Map:  83%| | 41660/50245 [00:18<00:03, 2321.27 examples/s]
Map:  84%| | 42000/50245 [00:18<00:03, 2174.85 examples/s]
Map:  84%| | 42247/50245 [00:18<00:03, 2242.76 examples/s]
Map:  85%| | 42489/50245 [00:18<00:03, 2285.55 examples/s]
Map:  85%| | 42741/50245 [00:18<00:03, 2344.23 examples/s]
Map:  86%| | 43034/50245 [00:18<00:03, 2197.87 examples/s]
Map:  86%| | 43294/50245 [00:19<00:03, 2299.54 examples/s]
Map:  87%| | 43543/50245 [00:19<00:02, 2348.47 examples/s]
Map:  87%| | 43797/50245 [00:19<00:02, 2398.41 examples/s]
Map:  88%| | 44118/50245 [00:19<00:02, 2252.66 examples/s]
Map:  88%| | 44352/50245 [00:19<00:02, 2269.64 examples/s]
Map:  89%| | 44587/50245 [00:19<00:02, 2289.22 examples/s]
Map:  89%| | 44826/50245 [00:19<00:02, 2312.69 examples/s]
Map:  90%| | 45125/50245 [00:19<00:02, 2190.49 examples/s]
Map:  90%| | 45356/50245 [00:19<00:02, 2219.52 examples/s]
Map:  91%| | 45591/50245 [00:20<00:02, 2251.94 examples/s]
Map:  91%| | 45829/50245 [00:20<00:01, 2284.07 examples/s]
Map:  92%|| 46123/50245 [00:20<00:01, 2157.15 examples/s]
Map:  92%|| 46356/50245 [00:20<00:01, 2200.89 examples/s]
Map:  93%|| 46604/50245 [00:20<00:01, 2273.13 examples/s]
Map:  93%|| 46845/50245 [00:20<00:01, 2309.06 examples/s]
Map:  94%|| 47155/50245 [00:20<00:01, 2217.18 examples/s]
Map:  95%|| 47483/50245 [00:20<00:01, 2204.40 examples/s]
Map:  95%|| 47798/50245 [00:21<00:01, 1689.88 examples/s]
Map:  96%|| 48000/50245 [00:21<00:01, 1717.97 examples/s]
Map:  96%|| 48247/50245 [00:21<00:01, 1879.85 examples/s]
Map:  97%|| 48500/50245 [00:21<00:00, 2032.33 examples/s]
Map:  97%|| 48737/50245 [00:21<00:00, 2116.75 examples/s]
Map:  97%|| 48976/50245 [00:21<00:00, 2188.80 examples/s]
Map:  98%|| 49262/50245 [00:21<00:00, 2080.37 examples/s]
Map:  98%|| 49489/50245 [00:21<00:00, 2126.81 examples/s]
Map:  99%|| 49723/50245 [00:22<00:00, 2181.74 examples/s]
Map:  99%|| 49953/50245 [00:22<00:00, 2211.27 examples/s]
Map: 100%|| 50234/50245 [00:22<00:00, 2083.73 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2245.58 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [13] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x1539f329a4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x1539f3264434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x153a1e8038c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x153a1e804572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x153a1e8045f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153a1e7c3ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153a1e7c3ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x153a1e7c3ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x1539f4229c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x1539f422d901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x1539f4234a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x1539f4235e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x1539f4238aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x1539f4247a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x153a1e7b82d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x153a1e7bc02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x153a1e7cae90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x153a32e48fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x153a32694285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x153a6c302cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 13 STDERR----------
Global rank 14 (PID 215941) exited with code 1
----------Begin global rank 14 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 14 STDOUT----------
----------Begin global rank 14 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 160/50245 [00:00<00:31, 1576.84 examples/s]
Map:   1%|          | 404/50245 [00:00<00:24, 2074.06 examples/s]
Map:   1%|         | 659/50245 [00:00<00:21, 2284.49 examples/s]
Map:   2%|         | 903/50245 [00:00<00:21, 2335.71 examples/s]
Map:   2%|         | 1232/50245 [00:00<00:24, 1981.67 examples/s]
Map:   3%|         | 1459/50245 [00:00<00:23, 2060.34 examples/s]
Map:   3%|         | 1693/50245 [00:00<00:22, 2136.55 examples/s]
Map:   4%|         | 1927/50245 [00:00<00:22, 2192.39 examples/s]
Map:   4%|         | 2243/50245 [00:01<00:22, 2154.85 examples/s]
Map:   5%|         | 2476/50245 [00:01<00:21, 2197.12 examples/s]
Map:   5%|         | 2715/50245 [00:01<00:21, 2248.50 examples/s]
Map:   6%|         | 3004/50245 [00:01<00:22, 2124.79 examples/s]
Map:   6%|         | 3231/50245 [00:01<00:21, 2161.06 examples/s]
Map:   7%|         | 3481/50245 [00:01<00:20, 2251.37 examples/s]
Map:   8%|         | 3823/50245 [00:01<00:20, 2256.88 examples/s]
Map:   8%|         | 4118/50245 [00:01<00:21, 2148.85 examples/s]
Map:   9%|         | 4348/50245 [00:02<00:21, 2184.93 examples/s]
Map:   9%|         | 4589/50245 [00:02<00:20, 2241.62 examples/s]
Map:  10%|         | 4924/50245 [00:02<00:20, 2233.94 examples/s]
Map:  10%|         | 5250/50245 [00:02<00:20, 2184.77 examples/s]
Map:  11%|         | 5500/50245 [00:02<00:19, 2257.74 examples/s]
Map:  11%|        | 5741/50245 [00:02<00:19, 2293.17 examples/s]
Map:  12%|        | 5983/50245 [00:02<00:19, 2325.11 examples/s]
Map:  13%|        | 6299/50245 [00:02<00:19, 2242.49 examples/s]
Map:  13%|        | 6543/50245 [00:02<00:19, 2289.96 examples/s]
Map:  14%|        | 6785/50245 [00:03<00:18, 2321.19 examples/s]
Map:  14%|        | 7114/50245 [00:03<00:19, 2251.81 examples/s]
Map:  15%|        | 7356/50245 [00:03<00:18, 2291.64 examples/s]
Map:  15%|        | 7593/50245 [00:03<00:18, 2311.28 examples/s]
Map:  16%|        | 7843/50245 [00:03<00:17, 2361.52 examples/s]
Map:  16%|        | 8168/50245 [00:03<00:18, 2283.75 examples/s]
Map:  17%|        | 8400/50245 [00:03<00:18, 2291.83 examples/s]
Map:  17%|        | 8646/50245 [00:03<00:17, 2335.18 examples/s]
Map:  18%|        | 8892/50245 [00:03<00:17, 2366.24 examples/s]
Map:  18%|        | 9244/50245 [00:04<00:17, 2281.02 examples/s]
Map:  19%|        | 9504/50245 [00:04<00:17, 2360.02 examples/s]
Map:  20%|        | 9855/50245 [00:04<00:17, 2348.17 examples/s]
Map:  20%|        | 10163/50245 [00:04<00:17, 2244.49 examples/s]
Map:  21%|        | 10511/50245 [00:04<00:17, 2268.57 examples/s]
Map:  21%|       | 10762/50245 [00:04<00:16, 2323.87 examples/s]
Map:  22%|       | 11000/50245 [00:04<00:17, 2221.01 examples/s]
Map:  22%|       | 11240/50245 [00:05<00:17, 2263.41 examples/s]
Map:  23%|       | 11479/50245 [00:05<00:16, 2293.94 examples/s]
Map:  23%|       | 11731/50245 [00:05<00:16, 2354.39 examples/s]
Map:  24%|       | 11974/50245 [00:05<00:16, 2373.04 examples/s]
Map:  24%|       | 12289/50245 [00:05<00:16, 2265.29 examples/s]
Map:  25%|       | 12522/50245 [00:05<00:16, 2281.06 examples/s]
Map:  25%|       | 12788/50245 [00:05<00:15, 2382.52 examples/s]
Map:  26%|       | 13122/50245 [00:05<00:16, 2295.81 examples/s]
Map:  27%|       | 13379/50245 [00:05<00:15, 2365.25 examples/s]
Map:  27%|       | 13731/50245 [00:06<00:15, 2355.63 examples/s]
Map:  28%|       | 13973/50245 [00:06<00:15, 2370.70 examples/s]
Map:  28%|       | 14281/50245 [00:06<00:15, 2256.58 examples/s]
Map:  29%|       | 14517/50245 [00:06<00:15, 2280.63 examples/s]
Map:  29%|       | 14768/50245 [00:06<00:15, 2336.74 examples/s]
Map:  30%|       | 15119/50245 [00:06<00:15, 2282.55 examples/s]
Map:  31%|       | 15351/50245 [00:06<00:15, 2290.00 examples/s]
Map:  31%|       | 15692/50245 [00:06<00:15, 2281.51 examples/s]
Map:  32%|      | 15933/50245 [00:07<00:14, 2307.11 examples/s]
Map:  32%|      | 16235/50245 [00:07<00:15, 2173.48 examples/s]
Map:  33%|      | 16485/50245 [00:07<00:14, 2252.64 examples/s]
Map:  33%|      | 16739/50245 [00:07<00:14, 2324.22 examples/s]
Map:  34%|      | 16984/50245 [00:07<00:14, 2355.33 examples/s]
Map:  34%|      | 17290/50245 [00:07<00:14, 2237.80 examples/s]
Map:  35%|      | 17527/50245 [00:07<00:14, 2269.80 examples/s]
Map:  35%|      | 17776/50245 [00:07<00:13, 2327.16 examples/s]
Map:  36%|      | 18125/50245 [00:08<00:14, 2227.71 examples/s]
Map:  37%|      | 18362/50245 [00:08<00:14, 2260.35 examples/s]
Map:  37%|      | 18604/50245 [00:08<00:13, 2298.00 examples/s]
Map:  38%|      | 18846/50245 [00:08<00:13, 2328.17 examples/s]
Map:  38%|      | 19162/50245 [00:08<00:13, 2241.82 examples/s]
Map:  39%|      | 19398/50245 [00:08<00:13, 2270.90 examples/s]
Map:  39%|      | 19638/50245 [00:08<00:13, 2305.42 examples/s]
Map:  40%|      | 19879/50245 [00:08<00:13, 2333.60 examples/s]
Map:  40%|      | 20239/50245 [00:08<00:13, 2243.47 examples/s]
Map:  41%|      | 20484/50245 [00:09<00:12, 2290.76 examples/s]
Map:  41%|     | 20728/50245 [00:09<00:12, 2325.77 examples/s]
Map:  42%|     | 21025/50245 [00:09<00:13, 2197.46 examples/s]
Map:  42%|     | 21264/50245 [00:09<00:12, 2239.99 examples/s]
Map:  43%|     | 21507/50245 [00:09<00:12, 2289.53 examples/s]
Map:  43%|     | 21753/50245 [00:09<00:12, 2334.35 examples/s]
Map:  44%|     | 22052/50245 [00:09<00:12, 2204.65 examples/s]
Map:  44%|     | 22284/50245 [00:09<00:12, 2233.68 examples/s]
Map:  45%|     | 22524/50245 [00:09<00:12, 2273.98 examples/s]
Map:  45%|     | 22763/50245 [00:10<00:11, 2304.34 examples/s]
Map:  46%|     | 23000/50245 [00:10<00:12, 2193.62 examples/s]
Map:  46%|     | 23237/50245 [00:10<00:12, 2241.15 examples/s]
Map:  47%|     | 23493/50245 [00:10<00:11, 2329.71 examples/s]
Map:  47%|     | 23841/50245 [00:10<00:11, 2320.59 examples/s]
Map:  48%|     | 24142/50245 [00:10<00:11, 2204.85 examples/s]
Map:  49%|     | 24375/50245 [00:10<00:11, 2234.56 examples/s]
Map:  49%|     | 24729/50245 [00:10<00:11, 2276.20 examples/s]
Map:  50%|     | 24978/50245 [00:11<00:10, 2325.29 examples/s]
Map:  50%|     | 25289/50245 [00:11<00:11, 2236.63 examples/s]
Map:  51%|     | 25549/50245 [00:11<00:10, 2326.67 examples/s]
Map:  52%|    | 25898/50245 [00:11<00:10, 2320.62 examples/s]
Map:  52%|    | 26233/50245 [00:11<00:10, 2204.77 examples/s]
Map:  53%|    | 26469/50245 [00:11<00:10, 2239.11 examples/s]
Map:  53%|    | 26714/50245 [00:11<00:10, 2290.61 examples/s]
Map:  54%|    | 26959/50245 [00:11<00:09, 2330.26 examples/s]
Map:  54%|    | 27267/50245 [00:12<00:10, 2227.05 examples/s]
Map:  55%|    | 27520/50245 [00:12<00:09, 2301.52 examples/s]
Map:  55%|    | 27877/50245 [00:12<00:09, 2324.11 examples/s]
Map:  56%|    | 28165/50245 [00:12<00:10, 2184.15 examples/s]
Map:  57%|    | 28415/50245 [00:12<00:09, 2255.79 examples/s]
Map:  57%|    | 28657/50245 [00:12<00:09, 2297.57 examples/s]
Map:  58%|    | 28892/50245 [00:12<00:09, 2308.15 examples/s]
Map:  58%|    | 29238/50245 [00:12<00:09, 2210.39 examples/s]
Map:  59%|    | 29470/50245 [00:13<00:09, 2234.34 examples/s]
Map:  59%|    | 29699/50245 [00:13<00:09, 2244.48 examples/s]
Map:  60%|    | 29939/50245 [00:13<00:08, 2284.18 examples/s]
Map:  60%|    | 30245/50245 [00:13<00:09, 2190.78 examples/s]
Map:  61%|    | 30482/50245 [00:13<00:08, 2236.12 examples/s]
Map:  61%|    | 30721/50245 [00:13<00:08, 2273.34 examples/s]
Map:  62%|   | 30963/50245 [00:13<00:08, 2311.30 examples/s]
Map:  62%|   | 31265/50245 [00:13<00:08, 2193.59 examples/s]
Map:  63%|   | 31503/50245 [00:13<00:08, 2240.46 examples/s]
Map:  63%|   | 31752/50245 [00:14<00:08, 2305.22 examples/s]
Map:  64%|   | 32052/50245 [00:14<00:08, 2190.75 examples/s]
Map:  64%|   | 32279/50245 [00:14<00:08, 2208.95 examples/s]
Map:  65%|   | 32529/50245 [00:14<00:07, 2281.38 examples/s]
Map:  65%|   | 32782/50245 [00:14<00:07, 2348.16 examples/s]
Map:  66%|   | 33131/50245 [00:14<00:07, 2262.50 examples/s]
Map:  66%|   | 33374/50245 [00:14<00:07, 2302.26 examples/s]
Map:  67%|   | 33615/50245 [00:14<00:07, 2329.33 examples/s]
Map:  67%|   | 33853/50245 [00:14<00:06, 2341.91 examples/s]
Map:  68%|   | 34160/50245 [00:15<00:07, 2228.24 examples/s]
Map:  68%|   | 34410/50245 [00:15<00:06, 2296.44 examples/s]
Map:  69%|   | 34657/50245 [00:15<00:06, 2340.75 examples/s]
Map:  69%|   | 34916/50245 [00:15<00:06, 2405.97 examples/s]
Map:  70%|   | 35240/50245 [00:15<00:06, 2283.15 examples/s]
Map:  71%|   | 35477/50245 [00:15<00:06, 2302.44 examples/s]
Map:  71%|   | 35716/50245 [00:15<00:06, 2322.86 examples/s]
Map:  72%|  | 35958/50245 [00:15<00:06, 2347.18 examples/s]
Map:  72%|  | 36275/50245 [00:15<00:06, 2257.18 examples/s]
Map:  73%|  | 36523/50245 [00:16<00:05, 2311.81 examples/s]
Map:  73%|  | 36762/50245 [00:16<00:05, 2330.57 examples/s]
Map:  74%|  | 37000/50245 [00:16<00:06, 2196.57 examples/s]
Map:  74%|  | 37334/50245 [00:16<00:05, 2202.41 examples/s]
Map:  75%|  | 37581/50245 [00:16<00:05, 2266.40 examples/s]
Map:  75%|  | 37818/50245 [00:16<00:05, 2289.02 examples/s]
Map:  76%|  | 38117/50245 [00:16<00:05, 2176.93 examples/s]
Map:  76%|  | 38347/50245 [00:16<00:05, 2205.89 examples/s]
Map:  77%|  | 38603/50245 [00:17<00:05, 2298.36 examples/s]
Map:  77%|  | 38855/50245 [00:17<00:04, 2355.37 examples/s]
Map:  78%|  | 39172/50245 [00:17<00:04, 2261.97 examples/s]
Map:  78%|  | 39420/50245 [00:17<00:04, 2316.60 examples/s]
Map:  79%|  | 39775/50245 [00:17<00:04, 2330.74 examples/s]
Map:  80%|  | 40121/50245 [00:17<00:04, 2232.18 examples/s]
Map:  80%|  | 40380/50245 [00:17<00:04, 2315.53 examples/s]
Map:  81%|  | 40632/50245 [00:17<00:04, 2365.92 examples/s]
Map:  82%| | 40987/50245 [00:18<00:03, 2361.78 examples/s]
Map:  82%| | 41287/50245 [00:18<00:04, 2238.98 examples/s]
Map:  83%| | 41522/50245 [00:18<00:03, 2265.49 examples/s]
Map:  83%| | 41765/50245 [00:18<00:03, 2306.45 examples/s]
Map:  84%| | 42059/50245 [00:18<00:03, 2181.48 examples/s]
Map:  84%| | 42307/50245 [00:18<00:03, 2254.25 examples/s]
Map:  85%| | 42553/50245 [00:18<00:03, 2306.73 examples/s]
Map:  85%| | 42793/50245 [00:18<00:03, 2328.93 examples/s]
Map:  86%| | 43118/50245 [00:19<00:03, 2204.05 examples/s]
Map:  86%| | 43380/50245 [00:19<00:02, 2306.99 examples/s]
Map:  87%| | 43630/50245 [00:19<00:02, 2355.43 examples/s]
Map:  87%| | 43871/50245 [00:19<00:02, 2366.32 examples/s]
Map:  88%| | 44178/50245 [00:19<00:02, 2245.25 examples/s]
Map:  88%| | 44413/50245 [00:19<00:02, 2270.38 examples/s]
Map:  89%| | 44658/50245 [00:19<00:02, 2315.49 examples/s]
Map:  89%| | 44896/50245 [00:19<00:02, 2331.76 examples/s]
Map:  90%| | 45233/50245 [00:19<00:02, 2226.39 examples/s]
Map:  90%| | 45462/50245 [00:20<00:02, 2241.24 examples/s]
Map:  91%| | 45702/50245 [00:20<00:01, 2281.83 examples/s]
Map:  91%|| 45952/50245 [00:20<00:01, 2339.35 examples/s]
Map:  92%|| 46258/50245 [00:20<00:01, 2224.73 examples/s]
Map:  93%|| 46510/50245 [00:20<00:01, 2296.31 examples/s]
Map:  93%|| 46750/50245 [00:20<00:01, 2320.36 examples/s]
Map:  94%|| 47000/50245 [00:20<00:01, 2232.80 examples/s]
Map:  94%|| 47243/50245 [00:20<00:01, 2284.83 examples/s]
Map:  95%|| 47586/50245 [00:20<00:01, 2279.80 examples/s]
Map:  95%|| 47924/50245 [00:21<00:01, 1760.37 examples/s]
Map:  96%|| 48122/50245 [00:21<00:01, 1783.84 examples/s]
Map:  96%|| 48382/50245 [00:21<00:00, 1963.33 examples/s]
Map:  97%|| 48625/50245 [00:21<00:00, 2073.14 examples/s]
Map:  97%|| 48865/50245 [00:21<00:00, 2156.21 examples/s]
Map:  98%|| 49172/50245 [00:21<00:00, 2112.79 examples/s]
Map:  98%|| 49401/50245 [00:21<00:00, 2155.26 examples/s]
Map:  99%|| 49641/50245 [00:21<00:00, 2217.22 examples/s]
Map:  99%|| 49879/50245 [00:22<00:00, 2259.57 examples/s]
Map: 100%|| 50119/50245 [00:22<00:00, 2159.92 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2255.43 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:04, 10159.54 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 10198.28 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 10311.76 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 10382.08 examples/s]
Filter:  20%|        | 10000/50245 [00:00<00:03, 10331.51 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 10308.30 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 10423.28 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 10371.70 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9992.46 examples/s] 
Filter:  40%|      | 20000/50245 [00:01<00:02, 10177.40 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 10229.01 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 10240.28 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 10246.21 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 10322.76 examples/s]
Filter:  60%|    | 30000/50245 [00:02<00:01, 10310.68 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 10360.33 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 10344.32 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 10411.92 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 10439.96 examples/s]
Filter:  80%|  | 40000/50245 [00:03<00:00, 10462.92 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 10454.91 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 10486.50 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 10393.91 examples/s]
Filter:  96%|| 48000/50245 [00:04<00:00, 10408.13 examples/s]
Filter: 100%|| 50000/50245 [00:04<00:00, 10366.99 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10319.65 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:06, 7496.01 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 8440.12 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 8869.55 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:05, 9026.61 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:05, 8975.82 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9182.37 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9335.68 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9362.13 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9433.22 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9475.29 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9495.52 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:04, 9508.65 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9633.77 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9536.85 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9509.17 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9439.06 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9502.47 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9503.94 examples/s]
Filter:  38%|      | 19000/50245 [00:02<00:03, 9581.62 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9637.76 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9630.85 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9504.69 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9524.08 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9524.32 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9384.55 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9505.70 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9476.22 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 9568.65 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9577.24 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9557.91 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9613.53 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9624.48 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9657.11 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9672.58 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9603.35 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9601.95 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9644.31 examples/s]
Filter:  76%|  | 38000/50245 [00:04<00:01, 9553.01 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9618.56 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9612.98 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9658.65 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9601.98 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9673.45 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9758.84 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9697.80 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9649.69 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 9693.73 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9617.94 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9701.63 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9604.71 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9490.39 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [14] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x1478c31854d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x1478c314f434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x1478ee6ee8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x1478ee6ef572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x1478ee6ef5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1478ee6aeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1478ee6aeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1478ee6aeac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x1478c4114c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x1478c4118901 in 
ERROR:composer.cli.launcher:Global rank 12 (PID 215939) exited with code 143
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x1478c411fa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x1478c4120e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x1478c4123aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x1478c4132a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x1478ee6a32d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x1478ee6a702a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x1478ee6b5e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x147902d33fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14790257f285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14793c1edcf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 14 STDERR----------
Global rank 15 (PID 215942) exited with code 1
----------Begin global rank 15 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 15 STDOUT----------
----------Begin global rank 15 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 234/50245 [00:00<00:21, 2317.79 examples/s]
Map:   1%|          | 488/50245 [00:00<00:20, 2443.11 examples/s]
Map:   1%|         | 741/50245 [00:00<00:19, 2481.84 examples/s]
Map:   2%|         | 1043/50245 [00:00<00:21, 2244.98 examples/s]
Map:   3%|         | 1386/50245 [00:00<00:21, 2256.72 examples/s]
Map:   3%|         | 1735/50245 [00:00<00:21, 2278.64 examples/s]
Map:   4%|         | 1976/50245 [00:00<00:20, 2310.49 examples/s]
Map:   5%|         | 2287/50245 [00:01<00:21, 2222.55 examples/s]
Map:   5%|         | 2518/50245 [00:01<00:21, 2241.47 examples/s]
Map:   5%|         | 2754/50245 [00:01<00:20, 2270.93 examples/s]
Map:   6%|         | 3049/50245 [00:01<00:21, 2158.73 examples/s]
Map:   7%|         | 3274/50245 [00:01<00:21, 2180.55 examples/s]
Map:   7%|         | 3522/50245 [00:01<00:20, 2257.79 examples/s]
Map:   8%|         | 3862/50245 [00:01<00:20, 2257.65 examples/s]
Map:   8%|         | 4160/50245 [00:01<00:21, 2162.97 examples/s]
Map:   9%|         | 4392/50245 [00:01<00:20, 2199.47 examples/s]
Map:   9%|         | 4634/50245 [00:02<00:20, 2254.23 examples/s]
Map:  10%|         | 4967/50245 [00:02<00:20, 2239.10 examples/s]
Map:  11%|         | 5277/50245 [00:02<00:20, 2180.04 examples/s]
Map:  11%|         | 5525/50245 [00:02<00:19, 2248.71 examples/s]
Map:  11%|        | 5763/50245 [00:02<00:19, 2280.36 examples/s]
Map:  12%|        | 6000/50245 [00:02<00:20, 2192.55 examples/s]
Map:  12%|        | 6241/50245 [00:02<00:19, 2246.99 examples/s]
Map:  13%|        | 6488/50245 [00:02<00:18, 2307.72 examples/s]
Map:  13%|        | 6731/50245 [00:02<00:18, 2339.99 examples/s]
Map:  14%|        | 6989/50245 [00:03<00:17, 2405.05 examples/s]
Map:  15%|        | 7296/50245 [00:03<00:18, 2265.37 examples/s]
Map:  15%|        | 7531/50245 [00:03<00:18, 2283.09 examples/s]
Map:  15%|        | 7767/50245 [00:03<00:18, 2302.08 examples/s]
Map:  16%|        | 8000/50245 [00:03<00:19, 2221.89 examples/s]
Map:  16%|        | 8249/50245 [00:03<00:18, 2294.59 examples/s]
Map:  17%|        | 8484/50245 [00:03<00:18, 2308.11 examples/s]
Map:  17%|        | 8726/50245 [00:03<00:17, 2338.81 examples/s]
Map:  18%|        | 8974/50245 [00:03<00:17, 2376.01 examples/s]
Map:  19%|        | 9297/50245 [00:04<00:17, 2285.43 examples/s]
Map:  19%|        | 9546/50245 [00:04<00:17, 2337.72 examples/s]
Map:  20%|        | 9901/50245 [00:04<00:17, 2344.44 examples/s]
Map:  20%|        | 10242/50245 [00:04<00:17, 2237.26 examples/s]
Map:  21%|        | 10473/50245 [00:04<00:17, 2250.90 examples/s]
Map:  21%|       | 10720/50245 [00:04<00:17, 2303.18 examples/s]
Map:  22%|       | 10965/50245 [00:04<00:16, 2341.76 examples/s]
Map:  22%|       | 11272/50245 [00:04<00:17, 2229.11 examples/s]
Map:  23%|       | 11512/50245 [00:05<00:17, 2270.80 examples/s]
Map:  23%|       | 11762/50245 [00:05<00:16, 2330.62 examples/s]
Map:  24%|       | 12000/50245 [00:05<00:17, 2206.31 examples/s]
Map:  24%|       | 12249/50245 [00:05<00:16, 2281.72 examples/s]
Map:  25%|       | 12483/50245 [00:05<00:16, 2292.86 examples/s]
Map:  25%|       | 12735/50245 [00:05<00:15, 2354.41 examples/s]
Map:  26%|       | 12995/50245 [00:05<00:15, 2419.24 examples/s]
Map:  26%|       | 13314/50245 [00:05<00:16, 2301.37 examples/s]
Map:  27%|       | 13669/50245 [00:05<00:15, 2318.10 examples/s]
Map:  28%|       | 14000/50245 [00:06<00:16, 2210.55 examples/s]
Map:  28%|       | 14233/50245 [00:06<00:16, 2236.42 examples/s]
Map:  29%|       | 14468/50245 [00:06<00:15, 2259.59 examples/s]
Map:  29%|       | 14710/50245 [00:06<00:15, 2299.14 examples/s]
Map:  30%|       | 14965/50245 [00:06<00:14, 2364.21 examples/s]
Map:  30%|       | 15274/50245 [00:06<00:15, 2250.06 examples/s]
Map:  31%|       | 15615/50245 [00:06<00:15, 2255.49 examples/s]
Map:  32%|      | 15855/50245 [00:06<00:15, 2288.44 examples/s]
Map:  32%|      | 16157/50245 [00:07<00:15, 2188.78 examples/s]
Map:  33%|      | 16391/50245 [00:07<00:15, 2223.58 examples/s]
Map:  33%|      | 16653/50245 [00:07<00:14, 2324.21 examples/s]
Map:  34%|      | 16893/50245 [00:07<00:14, 2342.86 examples/s]
Map:  34%|      | 17247/50245 [00:07<00:14, 2265.04 examples/s]
Map:  35%|      | 17480/50245 [00:07<00:14, 2279.10 examples/s]
Map:  35%|      | 17734/50245 [00:07<00:13, 2344.87 examples/s]
Map:  36%|      | 17973/50245 [00:07<00:13, 2351.69 examples/s]
Map:  36%|      | 18283/50245 [00:08<00:14, 2242.84 examples/s]
Map:  37%|      | 18530/50245 [00:08<00:13, 2297.78 examples/s]
Map:  37%|      | 18767/50245 [00:08<00:13, 2312.90 examples/s]
Map:  38%|      | 19133/50245 [00:08<00:13, 2235.50 examples/s]
Map:  39%|      | 19372/50245 [00:08<00:13, 2272.36 examples/s]
Map:  39%|      | 19614/50245 [00:08<00:13, 2309.75 examples/s]
Map:  40%|      | 19855/50245 [00:08<00:13, 2335.27 examples/s]
Map:  40%|      | 20167/50245 [00:08<00:13, 2237.04 examples/s]
Map:  41%|      | 20411/50245 [00:08<00:13, 2288.39 examples/s]
Map:  41%|      | 20664/50245 [00:09<00:12, 2353.31 examples/s]
Map:  42%|     | 21000/50245 [00:09<00:13, 2201.32 examples/s]
Map:  42%|     | 21247/50245 [00:09<00:12, 2261.63 examples/s]
Map:  43%|     | 21481/50245 [00:09<00:12, 2280.70 examples/s]
Map:  43%|     | 21733/50245 [00:09<00:12, 2341.55 examples/s]
Map:  44%|     | 22029/50245 [00:09<00:12, 2200.57 examples/s]
Map:  45%|     | 22382/50245 [00:09<00:12, 2250.56 examples/s]
Map:  45%|     | 22624/50245 [00:09<00:12, 2288.55 examples/s]
Map:  46%|     | 22871/50245 [00:10<00:11, 2333.60 examples/s]
Map:  46%|     | 23169/50245 [00:10<00:12, 2204.50 examples/s]
Map:  47%|     | 23427/50245 [00:10<00:11, 2296.77 examples/s]
Map:  47%|     | 23667/50245 [00:10<00:11, 2321.98 examples/s]
Map:  48%|     | 23905/50245 [00:10<00:11, 2337.54 examples/s]
Map:  48%|     | 24217/50245 [00:10<00:11, 2180.85 examples/s]
Map:  49%|     | 24462/50245 [00:10<00:11, 2246.00 examples/s]
Map:  49%|     | 24701/50245 [00:10<00:11, 2282.43 examples/s]
Map:  50%|     | 24954/50245 [00:10<00:10, 2346.66 examples/s]
Map:  50%|     | 25271/50245 [00:11<00:11, 2253.90 examples/s]
Map:  51%|     | 25528/50245 [00:11<00:10, 2334.02 examples/s]
Map:  51%|    | 25768/50245 [00:11<00:10, 2340.77 examples/s]
Map:  52%|    | 26060/50245 [00:11<00:11, 2191.13 examples/s]
Map:  52%|    | 26301/50245 [00:11<00:10, 2246.65 examples/s]
Map:  53%|    | 26535/50245 [00:11<00:10, 2265.43 examples/s]
Map:  53%|    | 26785/50245 [00:11<00:10, 2327.52 examples/s]
Map:  54%|    | 27107/50245 [00:11<00:10, 2187.44 examples/s]
Map:  54%|    | 27380/50245 [00:12<00:09, 2321.88 examples/s]
Map:  55%|    | 27626/50245 [00:12<00:09, 2357.28 examples/s]
Map:  55%|    | 27867/50245 [00:12<00:09, 2368.84 examples/s]
Map:  56%|    | 28156/50245 [00:12<00:10, 2202.52 examples/s]
Map:  57%|    | 28406/50245 [00:12<00:09, 2277.78 examples/s]
Map:  57%|    | 28651/50245 [00:12<00:09, 2323.64 examples/s]
Map:  58%|    | 29000/50245 [00:12<00:09, 2218.30 examples/s]
Map:  58%|    | 29247/50245 [00:12<00:09, 2279.92 examples/s]
Map:  59%|    | 29484/50245 [00:12<00:09, 2299.35 examples/s]
Map:  59%|    | 29837/50245 [00:13<00:08, 2314.87 examples/s]
Map:  60%|    | 30135/50245 [00:13<00:09, 2201.81 examples/s]
Map:  60%|    | 30381/50245 [00:13<00:08, 2260.25 examples/s]
Map:  61%|    | 30630/50245 [00:13<00:08, 2318.44 examples/s]
Map:  61%|   | 30867/50245 [00:13<00:08, 2328.28 examples/s]
Map:  62%|   | 31175/50245 [00:13<00:08, 2224.47 examples/s]
Map:  63%|   | 31416/50245 [00:13<00:08, 2269.37 examples/s]
Map:  63%|   | 31666/50245 [00:13<00:07, 2328.54 examples/s]
Map:  64%|   | 32000/50245 [00:14<00:08, 2216.69 examples/s]
Map:  64%|   | 32233/50245 [00:14<00:08, 2243.89 examples/s]
Map:  65%|   | 32476/50245 [00:14<00:07, 2291.13 examples/s]
Map:  65%|   | 32723/50245 [00:14<00:07, 2337.56 examples/s]
Map:  66%|   | 32969/50245 [00:14<00:07, 2369.24 examples/s]
Map:  66%|   | 33287/50245 [00:14<00:07, 2273.81 examples/s]
Map:  67%|   | 33529/50245 [00:14<00:07, 2311.24 examples/s]
Map:  67%|   | 33765/50245 [00:14<00:07, 2321.00 examples/s]
Map:  68%|   | 34000/50245 [00:14<00:07, 2203.74 examples/s]
Map:  68%|   | 34252/50245 [00:15<00:06, 2290.40 examples/s]
Map:  69%|   | 34505/50245 [00:15<00:06, 2351.71 examples/s]
Map:  69%|   | 34748/50245 [00:15<00:06, 2370.47 examples/s]
Map:  70%|   | 35000/50245 [00:15<00:06, 2291.44 examples/s]
Map:  70%|   | 35238/50245 [00:15<00:06, 2313.75 examples/s]
Map:  71%|   | 35475/50245 [00:15<00:06, 2325.85 examples/s]
Map:  71%|   | 35712/50245 [00:15<00:06, 2337.19 examples/s]
Map:  72%|  | 35951/50245 [00:15<00:06, 2349.82 examples/s]
Map:  72%|  | 36268/50245 [00:15<00:06, 2255.29 examples/s]
Map:  73%|  | 36517/50245 [00:16<00:05, 2315.77 examples/s]
Map:  73%|  | 36759/50245 [00:16<00:05, 2342.26 examples/s]
Map:  74%|  | 37000/50245 [00:16<00:06, 2204.64 examples/s]
Map:  74%|  | 37333/50245 [00:16<00:05, 2205.58 examples/s]
Map:  75%|  | 37581/50245 [00:16<00:05, 2273.84 examples/s]
Map:  75%|  | 37818/50245 [00:16<00:05, 2295.50 examples/s]
Map:  76%|  | 38117/50245 [00:16<00:05, 2180.67 examples/s]
Map:  76%|  | 38349/50245 [00:16<00:05, 2214.72 examples/s]
Map:  77%|  | 38604/50245 [00:16<00:05, 2303.67 examples/s]
Map:  77%|  | 38858/50245 [00:17<00:04, 2362.13 examples/s]
Map:  78%|  | 39173/50245 [00:17<00:04, 2262.49 examples/s]
Map:  78%|  | 39418/50245 [00:17<00:04, 2310.49 examples/s]
Map:  79%|  | 39653/50245 [00:17<00:04, 2319.83 examples/s]
Map:  79%|  | 39893/50245 [00:17<00:04, 2338.58 examples/s]
Map:  80%|  | 40250/50245 [00:17<00:04, 2248.65 examples/s]
Map:  81%|  | 40513/50245 [00:17<00:04, 2342.80 examples/s]
Map:  81%|  | 40752/50245 [00:17<00:04, 2350.43 examples/s]
Map:  82%| | 41058/50245 [00:18<00:04, 2236.00 examples/s]
Map:  82%| | 41288/50245 [00:18<00:03, 2250.10 examples/s]
Map:  83%| | 41524/50245 [00:18<00:03, 2276.41 examples/s]
Map:  83%| | 41766/50245 [00:18<00:03, 2312.17 examples/s]
Map:  84%| | 42059/50245 [00:18<00:03, 2175.29 examples/s]
Map:  84%| | 42309/50245 [00:18<00:03, 2257.75 examples/s]
Map:  85%| | 42558/50245 [00:18<00:03, 2316.63 examples/s]
Map:  85%| | 42801/50245 [00:18<00:03, 2343.96 examples/s]
Map:  86%| | 43118/50245 [00:18<00:03, 2210.73 examples/s]
Map:  86%| | 43382/50245 [00:19<00:02, 2318.57 examples/s]
Map:  87%| | 43635/50245 [00:19<00:02, 2374.45 examples/s]
Map:  88%| | 44000/50245 [00:19<00:02, 2278.45 examples/s]
Map:  88%| | 44352/50245 [00:19<00:02, 2297.69 examples/s]
Map:  89%| | 44589/50245 [00:19<00:02, 2312.87 examples/s]
Map:  89%| | 44835/50245 [00:19<00:02, 2347.07 examples/s]
Map:  90%| | 45145/50245 [00:19<00:02, 2244.60 examples/s]
Map:  90%| | 45375/50245 [00:19<00:02, 2257.70 examples/s]
Map:  91%| | 45622/50245 [00:19<00:01, 2312.61 examples/s]
Map:  91%|| 45866/50245 [00:20<00:01, 2343.20 examples/s]
Map:  92%|| 46174/50245 [00:20<00:01, 2232.99 examples/s]
Map:  92%|| 46414/50245 [00:20<00:01, 2274.18 examples/s]
Map:  93%|| 46663/50245 [00:20<00:01, 2330.11 examples/s]
Map:  93%|| 46906/50245 [00:20<00:01, 2354.27 examples/s]
Map:  94%|| 47242/50245 [00:20<00:01, 2250.53 examples/s]
Map:  95%|| 47586/50245 [00:20<00:01, 2259.92 examples/s]
Map:  95%|| 47924/50245 [00:21<00:01, 1791.31 examples/s]
Map:  96%|| 48122/50245 [00:21<00:01, 1809.13 examples/s]
Map:  96%|| 48380/50245 [00:21<00:00, 1976.91 examples/s]
Map:  97%|| 48629/50245 [00:21<00:00, 2098.82 examples/s]
Map:  97%|| 48868/50245 [00:21<00:00, 2170.48 examples/s]
Map:  98%|| 49180/50245 [00:21<00:00, 2132.85 examples/s]
Map:  98%|| 49404/50245 [00:21<00:00, 2158.63 examples/s]
Map:  99%|| 49646/50245 [00:21<00:00, 2223.33 examples/s]
Map:  99%|| 49879/50245 [00:21<00:00, 2250.79 examples/s]
Map: 100%|| 50119/50245 [00:22<00:00, 2156.46 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2265.52 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 9420.45 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9351.10 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 9401.89 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:04, 9421.32 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9430.41 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9527.69 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9575.43 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9551.60 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9616.66 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9595.11 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9617.28 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9585.34 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9696.41 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9658.72 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9660.48 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9592.60 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9688.09 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9651.38 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:03, 9652.24 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9716.97 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:03, 9694.70 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9652.74 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9624.57 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9594.59 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9562.92 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9564.43 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9537.10 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 9597.39 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9555.02 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9535.87 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:02, 9602.74 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9607.73 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9640.39 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9616.69 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 9645.84 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9552.85 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9602.45 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 9478.33 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9502.63 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9446.68 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9495.84 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9397.93 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9441.71 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9529.78 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9486.82 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9324.89 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 9383.91 examples/s]
Filter:  96%|| 48000/50245 [00:05<00:00, 9299.81 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9374.93 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9313.17 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9369.25 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [15] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x149a8af8c4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x149a8af56434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x149ab64f58c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x149ab64f6572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x149ab64f65f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149ab64b5ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149ab64b5ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x149ab64b5ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x149a8bf1bc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x149a8bf1f901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x149a8bf26a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x149a8bf27e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x149a8bf2aaed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x149a8bf39a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x149ab64aa2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x149ab64ae02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x149ab64bce90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x149acab3afee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x149aca386285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x149b03ff4cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 15 STDERR----------
Global rank 4 (PID 196574) exited with code 143
Global rank 5 (PID 196575) exited with code 1
----------Begin global rank 5 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 5 STDOUT----------
----------Begin global rank 5 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 243/50245 [00:00<00:20, 2389.63 examples/s]
Map:   1%|          | 500/50245 [00:00<00:20, 2486.60 examples/s]
Map:   2%|         | 756/50245 [00:00<00:19, 2513.74 examples/s]
Map:   2%|         | 1119/50245 [00:00<00:21, 2281.28 examples/s]
Map:   3%|         | 1467/50245 [00:00<00:21, 2292.51 examples/s]
Map:   3%|         | 1703/50245 [00:00<00:21, 2307.26 examples/s]
Map:   4%|         | 1941/50245 [00:00<00:20, 2326.10 examples/s]
Map:   5%|         | 2268/50245 [00:00<00:21, 2262.90 examples/s]
Map:   5%|         | 2506/50245 [00:01<00:20, 2291.67 examples/s]
Map:   5%|         | 2742/50245 [00:01<00:20, 2309.06 examples/s]
Map:   6%|         | 3041/50245 [00:01<00:21, 2190.41 examples/s]
Map:   7%|         | 3271/50245 [00:01<00:21, 2217.71 examples/s]
Map:   7%|         | 3522/50245 [00:01<00:20, 2295.47 examples/s]
Map:   8%|         | 3861/50245 [00:01<00:20, 2279.69 examples/s]
Map:   8%|         | 4161/50245 [00:01<00:21, 2180.51 examples/s]
Map:   9%|         | 4397/50245 [00:01<00:20, 2221.01 examples/s]
Map:   9%|         | 4644/50245 [00:02<00:19, 2283.95 examples/s]
Map:  10%|         | 4976/50245 [00:02<00:20, 2255.34 examples/s]
Map:  11%|         | 5292/50245 [00:02<00:20, 2202.54 examples/s]
Map:  11%|         | 5544/50245 [00:02<00:19, 2278.41 examples/s]
Map:  12%|        | 5785/50245 [00:02<00:19, 2310.14 examples/s]
Map:  12%|        | 6126/50245 [00:02<00:19, 2243.06 examples/s]
Map:  13%|        | 6369/50245 [00:02<00:19, 2287.45 examples/s]
Map:  13%|        | 6621/50245 [00:02<00:18, 2344.95 examples/s]
Map:  14%|        | 6873/50245 [00:02<00:18, 2389.83 examples/s]
Map:  14%|        | 7118/50245 [00:03<00:19, 2258.77 examples/s]
Map:  15%|        | 7364/50245 [00:03<00:18, 2311.48 examples/s]
Map:  15%|        | 7607/50245 [00:03<00:18, 2338.99 examples/s]
Map:  16%|        | 7857/50245 [00:03<00:17, 2378.95 examples/s]
Map:  16%|        | 8178/50245 [00:03<00:18, 2286.08 examples/s]
Map:  17%|        | 8415/50245 [00:03<00:18, 2303.95 examples/s]
Map:  17%|        | 8663/50245 [00:03<00:17, 2349.43 examples/s]
Map:  18%|        | 8912/50245 [00:03<00:17, 2384.10 examples/s]
Map:  18%|        | 9245/50245 [00:04<00:17, 2281.06 examples/s]
Map:  19%|        | 9507/50245 [00:04<00:17, 2366.73 examples/s]
Map:  20%|        | 9859/50245 [00:04<00:17, 2355.72 examples/s]
Map:  20%|        | 10168/50245 [00:04<00:17, 2252.96 examples/s]
Map:  21%|        | 10398/50245 [00:04<00:17, 2258.99 examples/s]
Map:  21%|        | 10641/50245 [00:04<00:17, 2300.53 examples/s]
Map:  22%|       | 10894/50245 [00:04<00:16, 2360.87 examples/s]
Map:  22%|       | 11241/50245 [00:04<00:17, 2237.35 examples/s]
Map:  23%|       | 11478/50245 [00:05<00:17, 2266.81 examples/s]
Map:  23%|       | 11731/50245 [00:05<00:16, 2334.60 examples/s]
Map:  24%|       | 11976/50245 [00:05<00:16, 2361.43 examples/s]
Map:  24%|       | 12288/50245 [00:05<00:16, 2255.58 examples/s]
Map:  25%|       | 12521/50245 [00:05<00:16, 2273.74 examples/s]
Map:  25%|       | 12788/50245 [00:05<00:15, 2377.93 examples/s]
Map:  26%|       | 13125/50245 [00:05<00:16, 2291.99 examples/s]
Map:  27%|       | 13379/50245 [00:05<00:15, 2353.56 examples/s]
Map:  27%|       | 13729/50245 [00:05<00:15, 2342.43 examples/s]
Map:  28%|       | 13968/50245 [00:06<00:15, 2352.46 examples/s]
Map:  28%|       | 14275/50245 [00:06<00:16, 2241.20 examples/s]
Map:  29%|       | 14509/50245 [00:06<00:15, 2263.91 examples/s]
Map:  29%|       | 14761/50245 [00:06<00:15, 2327.29 examples/s]
Map:  30%|       | 15000/50245 [00:06<00:15, 2249.53 examples/s]
Map:  30%|       | 15240/50245 [00:06<00:15, 2288.69 examples/s]
Map:  31%|       | 15587/50245 [00:06<00:15, 2292.75 examples/s]
Map:  32%|      | 15833/50245 [00:06<00:14, 2333.19 examples/s]
Map:  32%|      | 16144/50245 [00:07<00:15, 2238.66 examples/s]
Map:  33%|      | 16382/50245 [00:07<00:14, 2271.60 examples/s]
Map:  33%|      | 16649/50245 [00:07<00:14, 2373.57 examples/s]
Map:  34%|      | 16894/50245 [00:07<00:13, 2391.14 examples/s]
Map:  34%|      | 17250/50245 [00:07<00:14, 2305.29 examples/s]
Map:  35%|      | 17487/50245 [00:07<00:14, 2318.38 examples/s]
Map:  35%|      | 17744/50245 [00:07<00:13, 2382.46 examples/s]
Map:  36%|      | 18048/50245 [00:07<00:14, 2251.58 examples/s]
Map:  36%|      | 18298/50245 [00:07<00:13, 2314.60 examples/s]
Map:  37%|      | 18546/50245 [00:08<00:13, 2357.99 examples/s]
Map:  37%|      | 18788/50245 [00:08<00:13, 2371.10 examples/s]
Map:  38%|      | 19135/50245 [00:08<00:13, 2276.38 examples/s]
Map:  39%|      | 19378/50245 [00:08<00:13, 2314.33 examples/s]
Map:  39%|      | 19625/50245 [00:08<00:13, 2354.33 examples/s]
Map:  40%|      | 19871/50245 [00:08<00:12, 2378.97 examples/s]
Map:  40%|      | 20186/50245 [00:08<00:13, 2273.19 examples/s]
Map:  41%|      | 20436/50245 [00:08<00:12, 2323.97 examples/s]
Map:  41%|      | 20688/50245 [00:08<00:12, 2375.95 examples/s]
Map:  42%|     | 21000/50245 [00:09<00:13, 2235.32 examples/s]
Map:  42%|     | 21250/50245 [00:09<00:12, 2298.69 examples/s]
Map:  43%|     | 21489/50245 [00:09<00:12, 2319.76 examples/s]
Map:  43%|     | 21743/50245 [00:09<00:11, 2380.13 examples/s]
Map:  44%|     | 22044/50245 [00:09<00:12, 2236.86 examples/s]
Map:  44%|     | 22277/50245 [00:09<00:12, 2258.67 examples/s]
Map:  45%|     | 22522/50245 [00:09<00:12, 2308.90 examples/s]
Map:  45%|     | 22766/50245 [00:09<00:11, 2340.01 examples/s]
Map:  46%|     | 23118/50245 [00:10<00:12, 2238.07 examples/s]
Map:  47%|     | 23378/50245 [00:10<00:11, 2327.44 examples/s]
Map:  47%|     | 23622/50245 [00:10<00:11, 2355.77 examples/s]
Map:  48%|     | 23985/50245 [00:10<00:11, 2373.84 examples/s]
Map:  48%|     | 24282/50245 [00:10<00:11, 2232.11 examples/s]
Map:  49%|     | 24510/50245 [00:10<00:11, 2241.52 examples/s]
Map:  49%|     | 24765/50245 [00:10<00:10, 2318.76 examples/s]
Map:  50%|     | 25000/50245 [00:10<00:11, 2231.15 examples/s]
Map:  50%|     | 25258/50245 [00:10<00:10, 2321.15 examples/s]
Map:  51%|     | 25516/50245 [00:11<00:10, 2390.49 examples/s]
Map:  51%|    | 25871/50245 [00:11<00:10, 2377.16 examples/s]
Map:  52%|    | 26165/50245 [00:11<00:10, 2230.62 examples/s]
Map:  53%|    | 26413/50245 [00:11<00:10, 2289.19 examples/s]
Map:  53%|    | 26655/50245 [00:11<00:10, 2318.05 examples/s]
Map:  54%|    | 26905/50245 [00:11<00:09, 2365.35 examples/s]
Map:  54%|    | 27250/50245 [00:11<00:10, 2268.72 examples/s]
Map:  55%|    | 27510/50245 [00:11<00:09, 2351.00 examples/s]
Map:  55%|    | 27873/50245 [00:12<00:09, 2371.52 examples/s]
Map:  56%|    | 28163/50245 [00:12<00:09, 2220.66 examples/s]
Map:  57%|    | 28419/50245 [00:12<00:09, 2301.04 examples/s]
Map:  57%|    | 28668/50245 [00:12<00:09, 2347.21 examples/s]
Map:  58%|    | 28907/50245 [00:12<00:09, 2356.21 examples/s]
Map:  58%|    | 29250/50245 [00:12<00:09, 2261.20 examples/s]
Map:  59%|    | 29490/50245 [00:12<00:09, 2292.28 examples/s]
Map:  59%|    | 29725/50245 [00:12<00:08, 2304.12 examples/s]
Map:  60%|    | 29958/50245 [00:13<00:08, 2309.88 examples/s]
Map:  60%|    | 30279/50245 [00:13<00:08, 2243.96 examples/s]
Map:  61%|    | 30525/50245 [00:13<00:08, 2295.89 examples/s]
Map:  61%|    | 30768/50245 [00:13<00:08, 2330.40 examples/s]
Map:  62%|   | 31124/50245 [00:13<00:08, 2236.79 examples/s]
Map:  62%|   | 31369/50245 [00:13<00:08, 2288.92 examples/s]
Map:  63%|   | 31616/50245 [00:13<00:07, 2332.45 examples/s]
Map:  63%|   | 31862/50245 [00:13<00:07, 2362.84 examples/s]
Map:  64%|   | 32166/50245 [00:13<00:08, 2236.84 examples/s]
Map:  64%|   | 32402/50245 [00:14<00:07, 2266.59 examples/s]
Map:  65%|   | 32663/50245 [00:14<00:07, 2357.63 examples/s]
Map:  66%|   | 32915/50245 [00:14<00:07, 2400.51 examples/s]
Map:  66%|   | 33252/50245 [00:14<00:07, 2293.41 examples/s]
Map:  67%|   | 33504/50245 [00:14<00:07, 2348.25 examples/s]
Map:  67%|   | 33864/50245 [00:14<00:06, 2364.28 examples/s]
Map:  68%|   | 34182/50245 [00:14<00:07, 2276.54 examples/s]
Map:  69%|   | 34438/50245 [00:14<00:06, 2341.19 examples/s]
Map:  69%|   | 34686/50245 [00:15<00:06, 2374.23 examples/s]
Map:  70%|   | 34943/50245 [00:15<00:06, 2424.61 examples/s]
Map:  70%|   | 35253/50245 [00:15<00:06, 2290.90 examples/s]
Map:  71%|   | 35492/50245 [00:15<00:06, 2314.24 examples/s]
Map:  71%|   | 35729/50245 [00:15<00:06, 2323.78 examples/s]
Map:  72%|  | 35974/50245 [00:15<00:06, 2354.53 examples/s]
Map:  72%|  | 36284/50245 [00:15<00:06, 2242.10 examples/s]
Map:  73%|  | 36532/50245 [00:15<00:05, 2299.36 examples/s]
Map:  73%|  | 36780/50245 [00:15<00:05, 2343.79 examples/s]
Map:  74%|  | 37113/50245 [00:16<00:05, 2191.56 examples/s]
Map:  75%|  | 37459/50245 [00:16<00:05, 2227.97 examples/s]
Map:  75%|  | 37690/50245 [00:16<00:05, 2245.28 examples/s]
Map:  75%|  | 37927/50245 [00:16<00:05, 2274.97 examples/s]
Map:  76%|  | 38231/50245 [00:16<00:05, 2154.07 examples/s]
Map:  77%|  | 38470/50245 [00:16<00:05, 2209.06 examples/s]
Map:  77%|  | 38721/50245 [00:16<00:05, 2285.07 examples/s]
Map:  78%|  | 38974/50245 [00:16<00:04, 2348.77 examples/s]
Map:  78%|  | 39283/50245 [00:17<00:04, 2241.11 examples/s]
Map:  79%|  | 39512/50245 [00:17<00:04, 2252.63 examples/s]
Map:  79%|  | 39744/50245 [00:17<00:04, 2269.40 examples/s]
Map:  80%|  | 39979/50245 [00:17<00:04, 2290.13 examples/s]
Map:  80%|  | 40287/50245 [00:17<00:04, 2197.96 examples/s]
Map:  81%|  | 40544/50245 [00:17<00:04, 2294.54 examples/s]
Map:  81%|  | 40783/50245 [00:17<00:04, 2316.58 examples/s]
Map:  82%| | 41117/50245 [00:17<00:04, 2172.00 examples/s]
Map:  83%| | 41458/50245 [00:18<00:03, 2199.91 examples/s]
Map:  83%| | 41698/50245 [00:18<00:03, 2247.58 examples/s]
Map:  84%| | 42000/50245 [00:18<00:03, 2118.49 examples/s]
Map:  84%| | 42242/50245 [00:18<00:03, 2189.12 examples/s]
Map:  85%| | 42484/50245 [00:18<00:03, 2245.09 examples/s]
Map:  85%| | 42728/50245 [00:18<00:03, 2293.90 examples/s]
Map:  86%| | 42962/50245 [00:18<00:03, 2303.48 examples/s]
Map:  86%| | 43269/50245 [00:18<00:03, 2200.85 examples/s]
Map:  87%| | 43506/50245 [00:18<00:03, 2242.41 examples/s]
Map:  87%| | 43762/50245 [00:19<00:02, 2326.51 examples/s]
Map:  88%| | 44062/50245 [00:19<00:02, 2199.09 examples/s]
Map:  88%| | 44405/50245 [00:19<00:02, 2224.80 examples/s]
Map:  89%| | 44644/50245 [00:19<00:02, 2263.08 examples/s]
Map:  89%| | 44881/50245 [00:19<00:02, 2288.23 examples/s]
Map:  90%| | 45115/50245 [00:19<00:02, 2179.29 examples/s]
Map:  90%| | 45345/50245 [00:19<00:02, 2209.31 examples/s]
Map:  91%| | 45585/50245 [00:19<00:02, 2260.08 examples/s]
Map:  91%| | 45833/50245 [00:19<00:01, 2319.19 examples/s]
Map:  92%|| 46143/50245 [00:20<00:01, 2220.50 examples/s]
Map:  92%|| 46376/50245 [00:20<00:01, 2248.03 examples/s]
Map:  93%|| 46642/50245 [00:20<00:01, 2358.99 examples/s]
Map:  93%|| 46889/50245 [00:20<00:01, 2388.70 examples/s]
Map:  94%|| 47246/50245 [00:20<00:01, 2286.69 examples/s]
Map:  95%|| 47596/50245 [00:20<00:01, 2301.81 examples/s]
Map:  95%|| 47927/50245 [00:21<00:01, 1788.80 examples/s]
Map:  96%|| 48256/50245 [00:21<00:01, 1881.92 examples/s]
Map:  97%|| 48517/50245 [00:21<00:00, 2028.58 examples/s]
Map:  97%|| 48762/50245 [00:21<00:00, 2122.39 examples/s]
Map:  98%|| 49000/50245 [00:21<00:00, 2088.24 examples/s]
Map:  98%|| 49238/50245 [00:21<00:00, 2158.05 examples/s]
Map:  98%|| 49472/50245 [00:21<00:00, 2203.47 examples/s]
Map:  99%|| 49719/50245 [00:21<00:00, 2273.86 examples/s]
Map:  99%|| 49958/50245 [00:21<00:00, 2302.80 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2135.90 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2277.18 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [5] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14fe3f8104d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14fe3f7da434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14fe6ad798c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14fe6ad7a572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14fe6ad7a5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14fe6ad39ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14fe6ad39ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14fe6ad39ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14fe4079fc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14fe407a3901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14fe407aaa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14fe407abe31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14fe407aeaed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14fe407bda41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14fe6ad2e2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14fe6ad3202a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14fe6ad40e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14fe7f3befee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14fe7ec0a285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14feb8878cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 5 STDERR----------
Global rank 6 (PID 196576) exited with code 1
----------Begin global rank 6 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 6 STDOUT----------
----------Begin global rank 6 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 239/50245 [00:00<00:21, 2369.74 examples/s]
Map:   1%|          | 495/50245 [00:00<00:20, 2471.86 examples/s]
Map:   1%|         | 752/50245 [00:00<00:19, 2511.97 examples/s]
Map:   2%|         | 1119/50245 [00:00<00:21, 2274.62 examples/s]
Map:   3%|         | 1466/50245 [00:00<00:21, 2287.47 examples/s]
Map:   3%|         | 1702/50245 [00:00<00:21, 2304.00 examples/s]
Map:   4%|         | 1943/50245 [00:00<00:20, 2329.45 examples/s]
Map:   5%|         | 2266/50245 [00:00<00:21, 2260.38 examples/s]
Map:   5%|         | 2501/50245 [00:01<00:20, 2281.05 examples/s]
Map:   5%|         | 2742/50245 [00:01<00:20, 2310.99 examples/s]
Map:   6%|         | 3040/50245 [00:01<00:21, 2187.65 examples/s]
Map:   7%|         | 3271/50245 [00:01<00:21, 2217.32 examples/s]
Map:   7%|         | 3521/50245 [00:01<00:20, 2291.90 examples/s]
Map:   8%|         | 3866/50245 [00:01<00:20, 2289.78 examples/s]
Map:   8%|         | 4170/50245 [00:01<00:20, 2194.73 examples/s]
Map:   9%|         | 4405/50245 [00:01<00:20, 2230.81 examples/s]
Map:   9%|         | 4653/50245 [00:02<00:19, 2292.29 examples/s]
Map:  10%|         | 4988/50245 [00:02<00:19, 2266.37 examples/s]
Map:  11%|         | 5305/50245 [00:02<00:20, 2212.42 examples/s]
Map:  11%|         | 5560/50245 [00:02<00:19, 2291.81 examples/s]
Map:  12%|        | 5800/50245 [00:02<00:19, 2318.48 examples/s]
Map:  12%|        | 6126/50245 [00:02<00:19, 2253.46 examples/s]
Map:  13%|        | 6368/50245 [00:02<00:19, 2293.99 examples/s]
Map:  13%|        | 6620/50245 [00:02<00:18, 2351.12 examples/s]
Map:  14%|        | 6873/50245 [00:02<00:18, 2399.24 examples/s]
Map:  14%|        | 7116/50245 [00:03<00:19, 2253.56 examples/s]
Map:  15%|        | 7356/50245 [00:03<00:18, 2291.67 examples/s]
Map:  15%|        | 7594/50245 [00:03<00:18, 2313.69 examples/s]
Map:  16%|        | 7844/50245 [00:03<00:17, 2366.59 examples/s]
Map:  16%|        | 8168/50245 [00:03<00:18, 2284.88 examples/s]
Map:  17%|        | 8402/50245 [00:03<00:18, 2297.03 examples/s]
Map:  17%|        | 8651/50245 [00:03<00:17, 2346.88 examples/s]
Map:  18%|        | 8901/50245 [00:03<00:17, 2386.88 examples/s]
Map:  18%|        | 9243/50245 [00:04<00:17, 2287.21 examples/s]
Map:  19%|        | 9501/50245 [00:04<00:17, 2361.68 examples/s]
Map:  20%|        | 9854/50245 [00:04<00:17, 2353.24 examples/s]
Map:  20%|        | 10166/50245 [00:04<00:17, 2255.80 examples/s]
Map:  21%|        | 10395/50245 [00:04<00:17, 2261.71 examples/s]
Map:  21%|        | 10639/50245 [00:04<00:17, 2302.82 examples/s]
Map:  22%|       | 10896/50245 [00:04<00:16, 2368.61 examples/s]
Map:  22%|       | 11242/50245 [00:04<00:17, 2265.67 examples/s]
Map:  23%|       | 11483/50245 [00:04<00:16, 2300.05 examples/s]
Map:  23%|       | 11739/50245 [00:05<00:16, 2365.55 examples/s]
Map:  24%|       | 11982/50245 [00:05<00:16, 2381.57 examples/s]
Map:  24%|       | 12299/50245 [00:05<00:16, 2280.31 examples/s]
Map:  25%|       | 12531/50245 [00:05<00:16, 2285.67 examples/s]
Map:  25%|       | 12801/50245 [00:05<00:15, 2394.54 examples/s]
Map:  26%|       | 13126/50245 [00:05<00:16, 2304.84 examples/s]
Map:  27%|       | 13386/50245 [00:05<00:15, 2377.25 examples/s]
Map:  27%|       | 13737/50245 [00:05<00:15, 2361.00 examples/s]
Map:  28%|       | 13979/50245 [00:06<00:15, 2373.67 examples/s]
Map:  28%|       | 14288/50245 [00:06<00:15, 2255.38 examples/s]
Map:  29%|       | 14525/50245 [00:06<00:15, 2280.09 examples/s]
Map:  29%|       | 14776/50245 [00:06<00:15, 2337.38 examples/s]
Map:  30%|       | 15123/50245 [00:06<00:15, 2289.32 examples/s]
Map:  31%|       | 15364/50245 [00:06<00:15, 2317.94 examples/s]
Map:  31%|      | 15716/50245 [00:06<00:14, 2324.56 examples/s]
Map:  32%|      | 15962/50245 [00:06<00:14, 2355.61 examples/s]
Map:  32%|      | 16263/50245 [00:07<00:15, 2232.65 examples/s]
Map:  33%|      | 16519/50245 [00:07<00:14, 2311.13 examples/s]
Map:  33%|      | 16775/50245 [00:07<00:14, 2375.55 examples/s]
Map:  34%|      | 17125/50245 [00:07<00:14, 2289.74 examples/s]
Map:  35%|      | 17364/50245 [00:07<00:14, 2311.65 examples/s]
Map:  35%|      | 17614/50245 [00:07<00:13, 2359.67 examples/s]
Map:  36%|      | 17864/50245 [00:07<00:13, 2395.47 examples/s]
Map:  36%|      | 18183/50245 [00:07<00:13, 2290.94 examples/s]
Map:  37%|      | 18424/50245 [00:07<00:13, 2316.57 examples/s]
Map:  37%|      | 18669/50245 [00:08<00:13, 2348.18 examples/s]
Map:  38%|      | 18915/50245 [00:08<00:13, 2376.46 examples/s]
Map:  38%|      | 19255/50245 [00:08<00:13, 2277.09 examples/s]
Map:  39%|      | 19501/50245 [00:08<00:13, 2321.36 examples/s]
Map:  39%|      | 19742/50245 [00:08<00:13, 2342.17 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2270.88 examples/s]
Map:  40%|      | 20244/50245 [00:08<00:12, 2313.98 examples/s]
Map:  41%|      | 20495/50245 [00:08<00:12, 2366.72 examples/s]
Map:  41%|     | 20740/50245 [00:08<00:12, 2388.96 examples/s]
Map:  42%|     | 21045/50245 [00:09<00:12, 2252.38 examples/s]
Map:  42%|     | 21291/50245 [00:09<00:12, 2305.71 examples/s]
Map:  43%|     | 21534/50245 [00:09<00:12, 2337.93 examples/s]
Map:  43%|     | 21787/50245 [00:09<00:11, 2387.51 examples/s]
Map:  44%|     | 22125/50245 [00:09<00:12, 2256.09 examples/s]
Map:  45%|     | 22363/50245 [00:09<00:12, 2284.29 examples/s]
Map:  45%|     | 22607/50245 [00:09<00:11, 2322.73 examples/s]
Map:  45%|     | 22858/50245 [00:09<00:11, 2371.82 examples/s]
Map:  46%|     | 23167/50245 [00:10<00:12, 2253.09 examples/s]
Map:  47%|     | 23428/50245 [00:10<00:11, 2344.80 examples/s]
Map:  47%|     | 23671/50245 [00:10<00:11, 2364.76 examples/s]
Map:  48%|     | 23914/50245 [00:10<00:11, 2380.24 examples/s]
Map:  48%|     | 24227/50245 [00:10<00:11, 2219.74 examples/s]
Map:  49%|     | 24471/50245 [00:10<00:11, 2274.95 examples/s]
Map:  49%|     | 24716/50245 [00:10<00:10, 2321.75 examples/s]
Map:  50%|     | 24977/50245 [00:10<00:10, 2398.96 examples/s]
Map:  50%|     | 25296/50245 [00:10<00:10, 2295.82 examples/s]
Map:  51%|     | 25562/50245 [00:11<00:10, 2388.29 examples/s]
Map:  52%|    | 25916/50245 [00:11<00:10, 2374.95 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2257.56 examples/s]
Map:  53%|    | 26482/50245 [00:11<00:10, 2295.49 examples/s]
Map:  53%|    | 26737/50245 [00:11<00:09, 2354.31 examples/s]
Map:  54%|    | 26985/50245 [00:11<00:09, 2384.58 examples/s]
Map:  54%|    | 27301/50245 [00:11<00:10, 2278.14 examples/s]
Map:  55%|    | 27559/50245 [00:11<00:09, 2351.90 examples/s]
Map:  56%|    | 27929/50245 [00:12<00:09, 2391.27 examples/s]
Map:  56%|    | 28231/50245 [00:12<00:09, 2241.47 examples/s]
Map:  57%|    | 28486/50245 [00:12<00:09, 2313.45 examples/s]
Map:  57%|    | 28727/50245 [00:12<00:09, 2332.93 examples/s]
Map:  58%|    | 28977/50245 [00:12<00:08, 2374.02 examples/s]
Map:  58%|    | 29292/50245 [00:12<00:09, 2272.59 examples/s]
Map:  59%|    | 29525/50245 [00:12<00:09, 2284.60 examples/s]
Map:  59%|    | 29767/50245 [00:12<00:08, 2319.19 examples/s]
Map:  60%|    | 30120/50245 [00:13<00:09, 2211.52 examples/s]
Map:  60%|    | 30367/50245 [00:13<00:08, 2274.65 examples/s]
Map:  61%|    | 30617/50245 [00:13<00:08, 2330.32 examples/s]
Map:  61%|   | 30858/50245 [00:13<00:08, 2346.03 examples/s]
Map:  62%|   | 31170/50245 [00:13<00:08, 2243.71 examples/s]
Map:  63%|   | 31410/50245 [00:13<00:08, 2281.27 examples/s]
Map:  63%|   | 31661/50245 [00:13<00:07, 2340.02 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2223.40 examples/s]
Map:  64%|   | 32234/50245 [00:13<00:08, 2249.37 examples/s]
Map:  65%|   | 32475/50245 [00:14<00:07, 2289.52 examples/s]
Map:  65%|   | 32724/50245 [00:14<00:07, 2342.24 examples/s]
Map:  66%|   | 32971/50245 [00:14<00:07, 2376.30 examples/s]
Map:  66%|   | 33292/50245 [00:14<00:07, 2285.21 examples/s]
Map:  67%|   | 33538/50245 [00:14<00:07, 2327.98 examples/s]
Map:  67%|   | 33896/50245 [00:14<00:06, 2346.77 examples/s]
Map:  68%|   | 34251/50245 [00:14<00:07, 2255.89 examples/s]
Map:  69%|   | 34499/50245 [00:14<00:06, 2306.80 examples/s]
Map:  69%|   | 34737/50245 [00:15<00:06, 2322.71 examples/s]
Map:  70%|   | 34996/50245 [00:15<00:06, 2390.85 examples/s]
Map:  70%|   | 35300/50245 [00:15<00:06, 2256.04 examples/s]
Map:  71%|   | 35531/50245 [00:15<00:06, 2266.27 examples/s]
Map:  71%|  | 35882/50245 [00:15<00:06, 2287.63 examples/s]
Map:  72%|  | 36125/50245 [00:15<00:06, 2212.25 examples/s]
Map:  72%|  | 36365/50245 [00:15<00:06, 2259.68 examples/s]
Map:  73%|  | 36603/50245 [00:15<00:05, 2289.48 examples/s]
Map:  73%|  | 36848/50245 [00:15<00:05, 2330.92 examples/s]
Map:  74%|  | 37135/50245 [00:16<00:06, 2170.67 examples/s]
Map:  75%|  | 37480/50245 [00:16<00:05, 2211.87 examples/s]
Map:  75%|  | 37821/50245 [00:16<00:05, 2230.03 examples/s]
Map:  76%|  | 38117/50245 [00:16<00:05, 2144.59 examples/s]
Map:  76%|  | 38348/50245 [00:16<00:05, 2180.85 examples/s]
Map:  77%|  | 38602/50245 [00:16<00:05, 2267.99 examples/s]
Map:  77%|  | 38851/50245 [00:16<00:04, 2324.81 examples/s]
Map:  78%|  | 39163/50245 [00:17<00:04, 2233.20 examples/s]
Map:  78%|  | 39410/50245 [00:17<00:04, 2291.65 examples/s]
Map:  79%|  | 39751/50245 [00:17<00:04, 2280.75 examples/s]
Map:  80%|  | 39990/50245 [00:17<00:04, 2305.35 examples/s]
Map:  80%|  | 40300/50245 [00:17<00:04, 2218.69 examples/s]
Map:  81%|  | 40554/50245 [00:17<00:04, 2292.51 examples/s]
Map:  81%|  | 40799/50245 [00:17<00:04, 2332.07 examples/s]
Map:  82%| | 41128/50245 [00:17<00:04, 2221.76 examples/s]
Map:  83%| | 41470/50245 [00:18<00:03, 2239.51 examples/s]
Map:  83%| | 41714/50245 [00:18<00:03, 2284.44 examples/s]
Map:  84%| | 42000/50245 [00:18<00:03, 2145.87 examples/s]
Map:  84%| | 42243/50245 [00:18<00:03, 2213.20 examples/s]
Map:  85%| | 42485/50245 [00:18<00:03, 2260.90 examples/s]
Map:  85%| | 42732/50245 [00:18<00:03, 2314.11 examples/s]
Map:  86%| | 42967/50245 [00:18<00:03, 2320.33 examples/s]
Map:  86%| | 43272/50245 [00:18<00:03, 2211.58 examples/s]
Map:  87%| | 43519/50245 [00:18<00:02, 2277.04 examples/s]
Map:  87%| | 43773/50245 [00:19<00:02, 2346.90 examples/s]
Map:  88%| | 44115/50245 [00:19<00:02, 2208.64 examples/s]
Map:  88%| | 44449/50245 [00:19<00:02, 2209.15 examples/s]
Map:  89%| | 44699/50245 [00:19<00:02, 2274.30 examples/s]
Map:  89%| | 44934/50245 [00:19<00:02, 2288.20 examples/s]
Map:  90%| | 45236/50245 [00:19<00:02, 2183.24 examples/s]
Map:  90%| | 45469/50245 [00:19<00:02, 2217.79 examples/s]
Map:  91%| | 45706/50245 [00:19<00:02, 2253.99 examples/s]
Map:  91%|| 45956/50245 [00:20<00:01, 2319.28 examples/s]
Map:  92%|| 46258/50245 [00:20<00:01, 2203.86 examples/s]
Map:  93%|| 46507/50245 [00:20<00:01, 2275.10 examples/s]
Map:  93%|| 46739/50245 [00:20<00:01, 2285.19 examples/s]
Map:  94%|| 46985/50245 [00:20<00:01, 2331.68 examples/s]
Map:  94%|| 47276/50245 [00:20<00:01, 2181.55 examples/s]
Map:  95%|| 47611/50245 [00:20<00:01, 2197.14 examples/s]
Map:  95%|| 47918/50245 [00:21<00:01, 1701.88 examples/s]
Map:  96%|| 48118/50245 [00:21<00:01, 1724.73 examples/s]
Map:  96%|| 48367/50245 [00:21<00:00, 1890.42 examples/s]
Map:  97%|| 48604/50245 [00:21<00:00, 2002.89 examples/s]
Map:  97%|| 48839/50245 [00:21<00:00, 2088.04 examples/s]
Map:  98%|| 49144/50245 [00:21<00:00, 2064.26 examples/s]
Map:  98%|| 49365/50245 [00:21<00:00, 2098.86 examples/s]
Map:  99%|| 49594/50245 [00:21<00:00, 2146.04 examples/s]
Map:  99%|| 49838/50245 [00:21<00:00, 2222.83 examples/s]
Map: 100%|| 50126/50245 [00:22<00:00, 2108.75 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2268.18 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [6] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14ec14b504d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14ec14b1a434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14ec400b98c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14ec400ba572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14ec400ba5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ec40079ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ec40079ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ec40079ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14ec15adfc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14ec15ae3901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14ec15aeaa2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14ec15aebe31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14ec15aeeaed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14ec15afda41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14ec4006e2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14ec4007202a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14ec40080e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14ec546fefee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14ec53f4a285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14ec8dbb8cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 6 STDERR----------
Global rank 7 (PID 196577) exited with code 1
----------Begin global rank 7 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 7 STDOUT----------
----------Begin global rank 7 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Downloading data files:   0%|          | 0/1 [00:00<?, ?it/s]
Downloading data files: 100%|| 1/1 [00:00<00:00, 9709.04it/s]

Extracting data files:   0%|          | 0/1 [00:00<?, ?it/s]
Extracting data files: 100%|| 1/1 [00:00<00:00,  9.20it/s]
Extracting data files: 100%|| 1/1 [00:00<00:00,  9.19it/s]

Generating train split: 0 examples [00:00, ? examples/s]
Generating train split: 22612 examples [00:00, 73700.42 examples/s]
Generating train split: 50245 examples [00:00, 149832.14 examples/s]

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 142/50245 [00:00<00:35, 1399.41 examples/s]
Map:   1%|          | 392/50245 [00:00<00:24, 2034.68 examples/s]
Map:   1%|         | 659/50245 [00:00<00:21, 2315.72 examples/s]
Map:   2%|         | 912/50245 [00:00<00:20, 2395.21 examples/s]
Map:   2%|         | 1239/50245 [00:00<00:31, 1570.19 examples/s]
Map:   3%|         | 1474/50245 [00:00<00:27, 1746.60 examples/s]
Map:   3%|         | 1714/50245 [00:00<00:25, 1904.97 examples/s]
Map:   4%|         | 1965/50245 [00:01<00:23, 2061.01 examples/s]
Map:   5%|         | 2289/50245 [00:01<00:22, 2093.95 examples/s]
Map:   5%|         | 2528/50245 [00:01<00:22, 2167.50 examples/s]
Map:   6%|         | 2769/50245 [00:01<00:21, 2224.48 examples/s]
Map:   6%|         | 3116/50245 [00:01<00:21, 2161.38 examples/s]
Map:   7%|         | 3352/50245 [00:01<00:21, 2207.46 examples/s]
Map:   7%|         | 3589/50245 [00:01<00:20, 2249.12 examples/s]
Map:   8%|         | 3819/50245 [00:01<00:20, 2251.73 examples/s]
Map:   8%|         | 4117/50245 [00:01<00:21, 2145.21 examples/s]
Map:   9%|         | 4347/50245 [00:02<00:21, 2182.34 examples/s]
Map:   9%|         | 4592/50245 [00:02<00:20, 2250.85 examples/s]
Map:  10%|         | 4932/50245 [00:02<00:20, 2250.60 examples/s]
Map:  10%|         | 5249/50245 [00:02<00:20, 2190.11 examples/s]
Map:  11%|         | 5497/50245 [00:02<00:19, 2260.76 examples/s]
Map:  11%|        | 5743/50245 [00:02<00:19, 2310.72 examples/s]
Map:  12%|        | 5990/50245 [00:02<00:18, 2351.49 examples/s]
Map:  13%|        | 6316/50245 [00:02<00:19, 2282.87 examples/s]
Map:  13%|        | 6563/50245 [00:03<00:18, 2327.26 examples/s]
Map:  14%|        | 6813/50245 [00:03<00:18, 2368.89 examples/s]
Map:  14%|        | 7141/50245 [00:03<00:18, 2299.94 examples/s]
Map:  15%|        | 7391/50245 [00:03<00:18, 2348.91 examples/s]
Map:  15%|        | 7638/50245 [00:03<00:17, 2377.84 examples/s]
Map:  16%|        | 7882/50245 [00:03<00:17, 2393.57 examples/s]
Map:  16%|        | 8128/50245 [00:03<00:18, 2294.65 examples/s]
Map:  17%|        | 8371/50245 [00:03<00:17, 2329.87 examples/s]
Map:  17%|        | 8622/50245 [00:03<00:17, 2379.77 examples/s]
Map:  18%|        | 8875/50245 [00:04<00:17, 2422.42 examples/s]
Map:  18%|        | 9245/50245 [00:04<00:17, 2322.21 examples/s]
Map:  19%|        | 9508/50245 [00:04<00:16, 2401.30 examples/s]
Map:  20%|        | 9866/50245 [00:04<00:16, 2390.64 examples/s]
Map:  20%|        | 10184/50245 [00:04<00:17, 2294.78 examples/s]
Map:  21%|        | 10532/50245 [00:04<00:17, 2299.12 examples/s]
Map:  21%|       | 10793/50245 [00:04<00:16, 2370.83 examples/s]
Map:  22%|       | 11128/50245 [00:04<00:17, 2293.98 examples/s]
Map:  23%|       | 11370/50245 [00:05<00:16, 2321.22 examples/s]
Map:  23%|       | 11613/50245 [00:05<00:16, 2347.13 examples/s]
Map:  24%|       | 11869/50245 [00:05<00:16, 2398.39 examples/s]
Map:  24%|       | 12192/50245 [00:05<00:16, 2305.20 examples/s]
Map:  25%|       | 12435/50245 [00:05<00:16, 2334.62 examples/s]
Map:  25%|       | 12689/50245 [00:05<00:15, 2387.72 examples/s]
Map:  26%|       | 12957/50245 [00:05<00:15, 2466.15 examples/s]
Map:  26%|       | 13286/50245 [00:05<00:15, 2360.89 examples/s]
ERROR:composer.cli.launcher:Global rank 4 (PID 196574) exited with code 143
Map:  27%|       | 13649/50245 [00:06<00:15, 2378.52 examples/s]
Map:  28%|       | 13890/50245 [00:06<00:15, 2383.60 examples/s]
Map:  28%|       | 14236/50245 [00:06<00:15, 2285.38 examples/s]
Map:  29%|       | 14477/50245 [00:06<00:15, 2311.35 examples/s]
Map:  29%|       | 14728/50245 [00:06<00:15, 2359.34 examples/s]
Map:  30%|       | 14992/50245 [00:06<00:14, 2431.30 examples/s]
Map:  30%|       | 15310/50245 [00:06<00:15, 2313.66 examples/s]
Map:  31%|       | 15666/50245 [00:06<00:14, 2330.88 examples/s]
Map:  32%|      | 15915/50245 [00:07<00:14, 2366.29 examples/s]
Map:  32%|      | 16245/50245 [00:07<00:14, 2269.47 examples/s]
Map:  33%|      | 16509/50245 [00:07<00:14, 2358.30 examples/s]
Map:  33%|      | 16771/50245 [00:07<00:13, 2423.13 examples/s]
Map:  34%|      | 17126/50245 [00:07<00:14, 2323.82 examples/s]
Map:  35%|      | 17368/50245 [00:07<00:14, 2344.01 examples/s]
Map:  35%|      | 17622/50245 [00:07<00:13, 2393.40 examples/s]
Map:  36%|      | 17876/50245 [00:07<00:13, 2428.94 examples/s]
Map:  36%|      | 18199/50245 [00:07<00:13, 2323.59 examples/s]
Map:  37%|      | 18445/50245 [00:08<00:13, 2355.58 examples/s]
Map:  37%|      | 18690/50245 [00:08<00:13, 2380.36 examples/s]
Map:  38%|      | 18944/50245 [00:08<00:12, 2422.09 examples/s]
Map:  38%|      | 19267/50245 [00:08<00:13, 2317.61 examples/s]
Map:  39%|      | 19514/50245 [00:08<00:13, 2353.78 examples/s]
Map:  39%|      | 19759/50245 [00:08<00:12, 2378.29 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2298.03 examples/s]
Map:  40%|      | 20245/50245 [00:08<00:12, 2335.49 examples/s]
Map:  41%|      | 20502/50245 [00:08<00:12, 2396.68 examples/s]
Map:  41%|     | 20748/50245 [00:09<00:12, 2411.26 examples/s]
Map:  42%|     | 21061/50245 [00:09<00:12, 2284.33 examples/s]
Map:  42%|     | 21312/50245 [00:09<00:12, 2340.93 examples/s]
Map:  43%|     | 21562/50245 [00:09<00:12, 2380.07 examples/s]
Map:  43%|     | 21813/50245 [00:09<00:11, 2412.24 examples/s]
Map:  44%|     | 22123/50245 [00:09<00:12, 2276.67 examples/s]
Map:  45%|     | 22365/50245 [00:09<00:12, 2309.25 examples/s]
Map:  45%|     | 22613/50245 [00:09<00:11, 2353.64 examples/s]
Map:  46%|     | 22868/50245 [00:09<00:11, 2406.64 examples/s]
Map:  46%|     | 23181/50245 [00:10<00:11, 2281.03 examples/s]
Map:  47%|     | 23440/50245 [00:10<00:11, 2359.79 examples/s]
Map:  47%|     | 23687/50245 [00:10<00:11, 2386.55 examples/s]
Map:  48%|     | 23932/50245 [00:10<00:10, 2402.10 examples/s]
Map:  48%|     | 24233/50245 [00:10<00:11, 2251.20 examples/s]
Map:  49%|     | 24477/50245 [00:10<00:11, 2296.98 examples/s]
Map:  49%|     | 24723/50245 [00:10<00:10, 2340.80 examples/s]
Map:  50%|     | 24987/50245 [00:10<00:10, 2423.49 examples/s]
Map:  50%|     | 25310/50245 [00:11<00:10, 2318.82 examples/s]
Map:  51%|     | 25580/50245 [00:11<00:10, 2417.25 examples/s]
Map:  52%|    | 25930/50245 [00:11<00:10, 2381.42 examples/s]
Map:  52%|    | 26241/50245 [00:11<00:10, 2275.29 examples/s]
Map:  53%|    | 26486/50245 [00:11<00:10, 2313.88 examples/s]
Map:  53%|    | 26743/50245 [00:11<00:09, 2378.12 examples/s]
Map:  54%|    | 26988/50245 [00:11<00:09, 2394.56 examples/s]
Map:  54%|    | 27316/50245 [00:11<00:09, 2313.71 examples/s]
Map:  55%|    | 27578/50245 [00:11<00:09, 2389.86 examples/s]
Map:  56%|    | 27951/50245 [00:12<00:09, 2419.92 examples/s]
Map:  56%|    | 28248/50245 [00:12<00:09, 2268.79 examples/s]
Map:  57%|    | 28504/50245 [00:12<00:09, 2337.74 examples/s]
Map:  57%|    | 28748/50245 [00:12<00:09, 2362.28 examples/s]
Map:  58%|    | 28993/50245 [00:12<00:08, 2381.11 examples/s]
Map:  58%|    | 29326/50245 [00:12<00:09, 2317.96 examples/s]
Map:  59%|    | 29561/50245 [00:12<00:08, 2324.82 examples/s]
Map:  59%|    | 29801/50245 [00:12<00:08, 2342.19 examples/s]
Map:  60%|    | 30122/50245 [00:13<00:08, 2240.23 examples/s]
Map:  60%|    | 30374/50245 [00:13<00:08, 2310.28 examples/s]
Map:  61%|    | 30631/50245 [00:13<00:08, 2376.46 examples/s]
Map:  61%|   | 30872/50245 [00:13<00:08, 2383.56 examples/s]
Map:  62%|   | 31127/50245 [00:13<00:08, 2288.63 examples/s]
Map:  62%|   | 31376/50245 [00:13<00:08, 2340.95 examples/s]
Map:  63%|   | 31628/50245 [00:13<00:07, 2391.27 examples/s]
Map:  63%|   | 31875/50245 [00:13<00:07, 2411.91 examples/s]
Map:  64%|   | 32188/50245 [00:13<00:07, 2285.33 examples/s]
Map:  65%|   | 32430/50245 [00:14<00:07, 2319.79 examples/s]
Map:  65%|   | 32694/50245 [00:14<00:07, 2404.63 examples/s]
Map:  66%|   | 32954/50245 [00:14<00:07, 2457.00 examples/s]
Map:  66%|   | 33282/50245 [00:14<00:07, 2353.49 examples/s]
Map:  67%|   | 33532/50245 [00:14<00:06, 2390.88 examples/s]
Map:  67%|   | 33898/50245 [00:14<00:06, 2404.92 examples/s]
Map:  68%|   | 34264/50245 [00:14<00:06, 2340.61 examples/s]
Map:  69%|   | 34523/50245 [00:14<00:06, 2397.10 examples/s]
Map:  69%|   | 34768/50245 [00:15<00:06, 2407.74 examples/s]
Map:  70%|   | 35124/50245 [00:15<00:06, 2356.09 examples/s]
Map:  70%|   | 35369/50245 [00:15<00:06, 2377.27 examples/s]
Map:  71%|   | 35622/50245 [00:15<00:06, 2413.58 examples/s]
Map:  72%|  | 35988/50245 [00:15<00:05, 2421.39 examples/s]
Map:  72%|  | 36311/50245 [00:15<00:05, 2326.88 examples/s]
Map:  73%|  | 36568/50245 [00:15<00:05, 2382.29 examples/s]
Map:  73%|  | 36823/50245 [00:15<00:05, 2423.01 examples/s]
Map:  74%|  | 37130/50245 [00:16<00:05, 2285.77 examples/s]
Map:  75%|  | 37488/50245 [00:16<00:05, 2315.94 examples/s]
Map:  75%|  | 37731/50245 [00:16<00:05, 2339.90 examples/s]
Map:  76%|  | 37985/50245 [00:16<00:05, 2379.16 examples/s]
Map:  76%|  | 38296/50245 [00:16<00:05, 2265.20 examples/s]
Map:  77%|  | 38552/50245 [00:16<00:04, 2338.63 examples/s]
Map:  77%|  | 38805/50245 [00:16<00:04, 2387.31 examples/s]
Map:  78%|  | 39139/50245 [00:16<00:04, 2324.91 examples/s]
Map:  78%|  | 39390/50245 [00:16<00:04, 2371.17 examples/s]
Map:  79%|  | 39758/50245 [00:17<00:04, 2397.39 examples/s]
Map:  80%|  | 40000/50245 [00:17<00:04, 2276.18 examples/s]
Map:  80%|  | 40255/50245 [00:17<00:04, 2342.95 examples/s]
Map:  81%|  | 40528/50245 [00:17<00:03, 2440.21 examples/s]
Map:  81%|  | 40777/50245 [00:17<00:03, 2449.64 examples/s]
Map:  82%| | 41131/50245 [00:17<00:03, 2335.36 examples/s]
Map:  83%| | 41496/50245 [00:17<00:03, 2365.36 examples/s]
Map:  83%| | 41745/50245 [00:17<00:03, 2393.46 examples/s]
Map:  84%| | 42044/50245 [00:18<00:03, 2252.47 examples/s]
Map:  84%| | 42300/50245 [00:18<00:03, 2325.96 examples/s]
Map:  85%| | 42557/50245 [00:18<00:03, 2385.23 examples/s]
Map:  85%| | 42807/50245 [00:18<00:03, 2414.75 examples/s]
Map:  86%| | 43119/50245 [00:18<00:03, 2265.31 examples/s]
Map:  86%| | 43386/50245 [00:18<00:02, 2366.53 examples/s]
Map:  87%| | 43646/50245 [00:18<00:02, 2424.30 examples/s]
Map:  88%| | 44000/50245 [00:18<00:02, 2329.06 examples/s]
Map:  88%| | 44238/50245 [00:19<00:02, 2338.88 examples/s]
Map:  89%| | 44477/50245 [00:19<00:02, 2348.91 examples/s]
Map:  89%| | 44734/50245 [00:19<00:02, 2406.02 examples/s]
Map:  90%| | 44987/50245 [00:19<00:02, 2438.07 examples/s]
Map:  90%| | 45296/50245 [00:19<00:02, 2294.62 examples/s]
Map:  91%| | 45541/50245 [00:19<00:02, 2334.47 examples/s]
Map:  91%| | 45792/50245 [00:19<00:01, 2377.87 examples/s]
Map:  92%|| 46125/50245 [00:19<00:01, 2296.69 examples/s]
Map:  92%|| 46370/50245 [00:19<00:01, 2329.01 examples/s]
Map:  93%|| 46636/50245 [00:20<00:01, 2417.42 examples/s]
Map:  93%|| 46891/50245 [00:20<00:01, 2451.63 examples/s]
Map:  94%|| 47250/50245 [00:20<00:01, 2356.39 examples/s]
Map:  95%|| 47610/50245 [00:20<00:01, 2367.27 examples/s]
Map:  95%|| 47978/50245 [00:20<00:00, 2393.99 examples/s]
Map:  96%|| 48309/50245 [00:20<00:00, 2333.46 examples/s]
Map:  97%|| 48577/50245 [00:20<00:00, 2412.52 examples/s]
Map:  97%|| 48827/50245 [00:20<00:00, 2431.53 examples/s]
Map:  98%|| 49152/50245 [00:21<00:00, 2336.35 examples/s]
Map:  99%|| 49510/50245 [00:21<00:00, 2349.52 examples/s]
Map:  99%|| 49763/50245 [00:21<00:00, 2390.54 examples/s]
Map: 100%|| 50124/50245 [00:21<00:00, 2297.91 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2311.78 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:05, 9055.26 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 9319.57 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 9273.34 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9886.36 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 10224.43 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:03, 10312.54 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:03, 10363.79 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 10490.70 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 10504.31 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 10520.23 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:02, 10533.45 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:02, 10570.18 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 10555.11 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 10519.38 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 10511.85 examples/s]
Filter:  58%|    | 29000/50245 [00:02<00:02, 10515.26 examples/s]
Filter:  62%|   | 31000/50245 [00:02<00:01, 10531.64 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 10529.91 examples/s]
Filter:  70%|   | 35000/50245 [00:03<00:01, 10625.68 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 10605.46 examples/s]
Filter:  78%|  | 39000/50245 [00:03<00:01, 10581.92 examples/s]
Filter:  82%| | 41000/50245 [00:03<00:00, 10592.12 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 10576.41 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 10614.26 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 10626.81 examples/s]
Filter:  98%|| 49000/50245 [00:04<00:00, 10639.87 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10587.83 examples/s]
Filter: 100%|| 50245/50245 [00:04<00:00, 10471.82 examples/s]

Filter:   0%|          | 0/50245 [00:00<?, ? examples/s]
Filter:   2%|         | 1000/50245 [00:00<00:06, 7614.43 examples/s]
Filter:   4%|         | 2000/50245 [00:00<00:05, 8646.37 examples/s]
Filter:   6%|         | 3000/50245 [00:00<00:05, 8884.76 examples/s]
Filter:   8%|         | 4000/50245 [00:00<00:05, 9122.43 examples/s]
Filter:  10%|         | 5000/50245 [00:00<00:04, 9287.29 examples/s]
Filter:  12%|        | 6000/50245 [00:00<00:04, 9452.71 examples/s]
Filter:  14%|        | 7000/50245 [00:00<00:04, 9569.00 examples/s]
Filter:  16%|        | 8000/50245 [00:00<00:04, 9525.50 examples/s]
Filter:  18%|        | 9000/50245 [00:00<00:04, 9568.23 examples/s]
Filter:  20%|        | 10000/50245 [00:01<00:04, 9570.17 examples/s]
Filter:  22%|       | 11000/50245 [00:01<00:04, 9614.03 examples/s]
Filter:  24%|       | 12000/50245 [00:01<00:03, 9637.82 examples/s]
Filter:  26%|       | 13000/50245 [00:01<00:03, 9712.89 examples/s]
Filter:  28%|       | 14000/50245 [00:01<00:03, 9718.88 examples/s]
Filter:  30%|       | 15000/50245 [00:01<00:03, 9720.45 examples/s]
Filter:  32%|      | 16000/50245 [00:01<00:03, 9641.74 examples/s]
Filter:  34%|      | 17000/50245 [00:01<00:03, 9710.27 examples/s]
Filter:  36%|      | 18000/50245 [00:01<00:03, 9677.91 examples/s]
Filter:  38%|      | 19000/50245 [00:01<00:03, 9714.89 examples/s]
Filter:  40%|      | 20000/50245 [00:02<00:03, 9744.26 examples/s]
Filter:  42%|     | 21000/50245 [00:02<00:02, 9750.25 examples/s]
Filter:  44%|     | 22000/50245 [00:02<00:02, 9705.25 examples/s]
Filter:  46%|     | 23000/50245 [00:02<00:02, 9675.26 examples/s]
Filter:  48%|     | 24000/50245 [00:02<00:02, 9625.94 examples/s]
Filter:  50%|     | 25000/50245 [00:02<00:02, 9574.45 examples/s]
Filter:  52%|    | 26000/50245 [00:02<00:02, 9633.51 examples/s]
Filter:  54%|    | 27000/50245 [00:02<00:02, 9591.53 examples/s]
Filter:  56%|    | 28000/50245 [00:02<00:02, 9645.12 examples/s]
Filter:  58%|    | 29000/50245 [00:03<00:02, 9616.98 examples/s]
Filter:  60%|    | 30000/50245 [00:03<00:02, 9605.07 examples/s]
Filter:  62%|   | 31000/50245 [00:03<00:01, 9666.84 examples/s]
Filter:  64%|   | 32000/50245 [00:03<00:01, 9662.08 examples/s]
Filter:  66%|   | 33000/50245 [00:03<00:01, 9686.77 examples/s]
Filter:  68%|   | 34000/50245 [00:03<00:01, 9698.84 examples/s]
Filter:  72%|  | 36000/50245 [00:03<00:01, 9760.92 examples/s]
Filter:  74%|  | 37000/50245 [00:03<00:01, 9749.08 examples/s]
Filter:  76%|  | 38000/50245 [00:03<00:01, 9664.70 examples/s]
Filter:  78%|  | 39000/50245 [00:04<00:01, 9723.83 examples/s]
Filter:  80%|  | 40000/50245 [00:04<00:01, 9704.49 examples/s]
Filter:  82%| | 41000/50245 [00:04<00:00, 9746.44 examples/s]
Filter:  84%| | 42000/50245 [00:04<00:00, 9652.53 examples/s]
Filter:  86%| | 43000/50245 [00:04<00:00, 9722.34 examples/s]
Filter:  88%| | 44000/50245 [00:04<00:00, 9769.69 examples/s]
Filter:  90%| | 45000/50245 [00:04<00:00, 9738.05 examples/s]
Filter:  92%|| 46000/50245 [00:04<00:00, 9702.32 examples/s]
Filter:  94%|| 47000/50245 [00:04<00:00, 9743.17 examples/s]
Filter:  96%|| 48000/50245 [00:04<00:00, 9667.57 examples/s]
Filter:  98%|| 49000/50245 [00:05<00:00, 9752.79 examples/s]
Filter: 100%|| 50000/50245 [00:05<00:00, 9699.46 examples/s]
Filter: 100%|| 50245/50245 [00:05<00:00, 9608.38 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [7] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x15077e62e4d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x15077e5f8434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x1507a9b978c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x1507a9b98572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x1507a9b985f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1507a9b57ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1507a9b57ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x1507a9b57ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x15077f5bdc4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x15077f5c1901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x15077f5c8a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x15077f5c9e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x15077f5ccaed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x15077f5dba41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x1507a9b4c2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x1507a9b5002a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x1507a9b5ee90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x1507be1dcfee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x1507bda28285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x1507f7696cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 7 STDERR----------
srun: error: lrdn0170: task 0: Exited with exit code 143
srun: error: lrdn0240: task 6: Exited with exit code 143
srun: error: lrdn0235: task 5: Exited with exit code 143
srun: error: lrdn0190: task 1: Exited with exit code 143
srun: error: lrdn0208: task 3: Exited with exit code 143
srun: error: lrdn0248: task 7: Exited with exit code 143
Global rank 8 (PID 186649) exited with code 143
Global rank 9 (PID 186650) exited with code 1
----------Begin global rank 9 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 9 STDOUT----------
----------Begin global rank 9 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 165/50245 [00:00<00:30, 1627.50 examples/s]
Map:   1%|          | 415/50245 [00:00<00:23, 2132.57 examples/s]
Map:   1%|         | 676/50245 [00:00<00:21, 2347.58 examples/s]
Map:   2%|         | 927/50245 [00:00<00:20, 2409.11 examples/s]
Map:   2%|         | 1239/50245 [00:00<00:24, 1970.67 examples/s]
Map:   3%|         | 1474/50245 [00:00<00:23, 2072.44 examples/s]
Map:   3%|         | 1714/50245 [00:00<00:22, 2160.44 examples/s]
Map:   4%|         | 1957/50245 [00:00<00:21, 2237.43 examples/s]
Map:   5%|         | 2277/50245 [00:01<00:21, 2194.46 examples/s]
Map:   5%|         | 2514/50245 [00:01<00:21, 2239.55 examples/s]
Map:   5%|         | 2756/50245 [00:01<00:20, 2288.70 examples/s]
Map:   6%|         | 2992/50245 [00:01<00:20, 2305.54 examples/s]
Map:   7%|         | 3292/50245 [00:01<00:21, 2185.59 examples/s]
Map:   7%|         | 3547/50245 [00:01<00:20, 2278.71 examples/s]
Map:   8%|         | 3892/50245 [00:01<00:20, 2282.85 examples/s]
Map:   8%|         | 4228/50245 [00:01<00:21, 2188.81 examples/s]
Map:   9%|         | 4478/50245 [00:02<00:20, 2261.74 examples/s]
Map:   9%|         | 4711/50245 [00:02<00:20, 2276.64 examples/s]
Map:  10%|         | 5001/50245 [00:02<00:21, 2151.26 examples/s]
Map:  10%|         | 5255/50245 [00:02<00:20, 2244.87 examples/s]
Map:  11%|         | 5512/50245 [00:02<00:19, 2327.29 examples/s]
Map:  11%|        | 5756/50245 [00:02<00:18, 2353.08 examples/s]
Map:  12%|        | 6000/50245 [00:02<00:19, 2253.94 examples/s]
Map:  12%|        | 6246/50245 [00:02<00:19, 2307.90 examples/s]
Map:  13%|        | 6497/50245 [00:02<00:18, 2359.31 examples/s]
Map:  13%|        | 6751/50245 [00:02<00:18, 2405.41 examples/s]
Map:  14%|        | 7000/50245 [00:03<00:18, 2302.98 examples/s]
Map:  14%|        | 7250/50245 [00:03<00:18, 2354.70 examples/s]
Map:  15%|        | 7492/50245 [00:03<00:18, 2369.84 examples/s]
Map:  16%|        | 7860/50245 [00:03<00:17, 2395.78 examples/s]
Map:  16%|        | 8187/50245 [00:03<00:18, 2317.74 examples/s]
Map:  17%|        | 8427/50245 [00:03<00:17, 2335.54 examples/s]
Map:  17%|        | 8678/50245 [00:03<00:17, 2378.26 examples/s]
Map:  18%|        | 8930/50245 [00:03<00:17, 2415.60 examples/s]
Map:  18%|        | 9254/50245 [00:04<00:17, 2314.38 examples/s]
Map:  19%|        | 9516/50245 [00:04<00:17, 2389.93 examples/s]
Map:  20%|        | 9877/50245 [00:04<00:16, 2389.87 examples/s]
Map:  20%|        | 10187/50245 [00:04<00:17, 2278.14 examples/s]
Map:  21%|        | 10424/50245 [00:04<00:17, 2299.39 examples/s]
Map:  21%|        | 10669/50245 [00:04<00:16, 2335.14 examples/s]
Map:  22%|       | 10925/50245 [00:04<00:16, 2392.60 examples/s]
Map:  22%|       | 11246/50245 [00:04<00:17, 2285.79 examples/s]
Map:  23%|       | 11489/50245 [00:05<00:16, 2321.18 examples/s]
Map:  23%|       | 11746/50245 [00:05<00:16, 2385.97 examples/s]
Map:  24%|       | 11991/50245 [00:05<00:15, 2402.11 examples/s]
Map:  25%|       | 12313/50245 [00:05<00:16, 2303.92 examples/s]
Map:  25%|       | 12683/50245 [00:05<00:15, 2355.56 examples/s]
Map:  26%|       | 12950/50245 [00:05<00:15, 2431.02 examples/s]
Map:  26%|       | 13277/50245 [00:05<00:15, 2342.49 examples/s]
Map:  27%|       | 13642/50245 [00:05<00:15, 2369.01 examples/s]
Map:  28%|       | 13882/50245 [00:06<00:15, 2372.74 examples/s]
Map:  28%|       | 14122/50245 [00:06<00:15, 2276.52 examples/s]
Map:  29%|       | 14360/50245 [00:06<00:15, 2298.51 examples/s]
Map:  29%|       | 14601/50245 [00:06<00:15, 2326.75 examples/s]
Map:  30%|       | 14852/50245 [00:06<00:14, 2375.02 examples/s]
Map:  30%|       | 15181/50245 [00:06<00:15, 2303.96 examples/s]
Map:  31%|       | 15419/50245 [00:06<00:15, 2321.54 examples/s]
Map:  31%|       | 15662/50245 [00:06<00:14, 2344.75 examples/s]
Map:  32%|      | 15909/50245 [00:06<00:14, 2373.75 examples/s]
Map:  32%|      | 16245/50245 [00:07<00:15, 2258.84 examples/s]
Map:  33%|      | 16506/50245 [00:07<00:14, 2344.98 examples/s]
Map:  33%|      | 16769/50245 [00:07<00:13, 2417.58 examples/s]
Map:  34%|      | 17126/50245 [00:07<00:14, 2321.04 examples/s]
Map:  35%|      | 17368/50245 [00:07<00:14, 2340.85 examples/s]
Map:  35%|      | 17620/50245 [00:07<00:13, 2385.13 examples/s]
Map:  36%|      | 17873/50245 [00:07<00:13, 2422.64 examples/s]
Map:  36%|      | 18193/50245 [00:07<00:13, 2309.93 examples/s]
Map:  37%|      | 18440/50245 [00:07<00:13, 2347.95 examples/s]
Map:  37%|      | 18687/50245 [00:08<00:13, 2379.22 examples/s]
Map:  38%|      | 18938/50245 [00:08<00:12, 2413.88 examples/s]
Map:  38%|      | 19258/50245 [00:08<00:13, 2300.17 examples/s]
Map:  39%|      | 19507/50245 [00:08<00:13, 2348.33 examples/s]
Map:  39%|      | 19750/50245 [00:08<00:12, 2366.79 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2287.44 examples/s]
Map:  40%|      | 20245/50245 [00:08<00:12, 2326.17 examples/s]
Map:  41%|      | 20500/50245 [00:08<00:12, 2385.44 examples/s]
Map:  41%|     | 20746/50245 [00:08<00:12, 2405.02 examples/s]
Map:  42%|     | 21052/50245 [00:09<00:12, 2263.06 examples/s]
Map:  42%|     | 21300/50245 [00:09<00:12, 2318.59 examples/s]
Map:  43%|     | 21548/50245 [00:09<00:12, 2361.60 examples/s]
Map:  43%|     | 21798/50245 [00:09<00:11, 2399.15 examples/s]
Map:  44%|     | 22127/50245 [00:09<00:12, 2275.75 examples/s]
Map:  45%|     | 22369/50245 [00:09<00:12, 2308.36 examples/s]
Map:  45%|     | 22616/50245 [00:09<00:11, 2348.53 examples/s]
Map:  46%|     | 22866/50245 [00:09<00:11, 2388.81 examples/s]
Map:  46%|     | 23175/50245 [00:10<00:11, 2260.93 examples/s]
Map:  47%|     | 23438/50245 [00:10<00:11, 2354.42 examples/s]
Map:  47%|     | 23678/50245 [00:10<00:11, 2364.32 examples/s]
Map:  48%|     | 23920/50245 [00:10<00:11, 2376.79 examples/s]
Map:  48%|     | 24228/50245 [00:10<00:11, 2223.36 examples/s]
Map:  49%|     | 24473/50245 [00:10<00:11, 2279.34 examples/s]
Map:  49%|     | 24721/50245 [00:10<00:10, 2331.51 examples/s]
Map:  50%|     | 24980/50245 [00:10<00:10, 2400.04 examples/s]
Map:  50%|     | 25298/50245 [00:10<00:10, 2292.56 examples/s]
Map:  51%|     | 25564/50245 [00:11<00:10, 2387.18 examples/s]
Map:  52%|    | 25917/50245 [00:11<00:10, 2369.42 examples/s]
Map:  52%|    | 26241/50245 [00:11<00:10, 2256.45 examples/s]
Map:  53%|    | 26486/50245 [00:11<00:10, 2295.40 examples/s]
Map:  53%|    | 26741/50245 [00:11<00:09, 2358.10 examples/s]
Map:  54%|    | 26988/50245 [00:11<00:09, 2386.31 examples/s]
Map:  54%|    | 27310/50245 [00:11<00:09, 2294.33 examples/s]
Map:  55%|    | 27565/50245 [00:11<00:09, 2356.87 examples/s]
Map:  55%|    | 27806/50245 [00:11<00:09, 2368.31 examples/s]
Map:  56%|    | 28110/50245 [00:12<00:09, 2236.43 examples/s]
Map:  56%|    | 28366/50245 [00:12<00:09, 2315.02 examples/s]
Map:  57%|    | 28612/50245 [00:12<00:09, 2353.57 examples/s]
Map:  57%|    | 28855/50245 [00:12<00:09, 2372.65 examples/s]
Map:  58%|    | 29176/50245 [00:12<00:09, 2279.10 examples/s]
Map:  59%|    | 29424/50245 [00:12<00:08, 2330.66 examples/s]
Map:  59%|    | 29782/50245 [00:12<00:08, 2345.07 examples/s]
Map:  60%|    | 30121/50245 [00:13<00:08, 2244.17 examples/s]
Map:  60%|    | 30372/50245 [00:13<00:08, 2303.76 examples/s]
Map:  61%|    | 30626/50245 [00:13<00:08, 2360.67 examples/s]
Map:  61%|   | 30869/50245 [00:13<00:08, 2377.41 examples/s]
Map:  62%|   | 31186/50245 [00:13<00:08, 2276.26 examples/s]
Map:  63%|   | 31434/50245 [00:13<00:08, 2326.74 examples/s]
Map:  63%|   | 31688/50245 [00:13<00:07, 2382.25 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2266.44 examples/s]
Map:  64%|   | 32241/50245 [00:13<00:07, 2300.21 examples/s]
Map:  65%|   | 32491/50245 [00:14<00:07, 2349.58 examples/s]
Map:  65%|   | 32741/50245 [00:14<00:07, 2389.84 examples/s]
Map:  66%|   | 32994/50245 [00:14<00:07, 2426.62 examples/s]
Map:  66%|   | 33326/50245 [00:14<00:07, 2339.27 examples/s]
Map:  67%|   | 33570/50245 [00:14<00:07, 2363.71 examples/s]
Map:  67%|   | 33812/50245 [00:14<00:06, 2378.27 examples/s]
Map:  68%|   | 34132/50245 [00:14<00:07, 2281.01 examples/s]
Map:  68%|   | 34392/50245 [00:14<00:06, 2361.21 examples/s]
Map:  69%|   | 34646/50245 [00:14<00:06, 2406.83 examples/s]
Map:  69%|   | 34913/50245 [00:15<00:06, 2478.60 examples/s]
Map:  70%|   | 35247/50245 [00:15<00:06, 2347.88 examples/s]
Map:  71%|   | 35492/50245 [00:15<00:06, 2370.08 examples/s]
Map:  71%|  | 35851/50245 [00:15<00:06, 2377.06 examples/s]
Map:  72%|  | 36187/50245 [00:15<00:06, 2326.40 examples/s]
Map:  73%|  | 36436/50245 [00:15<00:05, 2363.64 examples/s]
Map:  73%|  | 36682/50245 [00:15<00:05, 2385.47 examples/s]
Map:  73%|  | 36928/50245 [00:15<00:05, 2403.21 examples/s]
Map:  74%|  | 37220/50245 [00:16<00:05, 2219.77 examples/s]
Map:  75%|  | 37476/50245 [00:16<00:05, 2304.39 examples/s]
Map:  75%|  | 37718/50245 [00:16<00:05, 2331.86 examples/s]
Map:  76%|  | 37965/50245 [00:16<00:05, 2368.64 examples/s]
Map:  76%|  | 38273/50245 [00:16<00:05, 2246.38 examples/s]
Map:  77%|  | 38523/50245 [00:16<00:05, 2310.22 examples/s]
Map:  77%|  | 38782/50245 [00:16<00:04, 2381.26 examples/s]
Map:  78%|  | 39127/50245 [00:16<00:04, 2324.24 examples/s]
Map:  78%|  | 39380/50245 [00:16<00:04, 2374.72 examples/s]
Map:  79%|  | 39742/50245 [00:17<00:04, 2381.49 examples/s]
Map:  80%|  | 39989/50245 [00:17<00:04, 2398.72 examples/s]
Map:  80%|  | 40317/50245 [00:17<00:04, 2319.61 examples/s]
Map:  81%|  | 40578/50245 [00:17<00:04, 2390.65 examples/s]
Map:  81%| | 40832/50245 [00:17<00:03, 2426.06 examples/s]
Map:  82%| | 41142/50245 [00:17<00:03, 2295.16 examples/s]
Map:  83%| | 41503/50245 [00:17<00:03, 2330.54 examples/s]
Map:  83%| | 41748/50245 [00:17<00:03, 2356.63 examples/s]
Map:  84%| | 42046/50245 [00:18<00:03, 2225.37 examples/s]
Map:  84%| | 42302/50245 [00:18<00:03, 2304.04 examples/s]
Map:  85%| | 42556/50245 [00:18<00:03, 2364.52 examples/s]
Map:  85%| | 42802/50245 [00:18<00:03, 2388.16 examples/s]
Map:  86%| | 43122/50245 [00:18<00:03, 2261.62 examples/s]
Map:  86%| | 43390/50245 [00:18<00:02, 2367.00 examples/s]
Map:  87%| | 43648/50245 [00:18<00:02, 2423.54 examples/s]
Map:  87%| | 43895/50245 [00:18<00:02, 2433.56 examples/s]
Map:  88%| | 44240/50245 [00:19<00:02, 2312.01 examples/s]
Map:  89%| | 44480/50245 [00:19<00:02, 2330.86 examples/s]
Map:  89%| | 44737/50245 [00:19<00:02, 2391.37 examples/s]
Map:  90%| | 44992/50245 [00:19<00:02, 2433.28 examples/s]
Map:  90%| | 45297/50245 [00:19<00:02, 2280.02 examples/s]
Map:  91%| | 45540/50245 [00:19<00:02, 2317.61 examples/s]
Map:  91%| | 45786/50245 [00:19<00:01, 2353.20 examples/s]
Map:  92%|| 46123/50245 [00:19<00:01, 2271.00 examples/s]
Map:  92%|| 46366/50245 [00:19<00:01, 2309.23 examples/s]
Map:  93%|| 46627/50245 [00:20<00:01, 2387.66 examples/s]
Map:  93%|| 46881/50245 [00:20<00:01, 2429.10 examples/s]
Map:  94%|| 47127/50245 [00:20<00:01, 2321.85 examples/s]
Map:  94%|| 47476/50245 [00:20<00:01, 2321.25 examples/s]
Map:  95%|| 47802/50245 [00:20<00:01, 1763.29 examples/s]
Map:  96%|| 48125/50245 [00:20<00:01, 1858.09 examples/s]
Map:  96%|| 48394/50245 [00:20<00:00, 2027.84 examples/s]
Map:  97%|| 48647/50245 [00:21<00:00, 2138.61 examples/s]
Map:  97%|| 48893/50245 [00:21<00:00, 2214.43 examples/s]
Map:  98%|| 49238/50245 [00:21<00:00, 2169.94 examples/s]
Map:  98%|| 49475/50245 [00:21<00:00, 2215.29 examples/s]
Map:  99%|| 49724/50245 [00:21<00:00, 2282.98 examples/s]
Map:  99%|| 49966/50245 [00:21<00:00, 2316.09 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2167.62 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2310.59 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [9] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x154e42ac94d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x154e42a93434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x154e6e0328c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x154e6e033572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x154e6e0335f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x154e6dff2ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x154e6dff2ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x154e6dff2ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x154e43a58c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x154e43a5c901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x154e43a63a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x154e43a64e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x154e43a67aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x154e43a76a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x154e6dfe72d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x154e6dfeb02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x154e6dff9e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x154e82677fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x154e81ec3285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x154ebbb31cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 9 STDERR----------
Global rank 10 (PID 186651) exited with code 1
----------Begin global rank 10 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 10 STDOUT----------
----------Begin global rank 10 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 164/50245 [00:00<00:31, 1611.07 examples/s]
Map:   1%|          | 416/50245 [00:00<00:23, 2135.39 examples/s]
Map:   1%|         | 677/50245 [00:00<00:21, 2348.36 examples/s]
Map:   2%|         | 930/50245 [00:00<00:20, 2415.67 examples/s]
Map:   2%|         | 1238/50245 [00:00<00:24, 1966.89 examples/s]
Map:   3%|         | 1471/50245 [00:00<00:23, 2064.76 examples/s]
Map:   3%|         | 1710/50245 [00:00<00:22, 2152.95 examples/s]
Map:   4%|         | 1958/50245 [00:00<00:21, 2244.64 examples/s]
Map:   5%|         | 2277/50245 [00:01<00:21, 2195.34 examples/s]
Map:   5%|         | 2515/50245 [00:01<00:21, 2242.04 examples/s]
Map:   5%|         | 2757/50245 [00:01<00:20, 2288.31 examples/s]
Map:   6%|         | 2994/50245 [00:01<00:20, 2306.32 examples/s]
Map:   7%|         | 3293/50245 [00:01<00:21, 2184.24 examples/s]
Map:   7%|         | 3547/50245 [00:01<00:20, 2276.28 examples/s]
Map:   8%|         | 3890/50245 [00:01<00:20, 2276.05 examples/s]
Map:   8%|         | 4234/50245 [00:01<00:20, 2196.66 examples/s]
Map:   9%|         | 4485/50245 [00:02<00:20, 2263.59 examples/s]
Map:   9%|         | 4719/50245 [00:02<00:19, 2278.37 examples/s]
Map:  10%|         | 5009/50245 [00:02<00:21, 2153.66 examples/s]
Map:  10%|         | 5261/50245 [00:02<00:20, 2243.80 examples/s]
Map:  11%|         | 5516/50245 [00:02<00:19, 2322.70 examples/s]
Map:  11%|        | 5759/50245 [00:02<00:18, 2350.50 examples/s]
Map:  12%|        | 6000/50245 [00:02<00:19, 2251.96 examples/s]
Map:  12%|        | 6249/50245 [00:02<00:19, 2313.29 examples/s]
Map:  13%|        | 6498/50245 [00:02<00:18, 2361.82 examples/s]
Map:  13%|        | 6752/50245 [00:02<00:18, 2408.58 examples/s]
Map:  14%|        | 7000/50245 [00:03<00:18, 2307.45 examples/s]
Map:  14%|        | 7248/50245 [00:03<00:18, 2352.35 examples/s]
Map:  15%|        | 7489/50245 [00:03<00:18, 2367.70 examples/s]
Map:  15%|        | 7727/50245 [00:03<00:17, 2368.75 examples/s]
Map:  16%|        | 7979/50245 [00:03<00:17, 2408.85 examples/s]
Map:  17%|        | 8306/50245 [00:03<00:18, 2315.06 examples/s]
Map:  17%|        | 8550/50245 [00:03<00:17, 2345.79 examples/s]
Map:  18%|        | 8806/50245 [00:03<00:17, 2401.40 examples/s]
Map:  18%|        | 9132/50245 [00:04<00:17, 2312.80 examples/s]
Map:  19%|        | 9394/50245 [00:04<00:17, 2391.54 examples/s]
Map:  19%|        | 9638/50245 [00:04<00:16, 2399.11 examples/s]
Map:  20%|        | 9885/50245 [00:04<00:16, 2415.05 examples/s]
Map:  20%|        | 10243/50245 [00:04<00:17, 2279.07 examples/s]
Map:  21%|        | 10477/50245 [00:04<00:17, 2292.76 examples/s]
Map:  21%|       | 10731/50245 [00:04<00:16, 2355.22 examples/s]
Map:  22%|       | 10982/50245 [00:04<00:16, 2394.86 examples/s]
Map:  22%|       | 11293/50245 [00:04<00:17, 2271.92 examples/s]
Map:  23%|       | 11541/50245 [00:05<00:16, 2320.92 examples/s]
Map:  23%|       | 11795/50245 [00:05<00:16, 2377.78 examples/s]
Map:  24%|       | 12132/50245 [00:05<00:16, 2299.24 examples/s]
Map:  25%|       | 12372/50245 [00:05<00:16, 2322.89 examples/s]
Map:  25%|       | 12620/50245 [00:05<00:15, 2361.30 examples/s]
Map:  26%|       | 12888/50245 [00:05<00:15, 2445.51 examples/s]
Map:  26%|       | 13253/50245 [00:05<00:15, 2348.08 examples/s]
Map:  27%|       | 13497/50245 [00:05<00:15, 2366.78 examples/s]
Map:  27%|       | 13739/50245 [00:05<00:15, 2379.33 examples/s]
Map:  28%|       | 13987/50245 [00:06<00:15, 2401.21 examples/s]
Map:  28%|       | 14302/50245 [00:06<00:15, 2285.65 examples/s]
Map:  29%|       | 14540/50245 [00:06<00:15, 2305.93 examples/s]
Map:  29%|       | 14791/50245 [00:06<00:15, 2358.08 examples/s]
Map:  30%|       | 15125/50245 [00:06<00:15, 2307.28 examples/s]
Map:  31%|       | 15368/50245 [00:06<00:14, 2336.41 examples/s]
Map:  31%|      | 15724/50245 [00:06<00:14, 2344.42 examples/s]
Map:  32%|      | 15967/50245 [00:06<00:14, 2362.63 examples/s]
Map:  32%|      | 16281/50245 [00:07<00:15, 2264.05 examples/s]
Map:  33%|      | 16541/50245 [00:07<00:14, 2344.50 examples/s]
Map:  33%|      | 16800/50245 [00:07<00:13, 2408.30 examples/s]
Map:  34%|      | 17124/50245 [00:07<00:14, 2310.17 examples/s]
Map:  35%|      | 17364/50245 [00:07<00:14, 2329.55 examples/s]
Map:  35%|      | 17615/50245 [00:07<00:13, 2376.04 examples/s]
Map:  36%|      | 17866/50245 [00:07<00:13, 2410.80 examples/s]
Map:  36%|      | 18187/50245 [00:07<00:13, 2307.82 examples/s]
Map:  37%|      | 18432/50245 [00:07<00:13, 2343.16 examples/s]
Map:  37%|      | 18680/50245 [00:08<00:13, 2377.96 examples/s]
Map:  38%|      | 18931/50245 [00:08<00:12, 2412.41 examples/s]
Map:  38%|      | 19253/50245 [00:08<00:13, 2297.30 examples/s]
Map:  39%|      | 19503/50245 [00:08<00:13, 2346.40 examples/s]
Map:  39%|      | 19747/50245 [00:08<00:12, 2369.72 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2296.63 examples/s]
Map:  40%|      | 20245/50245 [00:08<00:12, 2333.56 examples/s]
Map:  41%|      | 20501/50245 [00:08<00:12, 2392.74 examples/s]
Map:  41%|     | 20750/50245 [00:08<00:12, 2418.12 examples/s]
Map:  42%|     | 21058/50245 [00:09<00:12, 2276.19 examples/s]
Map:  42%|     | 21306/50245 [00:09<00:12, 2328.34 examples/s]
Map:  43%|     | 21554/50245 [00:09<00:12, 2368.07 examples/s]
Map:  43%|     | 21805/50245 [00:09<00:11, 2405.46 examples/s]
Map:  44%|     | 22126/50245 [00:09<00:12, 2278.71 examples/s]
Map:  45%|     | 22365/50245 [00:09<00:12, 2305.71 examples/s]
Map:  45%|     | 22613/50245 [00:09<00:11, 2349.17 examples/s]
Map:  45%|     | 22859/50245 [00:09<00:11, 2377.66 examples/s]
Map:  46%|     | 23166/50245 [00:10<00:12, 2250.34 examples/s]
Map:  47%|     | 23427/50245 [00:10<00:11, 2342.13 examples/s]
Map:  47%|     | 23779/50245 [00:10<00:11, 2339.86 examples/s]
Map:  48%|     | 24120/50245 [00:10<00:11, 2259.31 examples/s]
Map:  48%|     | 24354/50245 [00:10<00:11, 2277.03 examples/s]
Map:  49%|     | 24715/50245 [00:10<00:11, 2318.24 examples/s]
Map:  50%|     | 24975/50245 [00:10<00:10, 2384.70 examples/s]
Map:  50%|     | 25293/50245 [00:10<00:10, 2290.94 examples/s]
Map:  51%|     | 25559/50245 [00:11<00:10, 2380.24 examples/s]
Map:  52%|    | 25912/50245 [00:11<00:10, 2369.37 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2249.29 examples/s]
Map:  53%|    | 26482/50245 [00:11<00:10, 2289.99 examples/s]
Map:  53%|    | 26734/50245 [00:11<00:10, 2347.10 examples/s]
Map:  54%|    | 26981/50245 [00:11<00:09, 2376.05 examples/s]
Map:  54%|    | 27294/50245 [00:11<00:10, 2268.41 examples/s]
Map:  55%|    | 27554/50245 [00:11<00:09, 2350.69 examples/s]
Map:  56%|    | 27924/50245 [00:12<00:09, 2389.38 examples/s]
Map:  56%|    | 28231/50245 [00:12<00:09, 2236.93 examples/s]
Map:  57%|    | 28490/50245 [00:12<00:09, 2318.34 examples/s]
Map:  57%|    | 28733/50245 [00:12<00:09, 2344.07 examples/s]
Map:  58%|    | 28983/50245 [00:12<00:08, 2383.12 examples/s]
Map:  58%|    | 29299/50245 [00:12<00:09, 2278.43 examples/s]
Map:  59%|    | 29534/50245 [00:12<00:09, 2294.41 examples/s]
Map:  59%|    | 29779/50245 [00:12<00:08, 2334.78 examples/s]
Map:  60%|    | 30120/50245 [00:13<00:09, 2219.14 examples/s]
Map:  60%|    | 30370/50245 [00:13<00:08, 2286.99 examples/s]
Map:  61%|    | 30620/50245 [00:13<00:08, 2342.73 examples/s]
Map:  61%|   | 30863/50245 [00:13<00:08, 2363.62 examples/s]
Map:  62%|   | 31177/50245 [00:13<00:08, 2259.51 examples/s]
Map:  63%|   | 31423/50245 [00:13<00:08, 2310.62 examples/s]
Map:  63%|   | 31676/50245 [00:13<00:07, 2369.18 examples/s]
Map:  64%|   | 32000/50245 [00:13<00:08, 2250.92 examples/s]
Map:  64%|   | 32238/50245 [00:13<00:07, 2281.69 examples/s]
Map:  65%|   | 32487/50245 [00:14<00:07, 2336.25 examples/s]
Map:  65%|   | 32744/50245 [00:14<00:07, 2399.13 examples/s]
Map:  66%|   | 32995/50245 [00:14<00:07, 2427.99 examples/s]
Map:  66%|   | 33321/50245 [00:14<00:07, 2329.31 examples/s]
Map:  67%|   | 33564/50245 [00:14<00:07, 2355.56 examples/s]
Map:  67%|   | 33807/50245 [00:14<00:06, 2373.49 examples/s]
Map:  68%|   | 34130/50245 [00:14<00:07, 2283.34 examples/s]
Map:  68%|   | 34389/50245 [00:14<00:06, 2361.62 examples/s]
Map:  69%|   | 34641/50245 [00:14<00:06, 2400.99 examples/s]
Map:  69%|   | 34906/50245 [00:15<00:06, 2469.24 examples/s]
Map:  70%|   | 35245/50245 [00:15<00:06, 2336.95 examples/s]
Map:  71%|   | 35490/50245 [00:15<00:06, 2363.29 examples/s]
Map:  71%|   | 35731/50245 [00:15<00:06, 2372.19 examples/s]
Map:  72%|  | 35982/50245 [00:15<00:05, 2409.12 examples/s]
Map:  72%|  | 36300/50245 [00:15<00:06, 2298.73 examples/s]
Map:  73%|  | 36557/50245 [00:15<00:05, 2368.12 examples/s]
Map:  73%|  | 36808/50245 [00:15<00:05, 2400.36 examples/s]
Map:  74%|  | 37116/50245 [00:16<00:05, 2245.04 examples/s]
Map:  75%|  | 37472/50245 [00:16<00:05, 2286.52 examples/s]
Map:  75%|  | 37714/50245 [00:16<00:05, 2315.20 examples/s]
Map:  76%|  | 37958/50245 [00:16<00:05, 2346.69 examples/s]
Map:  76%|  | 38260/50245 [00:16<00:05, 2225.04 examples/s]
Map:  77%|  | 38508/50245 [00:16<00:05, 2287.92 examples/s]
Map:  77%|  | 38769/50245 [00:16<00:04, 2369.97 examples/s]
Map:  78%|  | 39126/50245 [00:16<00:04, 2309.15 examples/s]
Map:  78%|  | 39378/50245 [00:16<00:04, 2359.39 examples/s]
Map:  79%|  | 39619/50245 [00:17<00:04, 2369.84 examples/s]
Map:  79%|  | 39870/50245 [00:17<00:04, 2407.36 examples/s]
Map:  80%|  | 40179/50245 [00:17<00:04, 2277.06 examples/s]
Map:  81%|  | 40449/50245 [00:17<00:04, 2386.76 examples/s]
Map:  81%|  | 40694/50245 [00:17<00:03, 2402.77 examples/s]
Map:  82%| | 41002/50245 [00:17<00:04, 2272.15 examples/s]
Map:  82%| | 41243/50245 [00:17<00:03, 2302.70 examples/s]
Map:  83%| | 41492/50245 [00:17<00:03, 2351.69 examples/s]
Map:  83%| | 41738/50245 [00:17<00:03, 2378.11 examples/s]
Map:  84%| | 42031/50245 [00:18<00:03, 2214.35 examples/s]
Map:  84%| | 42289/50245 [00:18<00:03, 2304.99 examples/s]
Map:  85%| | 42542/50245 [00:18<00:03, 2364.60 examples/s]
Map:  85%| | 42792/50245 [00:18<00:03, 2400.57 examples/s]
Map:  86%| | 43120/50245 [00:18<00:03, 2260.34 examples/s]
Map:  86%| | 43387/50245 [00:18<00:02, 2362.75 examples/s]
Map:  87%| | 43645/50245 [00:18<00:02, 2419.16 examples/s]
Map:  88%| | 44000/50245 [00:18<00:02, 2307.18 examples/s]
Map:  88%| | 44237/50245 [00:19<00:02, 2320.86 examples/s]
Map:  89%| | 44474/50245 [00:19<00:02, 2332.78 examples/s]
Map:  89%| | 44730/50245 [00:19<00:02, 2392.90 examples/s]
Map:  90%| | 44981/50245 [00:19<00:02, 2422.61 examples/s]
Map:  90%| | 45285/50245 [00:19<00:02, 2266.97 examples/s]
Map:  91%| | 45532/50245 [00:19<00:02, 2319.15 examples/s]
Map:  91%| | 45775/50245 [00:19<00:01, 2348.06 examples/s]
Map:  92%|| 46123/50245 [00:19<00:01, 2264.70 examples/s]
Map:  92%|| 46366/50245 [00:19<00:01, 2304.08 examples/s]
Map:  93%|| 46627/50245 [00:20<00:01, 2381.30 examples/s]
Map:  93%|| 46881/50245 [00:20<00:01, 2422.10 examples/s]
Map:  94%|| 47128/50245 [00:20<00:01, 2311.05 examples/s]
Map:  94%|| 47476/50245 [00:20<00:01, 2311.88 examples/s]
Map:  95%|| 47802/50245 [00:20<00:01, 1763.67 examples/s]
Map:  96%|| 48125/50245 [00:20<00:01, 1861.03 examples/s]
Map:  96%|| 48392/50245 [00:20<00:00, 2026.42 examples/s]
Map:  97%|| 48645/50245 [00:21<00:00, 2137.21 examples/s]
Map:  97%|| 48889/50245 [00:21<00:00, 2209.99 examples/s]
Map:  98%|| 49124/50245 [00:21<00:00, 2151.39 examples/s]
Map:  98%|| 49356/50245 [00:21<00:00, 2193.51 examples/s]
Map:  99%|| 49595/50245 [00:21<00:00, 2244.65 examples/s]
Map:  99%|| 49847/50245 [00:21<00:00, 2320.67 examples/s]
Map: 100%|| 50155/50245 [00:21<00:00, 2217.17 examples/s]
Map: 100%|| 50245/50245 [00:21<00:00, 2306.34 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [10] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14eb550a14d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14eb5506b434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14eb8060a8c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14eb8060b572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14eb8060b5f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14eb805caac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14eb805caac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14eb805caac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14eb56030c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14eb56034901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14eb5603ba2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14eb5603ce31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14eb5603faed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14eb5604ea41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14eb805bf2d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14eb805c302a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14eb805d1e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14eb94c4ffee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14eb9449b285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14ebce109cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 10 STDERR----------
Global rank 11 (PID 186652) exited with code 1
----------Begin global rank 11 STDOUT----------
As run_name, save_folder, and save_latest_filename are set,                 changing autoresume default to True...
Building train loader...
Building eval loader...
Initializing model...

----------End global rank 11 STDOUT----------
----------Begin global rank 11 STDERR----------
device_microbatch_size > device_batch_size, will be reduced from 8 -> 4.
Using pad_token, but it is not set yet.

Map:   0%|          | 0/50245 [00:00<?, ? examples/s]
Map:   0%|          | 243/50245 [00:00<00:20, 2392.94 examples/s]
Map:   1%|          | 501/50245 [00:00<00:19, 2489.73 examples/s]
ERROR:composer.cli.launcher:Global rank 8 (PID 186649) exited with code 143
Map:   2%|         | 758/50245 [00:00<00:19, 2524.53 examples/s]
Map:   2%|         | 1119/50245 [00:00<00:21, 2287.06 examples/s]
Map:   3%|         | 1468/50245 [00:00<00:21, 2298.09 examples/s]
Map:   3%|         | 1704/50245 [00:00<00:20, 2312.54 examples/s]
Map:   4%|         | 1948/50245 [00:00<00:20, 2345.40 examples/s]
Map:   5%|         | 2270/50245 [00:00<00:21, 2266.23 examples/s]
Map:   5%|         | 2507/50245 [00:01<00:20, 2292.20 examples/s]
Map:   5%|         | 2748/50245 [00:01<00:20, 2322.52 examples/s]
Map:   6%|         | 3049/50245 [00:01<00:21, 2201.85 examples/s]
Map:   7%|         | 3279/50245 [00:01<00:21, 2226.30 examples/s]
Map:   7%|         | 3531/50245 [00:01<00:20, 2304.63 examples/s]
Map:   8%|         | 3874/50245 [00:01<00:20, 2291.21 examples/s]
Map:   8%|         | 4120/50245 [00:01<00:21, 2195.81 examples/s]
Map:   9%|         | 4352/50245 [00:01<00:20, 2226.06 examples/s]
Map:   9%|         | 4600/50245 [00:02<00:19, 2292.37 examples/s]
Map:  10%|         | 4941/50245 [00:02<00:19, 2283.84 examples/s]
Map:  10%|         | 5255/50245 [00:02<00:20, 2214.67 examples/s]
Map:  11%|         | 5509/50245 [00:02<00:19, 2292.65 examples/s]
Map:  11%|        | 5751/50245 [00:02<00:19, 2324.75 examples/s]
Map:  12%|        | 5999/50245 [00:02<00:18, 2365.35 examples/s]
Map:  13%|        | 6315/50245 [00:02<00:19, 2269.01 examples/s]
Map:  13%|        | 6560/50245 [00:02<00:18, 2314.06 examples/s]
Map:  14%|        | 6810/50245 [00:02<00:18, 2362.50 examples/s]
Map:  14%|        | 7135/50245 [00:03<00:18, 2285.62 examples/s]
Map:  15%|        | 7379/50245 [00:03<00:18, 2323.82 examples/s]
Map:  15%|        | 7624/50245 [00:03<00:18, 2355.78 examples/s]
Map:  16%|        | 7869/50245 [00:03<00:17, 2378.90 examples/s]
Map:  16%|        | 8195/50245 [00:03<00:18, 2300.32 examples/s]
Map:  17%|        | 8431/50245 [00:03<00:18, 2313.87 examples/s]
Map:  17%|        | 8682/50245 [00:03<00:17, 2360.74 examples/s]
Map:  18%|        | 8933/50245 [00:03<00:17, 2401.33 examples/s]
Map:  18%|        | 9254/50245 [00:04<00:17, 2299.06 examples/s]
Map:  19%|        | 9514/50245 [00:04<00:17, 2377.02 examples/s]
Map:  20%|        | 9870/50245 [00:04<00:17, 2372.54 examples/s]
Map:  20%|        | 10180/50245 [00:04<00:17, 2264.87 examples/s]
Map:  21%|        | 10411/50245 [00:04<00:17, 2274.33 examples/s]
Map:  21%|        | 10654/50245 [00:04<00:17, 2311.75 examples/s]
Map:  22%|       | 10911/50245 [00:04<00:16, 2378.99 examples/s]
Map:  22%|       | 11246/50245 [00:04<00:17, 2273.23 examples/s]
Map:  23%|       | 11488/50245 [00:04<00:16, 2307.93 examples/s]
Map:  23%|       | 11745/50245 [00:05<00:16, 2375.73 examples/s]
Map:  24%|       | 11990/50245 [00:05<00:15, 2391.96 examples/s]
Map:  24%|       | 12309/50245 [00:05<00:16, 2290.29 examples/s]
Map:  25%|       | 12679/50245 [00:05<00:16, 2346.24 examples/s]
Map:  26%|       | 12944/50245 [00:05<00:15, 2421.03 examples/s]
Map:  26%|       | 13266/50245 [00:05<00:15, 2324.52 examples/s]
Map:  27%|       | 13507/50245 [00:05<00:15, 2337.73 examples/s]
Map:  27%|       | 13750/50245 [00:05<00:15, 2359.78 examples/s]
Map:  28%|       | 13997/50245 [00:06<00:15, 2386.25 examples/s]
Map:  28%|       | 14304/50245 [00:06<00:15, 2257.83 examples/s]
Map:  29%|       | 14541/50245 [00:06<00:15, 2284.02 examples/s]
Map:  29%|       | 14790/50245 [00:06<00:15, 2336.51 examples/s]
Map:  30%|       | 15122/50245 [00:06<00:15, 2282.07 examples/s]
Map:  31%|       | 15364/50245 [00:06<00:15, 2314.35 examples/s]
Map:  31%|      | 15716/50245 [00:06<00:14, 2323.64 examples/s]
Map:  32%|      | 15963/50245 [00:06<00:14, 2357.98 examples/s]
Map:  32%|      | 16268/50245 [00:07<00:15, 2240.58 examples/s]
Map:  33%|      | 16528/50245 [00:07<00:14, 2328.01 examples/s]
Map:  33%|      | 16786/50245 [00:07<00:13, 2391.93 examples/s]
Map:  34%|      | 17125/50245 [00:07<00:14, 2298.36 examples/s]
Map:  35%|      | 17363/50245 [00:07<00:14, 2317.32 examples/s]
Map:  35%|      | 17612/50245 [00:07<00:13, 2362.09 examples/s]
Map:  36%|      | 17862/50245 [00:07<00:13, 2399.27 examples/s]
Map:  36%|      | 18181/50245 [00:07<00:13, 2293.24 examples/s]
Map:  37%|      | 18422/50245 [00:07<00:13, 2322.05 examples/s]
Map:  37%|      | 18669/50245 [00:08<00:13, 2359.16 examples/s]
Map:  38%|      | 18917/50245 [00:08<00:13, 2390.38 examples/s]
Map:  38%|      | 19255/50245 [00:08<00:13, 2282.20 examples/s]
Map:  39%|      | 19503/50245 [00:08<00:13, 2329.32 examples/s]
Map:  39%|      | 19744/50245 [00:08<00:12, 2349.17 examples/s]
Map:  40%|      | 20000/50245 [00:08<00:13, 2273.88 examples/s]
Map:  40%|      | 20241/50245 [00:08<00:12, 2308.67 examples/s]
Map:  41%|      | 20490/50245 [00:08<00:12, 2357.14 examples/s]
Map:  41%|     | 20738/50245 [00:08<00:12, 2387.25 examples/s]
Map:  42%|     | 21047/50245 [00:09<00:12, 2256.09 examples/s]
Map:  42%|     | 21292/50245 [00:09<00:12, 2305.77 examples/s]
Map:  43%|     | 21536/50245 [00:09<00:12, 2340.99 examples/s]
Map:  43%|     | 21788/50245 [00:09<00:11, 2389.31 examples/s]
Map:  44%|     | 22125/50245 [00:09<00:12, 2258.43 examples/s]
Map:  45%|     | 22361/50245 [00:09<00:12, 2283.92 examples/s]
Map:  45%|     | 22605/50245 [00:09<00:11, 2322.55 examples/s]
Map:  45%|     | 22859/50245 [00:09<00:11, 2375.44 examples/s]
Map:  46%|     | 23167/50245 [00:10<00:12, 2252.34 examples/s]
Map:  47%|     | 23428/50245 [00:10<00:11, 2342.56 examples/s]
Map:  47%|     | 23672/50245 [00:10<00:11, 2365.41 examples/s]
Map:  48%|     | 23916/50245 [00:10<00:11, 2382.40 examples/s]
Map:  48%|     | 24219/50245 [00:10<00:11, 2210.25 examples/s]
Map:  49%|     | 24468/50245 [00:10<00:11, 2276.08 examples/s]
Map:  49%|     | 24713/50245 [00:10<00:11, 2320.89 examples/s]
Map:  50%|     | 24969/50245 [00:10<00:10, 2386.00 examples/s]
Map:  50%|     | 25282/50245 [00:10<00:10, 2269.89 examples/s]
Map:  51%|     | 25547/50245 [00:11<00:10, 2367.54 examples/s]
Map:  52%|    | 25903/50245 [00:11<00:10, 2365.57 examples/s]
Map:  52%|    | 26239/50245 [00:11<00:10, 2242.44 examples/s]
Map:  53%|    | 26481/50245 [00:11<00:10, 2283.71 examples/s]
Map:  53%|    | 26734/50245 [00:11<00:10, 2342.79 examples/s]
Map:  54%|    | 26982/50245 [00:11<00:09, 2378.14 examples/s]
Map:  54%|    | 27297/50245 [00:11<00:10, 2275.99 examples/s]
Map:  55%|    | 27558/50245 [00:11<00:09, 2359.65 examples/s]
Map:  56%|    | 27919/50245 [00:12<00:09, 2371.27 examples/s]
Map:  56%|    | 28220/50245 [00:12<00:10, 2188.66 examples/s]
Map:  57%|    | 28472/50245 [00:12<00:09, 2266.18 examples/s]
Map:  57%|    | 28704/50245 [00:12<00:09, 2273.56 examples/s]
Map:  58%|    | 28949/50245 [00:12<00:09, 2315.34 examples/s]
Map:  58%|    | 29252/50245 [00:12<00:09, 2206.29 examples/s]
Map:  59%|    | 29485/50245 [00:12<00:09, 2236.87 examples/s]
Map:  59%|    | 29714/50245 [00:12<00:09, 2246.90 examples/s]
Map:  60%|    | 29951/50245 [00:12<00:08, 2278.97 examples/s]
Map:  60%|    | 30238/50245 [00:13<00:09, 2139.52 examples/s]
Map:  61%|    | 30480/50245 [00:13<00:08, 2209.61 examples/s]
Map:  61%|    | 30721/50245 [00:13<00:08, 2263.13 examples/s]
Map:  62%|   | 30967/50245 [00:13<00:08, 2316.50 examples/s]
Map:  62%|   | 31282/50245 [00:13<00:08, 2230.52 examples/s]
Map:  63%|   | 31511/50245 [00:13<00:08, 2239.62 examples/s]
Map:  63%|   | 31761/50245 [00:13<00:08, 2309.10 examples/s]
Map:  64%|   | 32058/50245 [00:13<00:08, 2176.60 examples/s]
Map:  64%|   | 32287/50245 [00:14<00:08, 2204.05 examples/s]
Map:  65%|   | 32538/50245 [00:14<00:07, 2281.58 examples/s]
Map:  65%|   | 32795/50245 [00:14<00:07, 2360.36 examples/s]
Map:  66%|   | 33131/50245 [00:14<00:07, 2268.06 examples/s]
Map:  66%|   | 33376/50245 [00:14<00:07, 2313.73 examples/s]
Map:  67%|   | 33617/50245 [00:14<00:07, 2337.02 examples/s]
Map:  67%|   | 33856/50245 [00:14<00:06, 2348.64 examples/s]
Map:  68%|   | 34167/50245 [00:14<00:07, 2241.75 examples/s]
Map:  68%|   | 34416/50245 [00:14<00:06, 2305.63 examples/s]
Map:  69%|   | 34664/50245 [00:15<00:06, 2350.41 examples/s]
Map:  70%|   | 34923/50245 [00:15<00:06, 2411.93 examples/s]
Map:  70%|   | 35238/50245 [00:15<00:06, 2269.45 examples/s]
Map:  71%|   | 35475/50245 [00:15<00:06, 2292.97 examples/s]
Map:  71%|  | 35816/50245 [00:15<00:06, 2282.56 examples/s]
Map:  72%|  | 36137/50245 [00:15<00:06, 2229.62 examples/s]
Map:  72%|  | 36374/50245 [00:15<00:06, 2263.23 examples/s]
Map:  73%|  | 36610/50245 [00:15<00:05, 2285.40 examples/s]
Map:  73%|  | 36849/50245 [00:15<00:05, 2308.77 examples/s]
Map:  74%|  | 37140/50245 [00:16<00:06, 2172.55 examples/s]
Map:  74%|  | 37362/50245 [00:16<00:05, 2181.41 examples/s]
Map:  75%|  | 37609/50245 [00:16<00:05, 2257.41 examples/s]
Map:  75%|  | 37847/50245 [00:16<00:05, 2289.36 examples/s]
Map:  76%|  | 38142/50245 [00:16<00:05, 2166.10 examples/s]
Map:  76%|  | 38377/50245 [00:16<00:05, 2212.92 examples/s]
Map:  77%|  | 38627/50245 [00:16<00:05, 2290.00 examples/s]
Map:  78%|  | 38959/50245 [00:16<00:05, 2184.16 examples/s]
Map:  78%|  | 39262/50245 [00:17<00:05, 2125.94 examples/s]
Map:  79%|  | 39502/50245 [00:17<00:04, 2190.50 examples/s]
Map:  79%|  | 39734/50245 [00:17<00:04, 2221.76 examples/s]
Map:  80%|  | 39967/50245 [00:17<00:04, 2247.87 examples/s]
Map:  80%|  | 40266/50245 [00:17<00:04, 2152.65 examples/s]
Map:  81%|  | 40522/50245 [00:17<00:04, 2255.95 examples/s]
Map:  81%|  | 40755/50245 [00:17<00:04, 2272.86 examples/s]
Map:  82%| | 40986/50245 [00:17<00:04, 2280.92 examples/s]
Map:  82%| | 41275/50245 [00:17<00:04, 2146.06 examples/s]
Map:  83%| | 41511/50245 [00:18<00:03, 2200.22 examples/s]
Map:  83%| | 41747/50245 [00:18<00:03, 2241.29 examples/s]
Map:  84%| | 42024/50245 [00:18<00:03, 2095.33 examples/s]
Map:  84%| | 42267/50245 [00:18<00:03, 2181.00 examples/s]
Map:  85%| | 42497/50245 [00:18<00:03, 2210.92 examples/s]
Map:  85%| | 42744/50245 [00:18<00:03, 2281.32 examples/s]
Map:  86%| | 42979/50245 [00:18<00:03, 2296.82 examples/s]
Map:  86%| | 43289/50245 [00:18<00:03, 2205.97 examples/s]
Map:  87%| | 43534/50245 [00:18<00:02, 2268.73 examples/s]
Map:  87%| | 43789/50245 [00:19<00:02, 2344.17 examples/s]
Map:  88%| | 44117/50245 [00:19<00:02, 2213.14 examples/s]
Map:  88%| | 44349/50245 [00:19<00:02, 2237.81 examples/s]
Map:  89%| | 44585/50245 [00:19<00:02, 2268.08 examples/s]
Map:  89%| | 44833/50245 [00:19<00:02, 2315.84 examples/s]
Map:  90%| | 45140/50245 [00:19<00:02, 2213.23 examples/s]
Map:  90%| | 45370/50245 [00:19<00:02, 2233.52 examples/s]
Map:  91%| | 45614/50245 [00:19<00:02, 2285.64 examples/s]
Map:  91%|| 45856/50245 [00:20<00:01, 2319.62 examples/s]
Map:  92%|| 46165/50245 [00:20<00:01, 2220.07 examples/s]
Map:  92%|| 46396/50245 [00:20<00:01, 2241.89 examples/s]
Map:  93%|| 46651/50245 [00:20<00:01, 2323.10 examples/s]
Map:  93%|| 46896/50245 [00:20<00:01, 2357.78 examples/s]
Map:  94%|| 47243/50245 [00:20<00:01, 2257.97 examples/s]
Map:  95%|| 47585/50245 [00:20<00:01, 2259.04 examples/s]
Map:  95%|| 47923/50245 [00:21<00:01, 1742.33 examples/s]
Map:  96%|| 48122/50245 [00:21<00:01, 1765.34 examples/s]
Map:  96%|| 48380/50245 [00:21<00:00, 1938.10 examples/s]
Map:  97%|| 48630/50245 [00:21<00:00, 2067.94 examples/s]
Map:  97%|| 48870/50245 [00:21<00:00, 2145.93 examples/s]
Map:  98%|| 49118/50245 [00:21<00:00, 2096.52 examples/s]
Map:  98%|| 49344/50245 [00:21<00:00, 2134.36 examples/s]
Map:  99%|| 49577/50245 [00:21<00:00, 2180.97 examples/s]
Map:  99%|| 49822/50245 [00:21<00:00, 2253.21 examples/s]
Map: 100%|| 50119/50245 [00:22<00:00, 2144.30 examples/s]
Map: 100%|| 50245/50245 [00:22<00:00, 2270.55 examples/s]
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/site-packages/transformers/models/auto/configuration_auto.py:1006: FutureWarning: The `use_auth_token` argument is deprecated and will be removed in v5 of Transformers.
  warnings.warn(
 Traceback (most recent call last) 
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:588 in <module>                                                   
                                                                              
   585    cfg = om.merge(yaml_cfg, cli_cfg)                                  
   586    om.resolve(cfg)                                                    
   587    assert isinstance(cfg, DictConfig)                                 
  588    main(cfg)                                                          
   589                                                                        
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:505 in main                                                       
                                                                              
   502             tokenizer)                                             
   503          print_trainable_parameters(model)  # should not be 100%    
   504       else:  # standard model                                        
  505          model = build_composer_model(model_config, tokenizer)      
   506                                                                      
   507       if model_config.get('master_weights_dtype') in ('bf16', 'bfloa 
   508          model = model.to(dtype=torch.bfloat16)                     
                                                                              
 /leonardo_work/IscrC_GELATINO/gpuccett/Repos/llm-foundry_gpucce/scripts/trai 
 n/train.py:115 in build_composer_model                                       
                                                                              
   112    if model_cfg.name not in COMPOSER_MODEL_REGISTRY:                  
   113       raise ValueError(                                              
   114          f'Not sure how to build model with name={model_cfg.name}') 
  115    return COMPOSER_MODEL_REGISTRY[model_cfg.name](model_cfg, tokenize 
   116                                                                        
   117                                                                        
   118 def build_composer_peft_model(                                         
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/llmfoundry/models/ 
 hf/hf_causal_lm.py:176 in __init__                                           
                                                                              
   173          # so that we don't timeout for large downloads. This syncs 
   174          with dist.local_rank_zero_download_and_wait(signal_file_pa 
   175             # Then, wait to ensure every node has finished downloa 
  176             dist.barrier()                                         
   177                                                                     
   178          if dist.get_global_rank() == 0:                            
   179             os.remove(signal_file_path)                            
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/composer/utils/dist.py:264 in barrier                        
                                                                              
   261    .. seealso:: :func:`torch.distributed.barrier`                     
   262    """                                                                
   263    if dist.is_available() and dist.is_initialized():                  
  264       dist.barrier()                                                 
   265       return                                                         
   266    world_size = get_world_size()                                      
   267    if world_size == 1:                                                
                                                                              
 /leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.1 
 0/site-packages/torch/distributed/distributed_c10d.py:3328 in barrier        
                                                                              
   3325                                                                      
   3326    if group is None:                                                 
   3327       default_pg = _get_default_group()                             
  3328       work = default_pg.barrier(opts=opts)                          
   3329    else:                                                             
   3330       work = group.barrier(opts=opts)                               
   3331                                                                       

RuntimeError: [11] is setting up NCCL communicator and retrieving ncclUniqueId 
from [0] via c10d key-value store by key '0', but store->get('0') got error: 
Socket Timeout
Exception raised from recvBytes at ../torch/csrc/distributed/c10d/Utils.hpp:604 
(most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::string) + 0x57 
(0x14ea66b694d7 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, 
char const*) + 0x68 (0x14ea66b33434 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libc10.so)
frame #2: c10d::TCPStore::doWait(c10::ArrayRef<std::string>, 
std::chrono::duration<long, std::ratio<1l, 1000l> >) + 0xd8 (0x14ea920d28c8 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #3: c10d::TCPStore::doGet(std::string const&) + 0x22 (0x14ea920d3572 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #4: c10d::TCPStore::get(std::string const&) + 0x59 (0x14ea920d35f9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #5: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ea92092ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #6: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ea92092ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #7: c10d::PrefixStore::get(std::string const&) + 0x31 (0x14ea92092ac1 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #8: c10d::ProcessGroupNCCL::broadcastUniqueNCCLID(ncclUniqueId*, bool, 
std::string const&, int) + 0xaf (0x14ea67af8c4f in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #9: c10d::ProcessGroupNCCL::getNCCLComm(std::string const&, 
std::vector<c10::Device, std::allocator<c10::Device> > const&, c10d::OpType, 
int, bool) + 0x201 (0x14ea67afc901 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #10: <unknown function> + 0xecaa2d (0x14ea67b03a2d in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #11: c10d::ProcessGroupNCCL::allreduce_impl(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x21 
(0x14ea67b04e31 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #12: c10d::ProcessGroupNCCL::allreduce(std::vector<at::Tensor, 
std::allocator<at::Tensor> >&, c10d::AllreduceOptions const&) + 0x39d 
(0x14ea67b07aed in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #13: c10d::ProcessGroupNCCL::barrier(c10d::BarrierOptions const&) + 0x851 
(0x14ea67b16a41 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cuda.so)
frame #14: <unknown function> + 0x538e2d9 (0x14ea920872d9 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x539202a (0x14ea9208b02a in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #16: <unknown function> + 0x53a0e90 (0x14ea92099e90 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_cpu.so)
frame #17: <unknown function> + 0xb6bfee (0x14eaa6717fee in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
frame #18: <unknown function> + 0x3b7285 (0x14eaa5f63285 in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/lib/python3.10/si
te-packages/torch/lib/libtorch_python.so)
<omitting python frames>
frame #44: __libc_start_main + 0xf3 (0x14eadfbd1cf3 in /lib64/libc.so.6)
frame #45: _start + 0x2e (0x400f9e in 
/leonardo_scratch/large/userexternal/gpuccett/llm-foundry/venv/bin/python)
. This may indicate a possible application crash on rank 0 or a network set up 
issue.

----------End global rank 11 STDERR----------
srun: error: lrdn0193: task 2: Exited with exit code 143
